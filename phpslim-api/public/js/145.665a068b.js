"use strict";(globalThis["webpackChunkhomedocs"]=globalThis["webpackChunkhomedocs"]||[]).push([[145],{1731:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Et});a(310),a(2203),a(95),a(6724);var l=a(1758),o=a(9104),r=a(8790),n=a(8734),s=a(4907),i=a(1271),u=a(5192),d=a(3537),c=a(4199),m=a(1307),v=a(6880),p=a(3597),g=a(3394),h=a(8051);const f={__name:"SidebarDrawer",props:{mini:{type:Boolean,required:!1,default:!1}},setup(e){const t=e,a=(0,l.OA)(),{t:o}=(0,d.s9)(),s=(0,g.rd)(),{api:i}=(0,h.M)(),u=(0,v.B)(),c=(0,l.EW)(()=>t.mini),m=[{icon:"home",text:"Dashboard",routeName:"index"},{icon:"account_circle",text:"My profile",routeName:"profile"},{icon:"note_add",text:"Add",routeName:"newDocument"},{icon:"find_in_page",text:"Advanced search",routeName:"advancedSearch",alternateRouteNames:["advancedSearchByTag","advancedSearchByFixedCreationDate","advancedSearchByFixedLastUpdate","advancedSearchByFixedUpdatedOn"]}];function p(e){c.value&&(c.value=!1,e.stopPropagation())}function f(){i.auth.logout().then(e=>{u.setJWT(null),s.push({name:"login"})}).catch(e=>{console.error(e),u.setJWT(null),s.push({name:"login"})})}return(e,t)=>{const s=(0,l.g2)("q-avatar"),i=(0,l.g2)("q-item-section"),u=(0,l.g2)("q-item-label"),d=(0,l.g2)("q-item"),v=(0,l.g2)("q-icon"),g=(0,l.g2)("q-list"),h=(0,l.g2)("q-drawer"),b=(0,l.gN)("ripple");return(0,l.uX)(),(0,l.Wv)(h,(0,l.v6)((0,n.R1)(a),{"show-if-above":"",bordered:"",width:240,mini:c.value,onClickCapture:p,class:"fit theme-default-q-drawer"}),{default:(0,l.k6)(()=>[(0,l.bF)(g,null,{default:(0,l.k6)(()=>[(0,l.bF)(d,{class:"cursor-pointer non-selectable no-pointer-events rounded-borders q-ma-sm theme-default-q-item"},{default:(0,l.k6)(()=>[(0,l.bF)(i,{avatar:""},{default:(0,l.k6)(()=>[(0,l.bF)(s,{square:"",size:"24px"},{default:(0,l.k6)(()=>[...t[0]||(t[0]=[(0,l.Lk)("img",{src:"icons/favicon-128x128.png"},null,-1)])]),_:1})]),_:1}),(0,l.bF)(i,null,{default:(0,l.k6)(()=>[(0,l.bF)(u,{class:"text-weight-bold text-uppercase"},{default:(0,l.k6)(()=>[...t[1]||(t[1]=[(0,l.eW)("HomeDocs",-1)])]),_:1})]),_:1})]),_:1}),((0,l.uX)(),(0,l.CE)(l.FK,null,(0,l.pI)(m,t=>(0,l.bo)((0,l.bF)(d,{key:t.text,clickable:"",to:{name:t.routeName},class:"rounded-borders q-ma-sm theme-default-q-item",active:e.$route.name===t.routeName||t.alternateRouteNames?.includes(e.$route.name),"active-class":"theme-default-q-item-active"},{default:(0,l.k6)(()=>[(0,l.bF)(i,{avatar:""},{default:(0,l.k6)(()=>[(0,l.bF)(v,{name:t.icon},null,8,["name"])]),_:2},1024),(0,l.bF)(i,null,{default:(0,l.k6)(()=>[(0,l.bF)(u,null,{default:(0,l.k6)(()=>[(0,l.eW)((0,r.v_)((0,n.R1)(o)(t.text)),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["to","active"]),[[b]])),64)),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(d,{clickable:"",onClick:f,class:"rounded-borders q-ma-sm theme-default-q-item"},{default:(0,l.k6)(()=>[(0,l.bF)(i,{avatar:""},{default:(0,l.k6)(()=>[(0,l.bF)(v,{name:"logout"})]),_:1}),(0,l.bF)(i,null,{default:(0,l.k6)(()=>[(0,l.bF)(u,null,{default:(0,l.k6)(()=>[(0,l.eW)((0,r.v_)((0,n.R1)(o)("Sign out")),1)]),_:1})]),_:1})]),_:1})),[[b]])]),_:1})]),_:1},16,["mini"])}}};var b=a(5335),k=a(3999),w=a(124),_=a(5173),x=a(3952),q=a(3796),A=a(492),F=a(9626),y=a(8582),E=a.n(y);const R=f,D=R;E()(f,"components",{QDrawer:b.A,QList:k.A,QItem:w.A,QItemSection:_.A,QAvatar:x.A,QItemLabel:q.A,QIcon:A.A}),E()(f,"directives",{Ripple:F.A});var C=a(7091),W=a(1112),P=a(2139),S=a(2588);const Q={class:"q-pa-sm row items-center q-gutter-sm"},T={class:"col-auto"},V={style:{"flex-grow":"1"}},L={key:0},X=["innerHTML"],I={__name:"SearchDialog",props:{modelValue:{type:Boolean,required:!0}},emits:["update:modelValue","close"],setup(e,{emit:t}){const a=e,s=(0,g.rd)(),i=(0,g.lq)(),u=(0,n.KR)("document"==i.name&&i.params?.id||null),{t:v}=(0,d.s9)(),{api:f}=(0,h.M)(),{fullDateTimeHuman:b}=(0,c.c)(),{bus:k,onShowDocumentFiles:w,onShowDocumentNotes:_}=(0,p.U)(),{searchDialogResultsPage:x,dateTimeFormat:q}=(0,m.M)(),A=t,F=(0,l.EW)({get(){return a.modelValue},set(e){A("update:modelValue",e)}}),y=(0,n.Kh)({loading:!1,loadingError:!1,errorMessage:null,apiError:null}),E=(0,l.EW)(()=>[{label:"Title",value:"title"},{label:"Description",value:"description"},{label:"Notes",value:"notesBody"},{label:"Attachment names",value:"attachmentsFilename"}]),R=(0,n.KR)(E.value[0]);(0,l.wB)(()=>R.value,e=>{(0,l.dY)(()=>{$.value?.focus()})});const D=(0,n.KR)(null),I=(0,n.KR)(0),U=(0,n.KR)(x.get()),M=[1,2,3,4,6,8,12,16,24,32,64,128],z=e=>{x.set(e),j(K.value)},K=(0,n.KR)(""),N=(0,n.Kh)([]),O=(0,n.KR)(-1),B=(0,n.KR)(0),H=(0,n.KR)(!1),$=(0,n.KR)(null),Y=(e,t)=>e.replace(new RegExp(t,"gi"),e=>`<strong>${e}</strong>`),j=e=>{if(H.value=!1,I.value=0,e&&e.trim().length>0){O.value=-1,y.loading=!0,y.loadingError=!1,y.errorMessage=null,y.apiError=null;const t={text:{title:"title"==R.value.value?e.trim():null,description:"description"==R.value.value?e.trim():null,notesBody:"notesBody"==R.value.value?e.trim():null,attachmentsFilename:"attachmentsFilename"==R.value.value?e.trim():null}};f.document.search(1,U.value,t,"lastUpdateTimestamp","DESC").then(t=>{N.length=0,I.value=t.data.results.pagination.totalResults,N.push(...t.data.results.documents.map(t=>(t.matchedOnFragment=null,Array.isArray(t.matchedFragments)&&t.matchedFragments.length>0&&(t.matchedOnFragment=v("Fast search match fragment",{fragment:t.matchedFragments[0].fragment?`${Y(t.matchedFragments[0].fragment,e)}`:"",matchedOn:v(t.matchedFragments[0].matchedOn)})),{id:t.id,label:t.title,createdOn:b(t.createdOnTimestamp,q.get()),lastUpdate:b(t.lastUpdateTimestamp,q.get()),attachmentCount:t.attachmentCount,noteCount:t.noteCount,matchedOnFragment:t.matchedOnFragment}))),y.loading=!1,H.value=t.data.results.documents.length<=0}).catch(e=>{if(y.loadingError=!0,e.isAPIError)switch(e.response.status){case 401:y.apiError=e.customAPIErrorDetails,y.errorMessage="Auth session expired, requesting new...",k.emit("reAuthRequired",{emitter:"SearchDialog.onSearch"});break;default:y.apiError=e.customAPIErrorDetails,y.errorMessage="API Error: fatal error";break}else y.errorMessage=`Uncaught exception: ${e}`,console.error(e);y.loading=!1})}else N.length=0},G=e=>{B.value=e},J=e=>{D.value&&D.value.scrollTo(e,"start-force")},Z=e=>{"ArrowUp"===e.key?N.length>0&&O.value>0&&(O.value--,J(O.value),e.preventDefault(),e.stopPropagation()):"ArrowDown"===e.key?N.length>0&&O.value<N.length-1&&(O.value++,J(O.value),e.preventDefault(),e.stopPropagation()):"Enter"===e.key&&N.length>0&&O.value>=0&&O.value<N.length&&s.push({name:"document",params:{id:N[O.value].id}})},ee=()=>{I.value=0,U.value=x.get(),window.addEventListener("keydown",Z),(0,l.dY)(()=>{$.value?.focus()})},te=()=>{N.length=0,K.value=null,H.value=!1,window.removeEventListener("keydown",Z),A("close")};return(0,l.sV)(()=>{k.on("reAuthSucess",e=>{e.to?.includes("SearchDialog.onSearch")&&j(K.value)})}),(0,l.xo)(()=>{k.off("reAuthSucess")}),(e,t)=>{const a=(0,l.g2)("q-avatar"),s=(0,l.g2)("q-chip"),i=(0,l.g2)("q-item-label"),d=(0,l.g2)("q-item-section"),c=(0,l.g2)("q-item"),m=(0,l.g2)("q-select"),p=(0,l.g2)("q-icon"),g=(0,l.g2)("q-input"),h=(0,l.g2)("q-separator"),f=(0,l.g2)("q-virtual-scroll"),b=(0,l.g2)("q-space");return(0,l.uX)(),(0,l.Wv)(C.A,{modelValue:F.value,"onUpdate:modelValue":t[5]||(t[5]=e=>F.value=e),onShow:ee,onClose:te,width:"1280px","max-width":"80vw"},{"header-left":(0,l.k6)(()=>[(0,l.eW)((0,r.v_)((0,n.R1)(v)("Search on HomeDocs...")),1)]),"header-right":(0,l.k6)(()=>[y.loading||y.loadingError?(0,l.Q3)("",!0):(0,l.bo)(((0,l.uX)(),(0,l.Wv)(s,{key:0,size:"md",square:"",class:"gt-sm theme-default-q-chip shadow-1"},{default:(0,l.k6)(()=>[(0,l.bF)(a,{class:"theme-default-q-avatar"},{default:(0,l.k6)(()=>[(0,l.eW)((0,r.v_)(I.value),1)]),_:1}),(0,l.eW)(" "+(0,r.v_)((0,n.R1)(v)("Results count",{count:I.value})),1)]),_:1},512)),[[o.aG,I.value>0]])]),body:(0,l.k6)(()=>[(0,l.Lk)("div",Q,[(0,l.Lk)("div",T,[(0,l.bF)(m,{modelValue:R.value,"onUpdate:modelValue":[t[0]||(t[0]=e=>R.value=e),t[1]||(t[1]=e=>j(K.value))],options:E.value,"display-value":`${R.value?(0,n.R1)(v)(R.value.label):""}`,dense:"","options-dense":"",outlined:"",style:{"min-width":"8em"},label:(0,n.R1)(v)("Search on"),disable:y.loading},{option:(0,l.k6)(e=>[(0,l.bF)(c,(0,r._B)((0,l.Ng)(e.itemProps)),{default:(0,l.k6)(()=>[(0,l.bF)(d,null,{default:(0,l.k6)(()=>[(0,l.bF)(i,null,{default:(0,l.k6)(()=>[(0,l.eW)((0,r.v_)((0,n.R1)(v)(e.label)),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options","display-value","label","disable"])]),(0,l.Lk)("div",V,[(0,l.bF)(g,{type:"text",dense:"",color:"grey-3","label-color":"grey-7",label:(0,n.R1)(v)("Search text..."),modelValue:K.value,"onUpdate:modelValue":[t[2]||(t[2]=e=>K.value=e),t[3]||(t[3]=e=>j(K.value))],clearable:"",outlined:"",ref_key:"searchTextField",ref:$},{prepend:(0,l.k6)(()=>[(0,l.bF)(p,{name:"search"})]),_:1},8,["label","modelValue"])])]),(0,l.bF)(h),y.loadingError?((0,l.uX)(),(0,l.CE)("div",L,[(0,l.bF)(W.A,{text:y.errorMessage||"Error loading data","api-error":y.apiError},null,8,["text","api-error"])])):((0,l.uX)(),(0,l.Wv)(f,{key:1,component:"q-list",items:N,onVirtualScroll:G,ref_key:"virtualListRef",ref:D,class:"q-virtual-scroll-container"},(0,l.eX)({default:(0,l.k6)(({item:e,index:t})=>[(0,l.Lk)("div",{class:(0,r.C4)(["border-bottom-except-last-item",{"current-keyboard-selected-item":O.value===t}])},[((0,l.uX)(),(0,l.Wv)(c,{key:e.id,class:(0,r.C4)(["transparent-background text-color-primary q-pa-sm",{"cursor-not-allowed is-current":e.id===u.value}]),clickable:e.id!==u.value,to:{name:"document",params:{id:e.id}}},{default:(0,l.k6)(()=>[(0,l.bF)(d,{side:"",class:"gt-sm"},{default:(0,l.k6)(()=>[(0,l.bF)(p,{name:"work"})]),_:1}),(0,l.bF)(d,null,{default:(0,l.k6)(()=>[(0,l.bF)(i,null,{default:(0,l.k6)(()=>[(0,l.eW)((0,r.v_)(e.label),1)]),_:2},1024),e.matchedOnFragment?((0,l.uX)(),(0,l.Wv)(i,{key:0,caption:""},{default:(0,l.k6)(()=>[(0,l.Lk)("div",{innerHTML:e.matchedOnFragment},null,8,X)]),_:2},1024)):(0,l.Q3)("",!0)]),_:2},1024),(0,l.bF)(d,{side:"",top:""},{default:(0,l.k6)(()=>[(0,l.bF)(i,{caption:""},{default:(0,l.k6)(()=>[(0,l.eW)((0,r.v_)(e.lastUpdate),1)]),_:2},1024),(0,l.bF)(S.A,{size:"md",square:"",class:"min-width-9em",count:e.attachmentCount,label:"Total attachments count","tool-tip":"View document attachments",disable:y.loading,onClick:(0,o.D$)(t=>(0,n.R1)(w)(e.id,e.label),["stop","prevent"])},null,8,["count","disable","onClick"]),(0,l.bF)(S.A,{size:"md",square:"",class:"min-width-9em",count:e.noteCount,label:"Total notes","tool-tip":"View document notes",disable:y.loading,onClick:(0,o.D$)(t=>(0,n.R1)(_)(e.id,e.label),["stop","prevent"])},null,8,["count","disable","onClick"])]),_:2},1024)]),_:2},1032,["class","clickable","to"]))],2)]),_:2},[H.value?{name:"before",fn:(0,l.k6)(()=>[(0,l.bF)(P.A,{warning:"",class:"q-ma-md",text:"Unfortunately, your search didn't return any results. You might want to modify your filters or search terms"})]),key:"0"}:void 0]),1032,["items"]))]),"actions-prepend":(0,l.k6)(()=>[(0,l.bF)(b),(0,l.bF)(m,{modelValue:U.value,"onUpdate:modelValue":[t[4]||(t[4]=e=>U.value=e),z],filled:"",options:M,label:(0,n.R1)(v)("Max results"),"stack-label":"",dense:"","options-dense":"",class:"q-mr-md",style:{"min-width":"12em"}},null,8,["modelValue","label"])]),_:1},8,["modelValue"])}}};var U=a(2807),M=a(6760),z=a(5848),K=a(9270),N=a(386),O=a(8139),B=a(3676);const H=(0,U.A)(I,[["__scopeId","data-v-5a6a90f2"]]),$=H;E()(I,"components",{QChip:M.A,QAvatar:x.A,QSelect:z.A,QItem:w.A,QItemSection:_.A,QItemLabel:q.A,QInput:K.A,QIcon:A.A,QSeparator:N.A,QVirtualScroll:O.A,QList:k.A,QSpace:B.A});var Y=a(5403),j=a(3465),G=a(9956),J=a(6956),Z=a(9212);const ee={class:"q-mt-sm q-mb-md text-h4 text-weight-bolder"},te={class:"text-color-secondary"},ae={__name:"ReAuthDialog",emits:["close","success"],setup(e,{emit:t}){const{t:a}=(0,d.s9)(),o=t,s=(0,n.KR)(!0),i=()=>{o("close")},u=()=>{o("success")};return(e,t)=>((0,l.uX)(),(0,l.Wv)(C.A,{modelValue:s.value,"onUpdate:modelValue":t[0]||(t[0]=e=>s.value=e),onClose:i,width:"512px","max-width":"80vw","hide-footer":"",persistent:""},{"header-left":(0,l.k6)(()=>[(0,l.eW)((0,r.v_)((0,n.R1)(a)("Session lost... re-auth required")),1)]),body:(0,l.k6)(()=>[(0,l.bF)(Z.A,{"show-extra-bottom":!1,onSuccess:u},{slogan:(0,l.k6)(()=>[(0,l.Lk)("h4",ee,(0,r.v_)((0,n.R1)(a)("Oooops")),1),(0,l.Lk)("div",te,(0,r.v_)((0,n.R1)(a)("Please enter again your credentials")),1)]),_:1})]),_:1},8,["modelValue"]))}},le=ae,oe=le;var re=a(129),ne=a(5801),se=a(2956);const ie={key:0},ue={key:1},de={class:"text-center text-bold q-my-md"},ce={class:"q-pt-none"},me={key:1},ve={class:"text-center q-my-md"},pe={controls:"",class:"q-mt-md full-width"},ge=["src"],he={key:2,class:"q-pdf-min-height"},fe={key:3},be={class:"text-center q-my-md"},ke={key:4,class:"text-subtitle1 text-center"},we={class:"text-center q-my-md"},_e={__name:"FilePreviewDialog",props:{document:{type:Object,required:!0},currentIndex:{type:Number,required:!1,default:0,validator(e){return e>=0}}},emits:["close"],setup(e,{emit:t}){const{t:a}=(0,d.s9)(),s=t,{bgDownload:i}=(0,ne.q)(),{allowPreview:u,isImage:c,isAudio:m,isPDF:v}=(0,se.h)(),p=(0,n.KR)(!1),g=e,h=(0,n.KR)(!0),f=(0,l.EW)(()=>g.document?.attachments?.length>0),b=(0,l.EW)(()=>f.value?g.document?.attachments?.length:0),k=(0,n.KR)(g.currentIndex+1||1),w=(0,l.EW)(()=>g.document.attachments?.length>0?g.document.attachments[k.value-1]:{}),_=()=>{s("close")},x=(0,n.Kh)({visible:!1,success:!1,error:!1,text:null}),q=()=>{x.visible=!1,x.success=!1,x.error=!1,x.text=null,p.value=!1},A=()=>{p.value=!0,x.success=!1,x.error=!0,x.text=a("Error loading preview"),x.visible=!0},F=(e,t)=>{x.visible=!1,x.success=!1,x.error=!1,x.text=null,i(e,t).then(e=>{x.success=!0,x.text=a("FileDownloadedMessage",{filename:e.fileName,length:e.length}),x.visible=!0}).catch(e=>{x.error=!0,x.text=a("FileDownloadeErrorMessage",{filename:t}),x.visible=!0})};return(t,s)=>{const i=(0,l.g2)("router-link"),d=(0,l.g2)("q-avatar"),g=(0,l.g2)("q-chip"),f=(0,l.g2)("q-pagination"),y=(0,l.g2)("q-img"),E=(0,l.g2)("q-icon"),R=(0,l.g2)("q-pdfviewer"),D=(0,l.g2)("q-space"),W=(0,l.g2)("q-btn");return(0,l.uX)(),(0,l.Wv)(C.A,{modelValue:h.value,"onUpdate:modelValue":s[2]||(s[2]=e=>h.value=e),onClose:_,width:"1280px","max-width":"80vw"},{"header-left":(0,l.k6)(()=>[e.document.title?((0,l.uX)(),(0,l.CE)("div",ie,[(0,l.eW)((0,r.v_)((0,n.R1)(a)("Document title"))+": ",1),(0,l.bF)(i,{to:{name:"document",params:{id:e.document.id}},class:"text-decoration-hover"},{default:(0,l.k6)(()=>[(0,l.eW)((0,r.v_)(e.document.title),1)]),_:1},8,["to"])])):((0,l.uX)(),(0,l.CE)("div",ue,(0,r.v_)((0,n.R1)(a)("Document attachments preview",{count:b.value})),1))]),"header-right":(0,l.k6)(()=>[(0,l.bF)(g,{size:"md",square:"",class:"gt-sm theme-default-q-chip shadow-1"},{default:(0,l.k6)(()=>[(0,l.bF)(d,{class:"theme-default-q-avatar"},{default:(0,l.k6)(()=>[(0,l.eW)((0,r.v_)(b.value),1)]),_:1}),(0,l.eW)(" "+(0,r.v_)((0,n.R1)(a)("Total attachments count",{count:b.value})),1)]),_:1})]),body:(0,l.k6)(()=>[(0,l.Lk)("div",null,[(0,l.Lk)("p",de,(0,r.v_)(w.value.name)+" ("+(0,r.v_)(w.value.humanSize)+")",1),b.value>1?((0,l.uX)(),(0,l.Wv)(f,{key:0,class:"flex flex-center q-my-md",modelValue:k.value,"onUpdate:modelValue":[s[0]||(s[0]=e=>k.value=e),q],max:b.value,color:"dark","max-pages":5,"boundary-numbers":"","direction-links":"","icon-first":"skip_previous","icon-last":"skip_next","icon-prev":"fast_rewind","icon-next":"fast_forward",gutter:"md"},null,8,["modelValue","max"])):(0,l.Q3)("",!0)]),(0,l.Lk)("div",ce,[(0,n.R1)(c)(w.value.name)?(0,l.bo)(((0,l.uX)(),(0,l.Wv)(y,{key:0,src:w.value.url+"/inline",loading:"lazy","spinner-color":"white",onError:A,alt:"image preview",fit:"scale-down",class:"q-img-max-height q-my-md","img-class":"q-mx-auto"},null,8,["src"])),[[o.aG,!p.value]]):(0,n.R1)(m)(w.value.name)?((0,l.uX)(),(0,l.CE)("div",me,[(0,l.Lk)("p",ve,[(0,l.bF)(E,{name:"audio_file",size:"128px"})]),(0,l.Lk)("audio",pe,[(0,l.Lk)("source",{src:w.value.url+"/inline",type:"audio/mpeg"},null,8,ge),(0,l.eW)(" "+(0,r.v_)((0,n.R1)(a)("Your browser does not support the audio element")),1)])])):(0,n.R1)(v)(w.value.name)?((0,l.uX)(),(0,l.CE)("div",he,[(0,l.bF)(R,{src:w.value.url+"/inline",type:"html5","inner-content-class":"q-pdfviewer-min-height"},null,8,["src"])])):((0,l.uX)(),(0,l.CE)("div",fe,[(0,l.Lk)("p",be,[(0,l.bF)(E,{name:"hide_source",size:"128px"})])])),p.value?((0,l.uX)(),(0,l.CE)("div",ke,[(0,l.Lk)("p",we,[(0,l.bF)(E,{name:"bug_report",size:"128px"})])])):(0,l.Q3)("",!0)])]),"actions-prepend":(0,l.k6)(()=>[x.visible?((0,l.uX)(),(0,l.Wv)(P.A,{key:0,success:x.success,error:x.error},{text:(0,l.k6)(()=>[(0,l.eW)((0,r.v_)(x.text),1)]),_:1},8,["success","error"])):(0,n.R1)(u)(w.value.name)?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(P.A,{key:1,warning:""},{text:(0,l.k6)(()=>[(0,l.eW)((0,r.v_)((0,n.R1)(a)("File preview not available",{filename:w.value.name})),1)]),_:1})),(0,l.bF)(D),(0,l.bF)(W,{color:"primary","no-caps":"",href:w.value.url,label:(0,n.R1)(a)("Download"),icon:"download",onClick:s[1]||(s[1]=(0,o.D$)(e=>F(w.value.url+"/inline",w.value.name),["stop","prevent","stop"])),"aria-label":"Download file"},null,8,["href","label"])]),_:1},8,["modelValue"])}}};var xe=a(4700),qe=a(2665),Ae=a(6384);const Fe=_e,ye=Fe;E()(_e,"components",{QChip:M.A,QAvatar:x.A,QPagination:xe.A,QImg:qe.A,QIcon:A.A,QSpace:B.A,QBtn:Ae.A});var Ee=a(6246),Re=a(2732);const De={key:0},Ce={key:1},We={class:"q-pt-none scroll attachments-scrolled-container"},Pe={key:0},Se={key:1},Qe={key:2},Te={class:"row full-width"},Ve={class:"col-xl-10 col-lg-10 col-md-9 col-sm-12 col-xs-12"},Le={class:"text-weight-bold"},Xe={class:"text-weight-bold"},Ie={class:"text-weight-bold"},Ue={class:"col-xl-2 col-lg-2 col-md-3 col-sm-12 col-xs-12"},Me={__name:"DocumentFilesPreviewDialog",props:{documentId:{type:String,required:!0},documentTitle:{type:String,required:!1,default:""}},emits:["close"],setup(e,{emit:t}){const{t:a}=(0,d.s9)(),{timeAgo:s}=(0,c.c)(),{allowPreview:i}=(0,se.h)(),{bus:u}=(0,p.U)(),{bgDownload:m}=(0,ne.q)(),{api:v}=(0,h.M)(),g=e,f=t,b=(0,n.KR)(!0),k=(0,n.Kh)({loading:!1,loadingError:!1,errorMessage:null,apiError:null}),w=(0,n.Kh)([]),_=(0,l.EW)(()=>w?.length>0),x=e=>{u.emit("showDocumentFilePreviewDialog",{document:{id:g.documentId,title:g.documentTitle,attachments:w},currentIndex:e})},q=(0,n.Kh)({visible:!1,success:!1,error:!1,text:null}),A=(e,t)=>{q.visible=!1,q.success=!1,q.error=!1,q.text=null,m(e,t).then(e=>{q.success=!0,q.text=a("FileDownloadedMessage",{filename:e.fileName,length:Re.Ay.humanStorageSize(e.length)}),q.visible=!0}).catch(e=>{q.error=!0,q.text=a("FileDownloadeErrorMessage",{filename:t}),q.visible=!0})},F=e=>{e?k.loading||(k.loading=!0,k.loadingError=!1,k.errorMessage=null,k.apiError=null,v.document.getAttachments(e).then(e=>{w.length=0,w.push(...e.data.attachments.map(e=>(e.createdOn=Ee.Ay.formatDate(e.createdOnTimestamp,"YYYY-MM-DD HH:mm:ss"),e.humanSize=Re.Ay.humanStorageSize(e.size),e.url="api3/attachment/"+e.id,e))),k.loading=!1}).catch(e=>{if(k.loadingError=!0,e.isAPIError)switch(e.response.status){case 401:k.apiError=e.customAPIErrorDetails,k.errorMessage="Auth session expired, requesting new...",u.emit("reAuthRequired",{emitter:"DocumentFilesPreviewDialog"});break;default:k.apiError=e.customAPIErrorDetails,k.errorMessage="API Error: fatal error";break}else k.errorMessage=`Uncaught exception: ${e}`,console.error(e);k.loading=!1})):k.loadingError=!0},y=()=>{f("close")};return(0,l.sV)(()=>{F(g.documentId||null),u.on("reAuthSucess",e=>{e.to?.includes("DocumentFilesPreviewDialog")&&F(g.documentId||null)})}),(0,l.xo)(()=>{u.off("reAuthSucess")}),(t,u)=>{const d=(0,l.g2)("router-link"),c=(0,l.g2)("q-avatar"),m=(0,l.g2)("q-chip"),v=(0,l.g2)("q-item-label"),p=(0,l.g2)("q-btn"),g=(0,l.g2)("q-item-section"),h=(0,l.g2)("q-item"),f=(0,l.g2)("q-list"),F=(0,l.g2)("q-space");return(0,l.uX)(),(0,l.Wv)(C.A,{modelValue:b.value,"onUpdate:modelValue":u[0]||(u[0]=e=>b.value=e),onClose:y,width:"1280px","max-width":"80vw"},{"header-left":(0,l.k6)(()=>[e.documentTitle?((0,l.uX)(),(0,l.CE)("div",De,[(0,l.eW)((0,r.v_)((0,n.R1)(a)("Document title"))+": ",1),(0,l.bF)(d,{to:{name:"document",params:{id:e.documentId}},class:"text-decoration-hover"},{default:(0,l.k6)(()=>[(0,l.eW)((0,r.v_)(e.documentTitle),1)]),_:1},8,["to"])])):((0,l.uX)(),(0,l.CE)("div",Ce,(0,r.v_)((0,n.R1)(a)("Document attachments")),1))]),"header-right":(0,l.k6)(()=>[k.loading||k.loadingError?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(m,{key:0,size:"md",square:"",class:"gt-sm theme-default-q-chip shadow-1"},{default:(0,l.k6)(()=>[(0,l.bF)(c,{class:"theme-default-q-avatar"},{default:(0,l.k6)(()=>[(0,l.eW)((0,r.v_)(w.length),1)]),_:1}),(0,l.eW)(" "+(0,r.v_)((0,n.R1)(a)("Total attachments count",{count:w.length})),1)]),_:1}))]),body:(0,l.k6)(()=>[(0,l.Lk)("div",We,[k.loading?((0,l.uX)(),(0,l.CE)("div",Pe)):k.loadingError?((0,l.uX)(),(0,l.CE)("div",Se,[(0,l.bF)(W.A,{text:k.errorMessage||"Error loading data","api-error":k.apiError},null,8,["text","api-error"])])):_.value?((0,l.uX)(),(0,l.Wv)(f,{key:3},{default:(0,l.k6)(()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(w,(e,t)=>((0,l.uX)(),(0,l.CE)("div",{key:e.id,class:"border-bottom-except-last-item"},[(0,l.bF)(h,{class:"transparent-background text-color-primary q-pa-sm cursor-default",clickable:""},{default:(0,l.k6)(()=>[(0,l.bF)(g,null,{default:(0,l.k6)(()=>[(0,l.Lk)("div",Te,[(0,l.Lk)("div",Ve,[(0,l.bF)(v,null,{default:(0,l.k6)(()=>[(0,l.Lk)("span",Le,(0,r.v_)((0,n.R1)(a)("Name"))+":",1),(0,l.eW)(" "+(0,r.v_)(e.name),1)]),_:2},1024),(0,l.bF)(v,null,{default:(0,l.k6)(()=>[(0,l.Lk)("span",Xe,(0,r.v_)((0,n.R1)(a)("Size"))+":",1),(0,l.eW)(" "+(0,r.v_)(e.humanSize),1)]),_:2},1024),(0,l.bF)(v,null,{default:(0,l.k6)(()=>[(0,l.Lk)("span",Ie,(0,r.v_)((0,n.R1)(a)("Uploaded on"))+":",1),(0,l.eW)(" "+(0,r.v_)(e.createdOn)+" ("+(0,r.v_)((0,n.R1)(s)(e.createdOnTimestamp))+")",1)]),_:2},1024)]),(0,l.Lk)("div",Ue,[(0,l.bF)(p,{align:"left",size:"md",color:"primary",class:"q-mt-sm full-width",disable:k.loading,icon:"save",label:(0,n.R1)(a)("Download"),"no-caps":"",onClick:(0,o.D$)(t=>A(e.url,e.name),["stop","prevent"]),href:e.url},null,8,["disable","label","onClick","href"]),(0,n.R1)(i)(e.name)?((0,l.uX)(),(0,l.Wv)(p,{key:0,align:"left",size:"md",color:"primary",class:"q-mt-sm full-width",disable:k.loading,icon:"preview",label:(0,n.R1)(a)("Preview"),"no-caps":"",onClick:(0,o.D$)(e=>x(t),["stop","prevent"])},null,8,["disable","label","onClick"])):(0,l.Q3)("",!0)])])]),_:2},1024)]),_:2},1024)]))),128))]),_:1})):((0,l.uX)(),(0,l.CE)("div",Qe,[(0,l.bF)(P.A,{warning:"",text:"This document has no associated attachments."})]))])]),"actions-prepend":(0,l.k6)(()=>[q.visible?((0,l.uX)(),(0,l.Wv)(P.A,{key:0,success:q.success,error:q.error},{text:(0,l.k6)(()=>[(0,l.eW)((0,r.v_)(q.text),1)]),_:1},8,["success","error"])):(0,l.Q3)("",!0),(0,l.bF)(F)]),_:1},8,["modelValue"])}}},ze=(0,U.A)(Me,[["__scopeId","data-v-1fc77e95"]]),Ke=ze;E()(Me,"components",{QChip:M.A,QAvatar:x.A,QList:k.A,QItem:w.A,QItemSection:_.A,QItemLabel:q.A,QBtn:Ae.A,QSpace:B.A});const Ne={key:0},Oe={key:1},Be={class:"q-pt-none scroll notes-scrolled-container"},He={key:0},$e={key:1},Ye={key:2},je={key:3},Ge={class:"note-date-label"},Je={__name:"DocumentNotesPreviewDialog",props:{documentId:{type:String,required:!0},documentTitle:{type:String,required:!1,default:""},maxLines:{type:Number,required:!1,default:2,validator(e){return e>0}}},emits:["close"],setup(e,{emit:t}){const{t:a}=(0,d.s9)(),{timeAgo:s}=(0,c.c)(),{api:i}=(0,h.M)(),{bus:u}=(0,p.U)(),m=e,v=t,g=(0,n.KR)(!0),f=(0,n.Kh)({loading:!1,loadingError:!1,errorMessage:null,apiError:null}),b=(0,n.Kh)([]),k=(0,l.EW)(()=>b?.length>0),w=e=>{e?f.loading||(f.loading=!0,f.loadingError=!1,f.errorMessage=null,f.apiError=null,i.document.getNotes(e).then(e=>{b.length=0,b.push(...e.data.notes.map(e=>(e.createdOn=Ee.Ay.formatDate(e.createdOnTimestamp,"YYYY-MM-DD HH:mm:ss"),e.expanded=!1,e))),f.loading=!1}).catch(e=>{if(f.loadingError=!0,e.isAPIError)switch(e.response.status){case 401:f.apiError=e.customAPIErrorDetails,f.errorMessage="Auth session expired, requesting new...",u.emit("reAuthRequired",{emitter:"DocumentNotesPreviewDialog"});break;default:f.apiError=e.customAPIErrorDetails,f.errorMessage="API Error: fatal error";break}else f.errorMessage=`Uncaught exception: ${e}`,console.error(e);f.loading=!1})):f.loadingError=!0},_=()=>{v("close")};return(0,l.sV)(()=>{w(m.documentId||null),u.on("reAuthSucess",e=>{e.to?.includes("DocumentNotesPreviewDialog")&&w(m.documentId||null)})}),(0,l.xo)(()=>{u.off("reAuthSucess")}),(t,i)=>{const u=(0,l.g2)("router-link"),d=(0,l.g2)("q-avatar"),c=(0,l.g2)("q-chip"),m=(0,l.g2)("q-icon");return(0,l.uX)(),(0,l.Wv)(C.A,{modelValue:g.value,"onUpdate:modelValue":i[0]||(i[0]=e=>g.value=e),onClose:_,width:"1280px","max-width":"80vw"},{"header-left":(0,l.k6)(()=>[e.documentTitle?((0,l.uX)(),(0,l.CE)("div",Ne,[(0,l.eW)((0,r.v_)((0,n.R1)(a)("Document title"))+": ",1),(0,l.bF)(u,{to:{name:"document",params:{id:e.documentId}},class:"text-decoration-hover"},{default:(0,l.k6)(()=>[(0,l.eW)((0,r.v_)(e.documentTitle),1)]),_:1},8,["to"])])):((0,l.uX)(),(0,l.CE)("div",Oe,(0,r.v_)((0,n.R1)(a)("Document notes")),1))]),"header-right":(0,l.k6)(()=>[f.loading||f.loadingError?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(c,{key:0,size:"md",square:"",class:"gt-sm theme-default-q-chip shadow-1"},{default:(0,l.k6)(()=>[(0,l.bF)(d,{class:"theme-default-q-avatar"},{default:(0,l.k6)(()=>[(0,l.eW)((0,r.v_)(b.length),1)]),_:1}),(0,l.eW)(" "+(0,r.v_)((0,n.R1)(a)("Total notes",{count:b.length})),1)]),_:1}))]),body:(0,l.k6)(()=>[(0,l.Lk)("div",Be,[f.loading?((0,l.uX)(),(0,l.CE)("div",He)):f.loadingError?((0,l.uX)(),(0,l.CE)("div",$e,[(0,l.bF)(W.A,{text:f.errorMessage||"Error loading data","api-error":f.apiError},null,8,["text","api-error"])])):k.value?((0,l.uX)(),(0,l.CE)("div",je,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(b,t=>((0,l.uX)(),(0,l.CE)("div",{key:t.id,class:"q-pa-sm relative-position white-space-pre-line border-bottom-except-last-item"},[(0,l.Lk)("div",Ge,(0,r.v_)(t.createdOn)+" ("+(0,r.v_)((0,n.R1)(s)(t.createdOnTimestamp))+")",1),(0,l.bF)(m,{name:t.expanded?"unfold_less":"expand",size:"sm",class:"absolute-top-right text-grey cursor-pointer q-mr-sm q-mt-sm",color:"blue",onClick:(0,o.D$)(e=>t.expanded=!t.expanded,["stop"])},{default:(0,l.k6)(()=>[(0,l.bF)(re.A,null,{default:(0,l.k6)(()=>[(0,l.eW)((0,r.v_)((0,n.R1)(a)(t.expanded?"Click to collapse":"Click to expand")),1)]),_:2},1024)]),_:2},1032,["name","onClick"]),(0,l.Lk)("div",{class:(0,r.C4)(["q-mt-sm",{collapsed:!t.expanded}]),style:(0,r.Tr)(`--max-lines: ${e.maxLines}`)},(0,r.v_)(t.body),7)]))),128))])):((0,l.uX)(),(0,l.CE)("div",Ye,[(0,l.bF)(P.A,{warning:"",text:"This document has no associated notes."})]))])]),_:1},8,["modelValue"])}}},Ze=(0,U.A)(Je,[["__scopeId","data-v-0a352810"]]),et=Ze;E()(Je,"components",{QChip:M.A,QAvatar:x.A,QIcon:A.A});var tt=a(6520);const at={class:"q-p-none q-markup-table-container scroll"},lt={class:"text-left"},ot={class:"text-right"},rt={class:"text-right"},nt={class:"text-right"},st={class:"text-center"},it={class:"text-left"},ut={class:"text-right"},dt={class:"text-right"},ct={class:"text-right"},mt={class:"text-center"},vt={__name:"UploadingDialog",props:{modelValue:{type:Boolean,required:!0},transfers:{type:Array,required:!1,default:()=>[],validator(e){return Array.isArray(e)}}},emits:["update:modelValue","close"],setup(e,{emit:t}){const{t:a}=(0,d.s9)(),{fullDateTimeHuman:o}=(0,c.c)(),{alwaysOpenUploadDialog:s,dateTimeFormat:i}=(0,m.M)(),u=(0,tt.N)(),v=t,p=e,g=(0,l.EW)({get(){return p.modelValue},set(e){if(e){const e=s.get();e!==h.value&&(h.value=e)}v("update:modelValue",e)}}),h=(0,n.KR)(s.get());(0,l.wB)(()=>g.value,e=>{e&&(h.value=s.get())});const f=e=>{s.set(e)},b=(0,l.EW)(()=>h.value?"Always display this progress window when uploading files":"Only display this progress window when uploading failed"),k=()=>{g.value=!1,v("update:modelValue",!1)};return(t,s)=>{const d=(0,l.g2)("q-avatar"),c=(0,l.g2)("q-chip"),m=(0,l.g2)("q-spinner"),v=(0,l.g2)("q-markup-table"),p=(0,l.g2)("q-toggle");return(0,l.uX)(),(0,l.Wv)(C.A,{modelValue:g.value,"onUpdate:modelValue":s[1]||(s[1]=e=>g.value=e),onClose:k,width:"1280px","max-width":"80vw"},{"header-left":(0,l.k6)(()=>[(0,l.eW)((0,r.v_)((0,n.R1)(a)("File upload activity & status")),1)]),body:(0,l.k6)(()=>[(0,l.Lk)("div",at,[e.transfers?.length>0?((0,l.uX)(),(0,l.Wv)(v,{key:0},{default:(0,l.k6)(()=>[(0,l.Lk)("thead",null,[(0,l.Lk)("tr",null,[(0,l.Lk)("th",lt,(0,r.v_)((0,n.R1)(a)("Name")),1),(0,l.Lk)("th",ot,(0,r.v_)((0,n.R1)(a)("Size")),1),(0,l.Lk)("th",rt,(0,r.v_)((0,n.R1)(a)("Started")),1),(0,l.Lk)("th",nt,(0,r.v_)((0,n.R1)(a)("End")),1),(0,l.Lk)("th",st,(0,r.v_)((0,n.R1)(a)("Status")),1)])]),(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.transfers,e=>((0,l.uX)(),(0,l.CE)("tr",{key:e.id,class:(0,r.C4)(["text-white",{"bg-green-5":e.done,"bg-red-4":e.error,"bg-light-blue":e.uploading}])},[(0,l.Lk)("td",it,(0,r.v_)(e.filename),1),(0,l.Lk)("td",ut,(0,r.v_)((0,n.R1)(Re.Ay).humanStorageSize(e.filesize)),1),(0,l.Lk)("td",dt,(0,r.v_)((0,n.R1)(o)(e.start,(0,n.R1)(i).get())),1),(0,l.Lk)("td",ct,(0,r.v_)((0,n.R1)(o)(e.end,(0,n.R1)(i).get())),1),(0,l.Lk)("td",mt,[e.error?((0,l.uX)(),(0,l.Wv)(c,{key:0,square:"",class:"full-width bg-red-9 text-white"},{default:(0,l.k6)(()=>[(0,l.bF)(d,{icon:"cancel",class:"q-ma-xs"}),(0,l.eW)(" "+(0,r.v_)(413==e.errorHTTPCode?(0,n.R1)(a)("Transfer rejected max filesize",{maxUploadFileSize:(0,n.R1)(Re.Ay).humanStorageSize((0,n.R1)(u).maxUploadFileSize)}):(0,n.R1)(a)(e.errorMessage)),1)]),_:2},1024)):e.done?((0,l.uX)(),(0,l.Wv)(c,{key:1,square:"",class:"full-width bg-green-9 text-white"},{default:(0,l.k6)(()=>[(0,l.bF)(d,{icon:"check",class:"q-ma-xs"}),(0,l.eW)(" "+(0,r.v_)((0,n.R1)(a)("Transfer complete")),1)]),_:1})):e.uploading?((0,l.uX)(),(0,l.Wv)(c,{key:2,square:"",class:"full-width bg-light-blue-9 text-white"},{default:(0,l.k6)(()=>[(0,l.bF)(m,{size:"sm",class:"q-ma-xs"}),(0,l.eW)(" "+(0,r.v_)((0,n.R1)(a)("Transfering...")),1)]),_:1})):(0,l.Q3)("",!0)])],2))),128))])]),_:1})):(0,l.Q3)("",!0)])]),"actions-prepend":(0,l.k6)(()=>[(0,l.bF)(p,{modelValue:h.value,"onUpdate:modelValue":[s[0]||(s[0]=e=>h.value=e),f],"checked-icon":"check",color:"green",label:(0,n.R1)(a)(b.value),"unchecked-icon":"clear",class:"q-mr-md"},null,8,["modelValue","label"])]),_:1},8,["modelValue"])}}};var pt=a(857),gt=a(8210),ht=a(5087);const ft=(0,U.A)(vt,[["__scopeId","data-v-a12cfa82"]]),bt=ft;E()(vt,"components",{QMarkupTable:pt.A,QChip:M.A,QAvatar:x.A,QSpinner:gt.A,QToggle:ht.A});const kt=!0,wt={__name:"MainLayout",setup(e){const t=(0,s.A)(),{t:a}=(0,d.s9)(),{bus:g}=((0,v.B)(),(0,p.U)()),{currentTimestamp:h}=(0,c.c)(),{alwaysOpenUploadDialog:f}=(0,m.M)(),b=(0,n.Kh)({reauth:{visible:!1},filePreview:{visible:!1,document:{id:null,title:null,attachments:[]},currentIndex:0},documentFilesPreview:{visible:!1,document:{id:null,title:null}},documentNotesPreview:{visible:!1,document:{id:null,title:null}},fastSearch:{visible:!1},uploading:{visible:!1,transfers:[]}}),k=(0,n.Kh)([]),w=()=>{b.reauth.visible=!1,g.emit("reAuthSucess",{to:k}),k.length=0},_=(0,n.KR)(!1),x=(0,n.KR)(t.screen.gt.sm),q=kt?i.A.getItem("miniSidebarCurrentMode"):null;kt&&null!=q&&(_.value=!0);const A=(0,n.KR)(null!=q?1==q:t.screen.md),F=(0,l.EW)(()=>t.screen.name);(0,l.wB)(F,e=>{_.value||(A.value=t.screen.lt.lg)});const y=(0,l.EW)(()=>t.screen.gt.xs?a("Search on HomeDocs..."):""),E=e=>{A.value=!A.value,_.value=!0,kt&&i.A.set("miniSidebarCurrentMode",A.value)};return(0,l.sV)(()=>{g.on("reAuthRequired",e=>{e.emitter&&k.push(e.emitter),b.reauth.visible=!0}),g.on("showDocumentFilePreviewDialog",e=>{b.filePreview.document.id=e?.document?.id,b.filePreview.document.title=e?.document?.title,b.filePreview.document.attachments=e?.document?.attachments||[],b.filePreview.currentIndex=e?.currentIndex,b.filePreview.visible=!0}),g.on("showDocumentFilesPreviewDialog",e=>{b.documentFilesPreview.document.id=e?.document?.id,b.documentFilesPreview.document.title=e?.document?.title,b.documentFilesPreview.visible=!0}),g.on("showDocumentNotesPreviewDialog",e=>{b.documentNotesPreview.document.id=e?.document?.id,b.documentNotesPreview.document.title=e?.document?.title,b.documentNotesPreview.visible=!0}),g.on("showUploadingDialog",e=>{b.uploading.transfers.unshift(...e.transfers.map(e=>({id:(0,u.A)(),filename:e.name,filesize:e.size,start:h(),end:null,uploading:!0,done:!1,error:!1,errorHTTPCode:null,errorMessage:null,processed:!1}))||[]),b.uploading.visible=b.uploading.transfers?.length>0&&f.get()}),g.on("refreshUploadingDialog.fileUploaded",e=>{b.uploading.transfers.length>0?e.transfers?.forEach(e=>{const t=b.uploading.transfers?.find(t=>!t.processed&&e.name==t.filename&&e.size==t.filesize);t?(t.end=h(),t.uploading=!1,t.done=!0,t.processed=!0):console.error("Transfer not found")}):console.error("Missing previous transfers"),b.uploading.visible=b.uploading.transfers?.length>0&&f.get()}),g.on("refreshUploadingDialog.fileUploadRejected",e=>{e.transfers?.forEach(e=>{const t=b.uploading.transfers?.find(t=>!t.processed&&e.name==t.filename&&e.size==t.filesize);t?(t.end=h(),t.uploading=!1,t.error=!0,t.errorHTTPCode=e.error?.status,t.errorMessage="Transfer rejected",t.processed=!0):b.uploading.transfers.unshift({id:(0,u.A)(),filename:e.name,filesize:e.size,start:h(),end:h(),uploading:!1,done:!1,error:!0,errorHTTPCode:e.error?.status,errorMessage:"Transfer rejected",processed:!0})}),b.uploading.visible=b.uploading.transfers?.length>0}),g.on("refreshUploadingDialog.fileUploadFailed",e=>{e.transfers?.forEach(e=>{const t=b.uploading.transfers?.find(t=>!t.processed&&e.name==t.filename&&e.size==t.filesize);t?(t.end=h(),t.uploading=!1,t.error=!0,t.errorHTTPCode=e.error?.status,t.errorMessage="Transfer failed",t.processed=!0):b.uploading.transfers.unshift({id:(0,u.A)(),filename:e.name,filesize:e.size,start:h(),end:h(),uploading:!1,done:!1,error:!0,errorHTTPCode:e.error?.status,errorMessage:"Transfer failed",processed:!0})}),b.uploading.visible=b.uploading.transfers?.length>0})}),(0,l.xo)(()=>{g.off("reAuthRequired"),g.off("showDocumentFilePreviewDialog"),g.off("showDocumentFilesPreviewDialog"),g.off("showDocumentNotesPreviewDialog"),g.off("showUploadingDialog"),g.off("refreshUploadingDialog.fileUploaded"),g.off("refreshUploadingDialog.fileUploadRejected"),g.off("refreshUploadingDialog.fileUploadFailed")}),(e,t)=>{const s=(0,l.g2)("q-btn"),i=(0,l.g2)("q-btn-group"),u=(0,l.g2)("q-toolbar"),d=(0,l.g2)("q-header"),c=(0,l.g2)("router-view"),m=(0,l.g2)("q-page-container"),v=(0,l.g2)("q-layout");return(0,l.uX)(),(0,l.Wv)(v,{view:"lHh lpR lFf",class:"theme-default-q-layout"},{default:(0,l.k6)(()=>[(0,l.bF)(d,{"height-hint":"61.59",class:"theme-default-q-header",bordered:""},{default:(0,l.k6)(()=>[(0,l.bF)(u,{class:"theme-default-q-toolbar"},{default:(0,l.k6)(()=>[(0,l.bo)((0,l.bF)(s,{flat:"",dense:"",round:"",onClick:t[0]||(t[0]=e=>{x.value=!x.value}),"aria-label":"Toggle drawer",icon:"menu",class:"q-mr-md"},null,512),[[o.aG,!x.value]]),(0,l.bo)((0,l.bF)(s,{flat:"",dense:"",round:"",onClick:E,"aria-label":"Toggle drawer",icon:A.value?"arrow_forward_ios":"arrow_back_ios_new",class:"q-mr-md"},{default:(0,l.k6)(()=>[(0,l.bF)(re.A,null,{default:(0,l.k6)(()=>[(0,l.eW)((0,r.v_)((0,n.R1)(a)(A.value?"Expand sidebar":"Collapse sidebar")),1)]),_:1})]),_:1},8,["icon"]),[[o.aG,x.value]]),(0,l.bF)(s,{type:"button","no-caps":"","no-wrap":"",align:"left",outline:"",label:y.value,icon:"search",class:"full-width no-caps theme-default-q-btn",onClick:t[1]||(t[1]=(0,o.D$)(e=>b.fastSearch.visible=!0,["prevent"]))},{default:(0,l.k6)(()=>[(0,l.bF)(re.A,{anchor:"bottom middle",self:"top middle"},{default:(0,l.k6)(()=>[(0,l.eW)((0,r.v_)((0,n.R1)(a)("Click to open fast search")),1)]),_:1})]),_:1},8,["label"]),(0,l.bF)(i,{flat:"",class:"q-ml-md"},{default:(0,l.k6)(()=>[(0,l.bF)(Y.A,{dense:""}),(0,l.bF)(j.A,{"short-labels":!0,style:{"min-width":"9em"}}),(0,l.bF)(G.A,{dense:"",href:(0,n.R1)(J.g)},null,8,["href"])]),_:1})]),_:1})]),_:1}),(0,l.bF)(D,{modelValue:x.value,"onUpdate:modelValue":t[2]||(t[2]=e=>x.value=e),mini:A.value},null,8,["modelValue","mini"]),(0,l.bF)($,{modelValue:b.fastSearch.visible,"onUpdate:modelValue":t[3]||(t[3]=e=>b.fastSearch.visible=e)},null,8,["modelValue"]),(0,l.bF)(m,null,{default:(0,l.k6)(()=>[(0,l.bF)(c,{class:"q-pa-sm"})]),_:1}),b.reauth.visible?((0,l.uX)(),(0,l.Wv)(oe,{key:0,onSuccess:w,onClose:t[4]||(t[4]=e=>b.reauth.visible=!1)})):(0,l.Q3)("",!0),b.filePreview.visible?((0,l.uX)(),(0,l.Wv)(ye,{key:1,document:b.filePreview.document,"current-index":b.filePreview.currentIndex,onClose:t[5]||(t[5]=e=>b.filePreview.visible=!1)},null,8,["document","current-index"])):(0,l.Q3)("",!0),b.documentFilesPreview.visible?((0,l.uX)(),(0,l.Wv)(Ke,{key:2,"document-id":b.documentFilesPreview.document.id,"document-title":b.documentFilesPreview.document.title,onClose:t[6]||(t[6]=e=>b.documentFilesPreview.visible=!1)},null,8,["document-id","document-title"])):(0,l.Q3)("",!0),b.documentNotesPreview.visible?((0,l.uX)(),(0,l.Wv)(et,{key:3,"document-id":b.documentNotesPreview.document.id,"document-title":b.documentNotesPreview.document.title,onClose:t[7]||(t[7]=e=>b.documentNotesPreview.visible=!1)},null,8,["document-id","document-title"])):(0,l.Q3)("",!0),(0,l.bF)(bt,{modelValue:b.uploading.visible,"onUpdate:modelValue":t[8]||(t[8]=e=>b.uploading.visible=e),transfers:b.uploading.transfers},null,8,["modelValue","transfers"])]),_:1})}}};var _t=a(9078),xt=a(8416),qt=a(6914),At=a(6031),Ft=a(5205);const yt=wt,Et=yt;E()(wt,"components",{QLayout:_t.A,QHeader:xt.A,QToolbar:qt.A,QBtn:Ae.A,QBtnGroup:At.A,QPageContainer:Ft.A})}}]);