"use strict";(globalThis["webpackChunkhomedocs"]=globalThis["webpackChunkhomedocs"]||[]).push([[527],{8957:(e,a,t)=>{t.r(a),t.d(a,{default:()=>Ue});var l=t(1758),s=t(8734),r=t(3394),o=(t(310),t(2203),t(6724),t(9104)),n=t(8790),i=t(3537),d=t(5192),u=t(4907),m=t(3597),c=t(8051),p=t(7836),g=t(2732),b=t(4199),v=t(1307);function f(){const{bus:e}=(0,m.U)(),{fullDateTimeHuman:a,timeAgo:t,currentTimestamp:l,currentFullDateTimeHuman:r,currentTimeAgo:o}=(0,b.c)(),{dateTimeFormat:n}=(0,v.M)(),i=e=>e.replace(/[.*+?^=!:${}()|\[\]\/\\]/g,"\\$&"),u=()=>{const e=(0,s.Kh)({id:(0,d.A)(),body:null,createdOnTimestamp:l(),creationDate:r(),creationDateTimeAgo:o(),expanded:!1,startOnEditMode:!0});return e},c=()=>{const i=(0,s.Kh)({id:null,title:null,description:null,createdOn:{timestamp:null,dateTime:null,timeAgo:null},lastUpdate:{timestamp:null,dateTime:null,timeAgo:null},attachments:[],tags:[],notes:[],historyOperations:[],hasAttachments(){return i.attachments?.length>0},hasTags(){return i.tags?.length>0},hasNotes(){return i.notes?.length>0},hasHistoryOperations(){return i.historyOperations?.length>0},reset(){i.id=null,i.title=null,i.description=null,i.createdOn.timestamp=null,i.createdOn.dateTime=null,i.createdOn.timeAgo=null,i.lastUpdate.timestamp=null,i.lastUpdate.dateTime=null,i.lastUpdate.timeAgo=null,i.attachments.length=0,i.tags.length=0,i.notes.length=0,i.historyOperations.length=0},setFromAPIJSON(e){i.id=e.id,i.title=e.title,i.description=e.description,e.createdOnTimestamp?(i.createdOn.timestamp=e.createdOnTimestamp,i.createdOn.dateTime=a(e.createdOnTimestamp,n.get()),i.createdOn.timeAgo=t(e.createdOnTimestamp)):(i.createdOn.timestamp=null,i.createdOn.dateTime=null,i.createdOn.timeAgo=null),e.lastUpdateTimestamp?(i.lastUpdate.timestamp=e.lastUpdateTimestamp,i.lastUpdate.dateTime=a(e.lastUpdateTimestamp,n.get()),i.lastUpdate.timeAgo=t(e.lastUpdateTimestamp)):(i.lastUpdate.timestamp=null,i.lastUpdate.dateTime=null,i.lastUpdate.timeAgo=null),i.tags.length=0,Array.isArray(e.tags)&&i.tags.push(...e.tags),i.attachments.length=0,Array.isArray(e.attachments)&&i.attachments.push(...JSON.parse(JSON.stringify(e.attachments)).map(e=>(e.creationDate=a(e.createdOnTimestamp,n.get()),e.creationDateTimeAgo=t(e.createdOnTimestamp),e.humanSize=g.Ay.humanStorageSize(e.size),e.url="api3/attachment/"+e.id,e.orphaned=!1,e))),i.notes.length=0,Array.isArray(e.notes)&&i.notes.push(...JSON.parse(JSON.stringify(e.notes)).map(e=>(e.creationDate=a(e.createdOnTimestamp,n.get()),e.creationDateTimeAgo=t(e.createdOnTimestamp),e.expanded=!1,e.startOnEditMode=!1,e))),i.historyOperations.length=0,Array.isArray(e.history)&&i.historyOperations.push(...JSON.parse(JSON.stringify(e.history)).map(e=>{switch(e.creationDate=a(e.operationTimestamp,n.get()),e.creationDateTimeAgo=t(e.operationTimestamp),e.operationType){case 1:e.label="Document created",e.icon="post_add";break;case 2:e.label="Document updated",e.icon="edit_note";break;default:e.label="Unknown operation",e.icon="error";break}return e}))},addAttachment(e,a,t){const n=e||(0,d.A)();i.attachments.unshift((0,s.Kh)({id:n,createdOnTimestamp:l(),creationDate:r(),creationDateTimeAgo:o(),name:a,size:t||0,hash:null,humanSize:t>0?g.Ay.humanStorageSize(t):null,url:"api3/attachment/"+n,orphaned:!0}))},removeAttachmentAtIdx(e){i.attachments?.splice(e,1)},previewAttachment(a){a>=0&&a<i.attachments?.length&&e.emit("showDocumentFilePreviewDialog",{document:{id:i.id,title:i.title,attachments:i.attachments},currentIndex:a})},addNote(){i.notes.unshift(u())},removeNoteAtIdx(e){i.notes?.splice(e,1)}});return i};return{escapeRegExp:i,getNewNote:u,getNewDocument:c}}var h=t(6520),k=t(9295);const A={class:"row q-col-gutter-x-sm"},y={style:{"font-size":"14px"}},R={key:0,class:"col-6"},q={style:{"font-size":"14px"}},_={__name:"DocumentMetadataTopForm",props:{createdOnTimestamp:{type:Number,required:!1,default:0,validator(e){return e>0}},lastUpdateTimestamp:{type:Number,required:!1,default:0,validator(e){return e>0}}},setup(e){const a=e,{t}=(0,i.s9)(),{screen:r}=(0,u.A)(),{fullDateTimeHuman:o,timeAgo:d}=(0,b.c)(),{dateTimeFormat:m}=(0,v.M)(),c=(0,l.EW)(()=>r.gt.xs),p=(0,s.KR)(a.createdOnTimestamp?o(a.createdOnTimestamp,m.get()):null),g=(0,s.KR)(a.lastUpdateTimestamp?o(a.lastUpdateTimestamp,m.get()):null),f=(0,s.KR)(a.createdOnTimestamp?d(a.createdOnTimestamp):null),h=(0,s.KR)(a.lastUpdateTimestamp?d(a.lastUpdateTimestamp):null);return(0,l.wB)(()=>a.createdOnTimestamp,e=>{p.value=e?o(e,m.get()):null,f.value=e?d(e):null}),(0,l.wB)(()=>a.lastUpdateTimestamp,e=>{g.value=e?o(e,m.get()):null,h.value=e?d(e):null}),(a,r)=>{const o=(0,l.g2)("q-input");return(0,l.uX)(),(0,l.CE)("div",A,[(0,l.Lk)("div",{class:(0,n.C4)({"col-6":e.createdOnTimestamp!=e.lastUpdateTimestamp,"col-12":e.createdOnTimestamp==e.lastUpdateTimestamp})},[(0,l.bF)(o,{dense:"",class:"q-mb-md",outlined:"",modelValue:p.value,"onUpdate:modelValue":r[0]||(r[0]=e=>p.value=e),label:(0,s.R1)(t)("Created on"),readonly:""},(0,l.eX)({_:2},[c.value?{name:"append",fn:(0,l.k6)(()=>[(0,l.Lk)("span",y,(0,n.v_)(f.value),1)]),key:"0"}:void 0]),1032,["modelValue","label"])],2),e.createdOnTimestamp!=e.lastUpdateTimestamp?((0,l.uX)(),(0,l.CE)("div",R,[(0,l.bF)(o,{dense:"",class:"q-mb-md",outlined:"",modelValue:g.value,"onUpdate:modelValue":r[1]||(r[1]=e=>g.value=e),label:(0,s.R1)(t)("Last update"),readonly:""},(0,l.eX)({_:2},[c.value?{name:"append",fn:(0,l.k6)(()=>[(0,l.Lk)("span",q,(0,n.v_)(h.value),1)]),key:"0"}:void 0]),1032,["modelValue","label"])])):(0,l.Q3)("",!0)])}}};var x=t(9270),F=t(8582),E=t.n(F);const D=_,T=D;E()(_,"components",{QInput:x.A});t(5962);var w=t(5801),V=t(2956),I=t(129),C=t(1112),O=t(2139);const U={key:1,class:"q-list-attachments-container scroll"},M={__name:"DocumentDetailsAttachments",props:{modelValue:{type:Array,required:!1,default:()=>[],validator(e){return Array.isArray(e)}},disable:{type:Boolean,required:!1,default:!1}},emits:["update:modelValue","addAttachment","previewAttachmentAtIndex"],setup(e,{emit:a}){const{t}=(0,i.s9)(),{bgDownload:r}=(0,w.q)(),{api:d}=(0,c.M)(),{bus:u}=(0,m.U)(),{allowPreview:p}=(0,V.h)(),{escapeRegExp:b}=f(),v=a,h=e,k=(0,s.Kh)({loading:!1,loadingError:!1,errorMessage:null,apiError:null}),A=(0,l.EW)(()=>h.disable||k.loading),y=(0,l.EW)({get(){return h.modelValue},set(e){v("update:modelValue",e)}}),R=(0,s.KR)([]),q=(0,l.EW)(()=>y.value?.length>0),_=(0,s.KR)(null),x=e=>{if(e){const a=new RegExp(b(e),"i");R.value=y.value?.filter(e=>!e.name?.match(a)).map(e=>e.id)}else R.value=[]},F=()=>{v("addAttachment")},E=e=>{y.value[e].orphaned?(k.loading=!0,k.loadingError=!1,k.errorMessage=null,k.apiError=null,d.document.removeFile(y.value[e].id).then(a=>{k.loading=!1,y.value=y.value.filter((a,t)=>t!==e)}).catch(e=>{if(k.loadingError=!0,e.isAPIError)switch(k.apiError=e.customAPIErrorDetails,e.response.status){case 401:k.errorMessage="Auth session expired, requesting new...",u.emit("reAuthRequired",{emitter:"DocumentDetailsAttachments.onRemoveAttachmentAtIndex"});break;default:k.errorMessage="API Error: fatal error";break}else k.errorMessage=`Uncaught exception: ${e}`,console.error(e);k.loading=!1})):y.value=y.value.filter((a,t)=>t!==e)},D=e=>{v("previewAttachmentAtIndex",e)},T=(e,a)=>{r(e,a).then(e=>{}).catch(e=>{})};return(0,l.sV)(()=>{u.on("reAuthSucess",e=>{e.to?.includes("DocumentDetailsAttachments.onRemoveAttachmentAtIndex")})}),(0,l.xo)(()=>{u.off("reAuthSucess")}),(e,a)=>{const r=(0,l.g2)("q-icon"),i=(0,l.g2)("q-input"),d=(0,l.g2)("q-item-section"),u=(0,l.g2)("q-btn"),m=(0,l.g2)("q-item"),c=(0,l.g2)("q-separator"),b=(0,l.g2)("q-item-label"),v=(0,l.g2)("q-avatar"),f=(0,l.g2)("q-chip"),h=(0,l.g2)("q-list");return(0,l.uX)(),(0,l.Wv)(h,{class:"bg-transparent q-pa-sm"},{default:(0,l.k6)(()=>[(0,l.bF)(m,{class:"transparent-background text-color-primary q-pa-none"},{default:(0,l.k6)(()=>[(0,l.bo)((0,l.bF)(d,null,{default:(0,l.k6)(()=>[(0,l.bF)(i,{type:"search",outlined:"",dense:"",clearable:"",disable:A.value||!q.value,modelValue:_.value,"onUpdate:modelValue":[a[0]||(a[0]=e=>_.value=e),x],modelModifiers:{trim:!0},label:(0,s.R1)(t)("Filter by text on file name"),placeholder:(0,s.R1)(t)("type text search condition")},{prepend:(0,l.k6)(()=>[(0,l.bF)(r,{name:"filter_alt"})]),_:1},8,["disable","modelValue","label","placeholder"])]),_:1},512),[[o.aG,q.value]]),(0,l.bF)(d,{side:""},{default:(0,l.k6)(()=>[(0,l.bF)(u,{size:"md",label:(0,s.R1)(t)("Add attachment"),icon:"add",class:"bg-blue text-white full-width",disable:A.value,onClick:(0,o.D$)(F,["stop"])},null,8,["label","disable"])]),_:1})]),_:1}),(0,l.bF)(c,{class:"q-my-md"}),k.loadingError&&k.errorMessage?((0,l.uX)(),(0,l.Wv)(C.A,{key:0,text:k.errorMessage,"api-error":k.apiError,class:"q-mt-lg"},null,8,["text","api-error"])):(0,l.Q3)("",!0),q.value?((0,l.uX)(),(0,l.CE)("div",U,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(y.value,(e,a)=>((0,l.uX)(),(0,l.CE)("div",{key:e.id},[(0,l.bo)((0,l.bF)(m,{class:"q-pa-xs bg-transparent",clickable:"",href:e.url,onClick:(0,o.D$)(a=>T(e.url,e.name),["stop","prevent"])},{default:(0,l.k6)(()=>[(0,l.bF)(d,{class:"q-mx-sm"},{default:(0,l.k6)(()=>[(0,l.bF)(b,null,{default:(0,l.k6)(()=>[(0,l.eW)((0,n.v_)((0,s.R1)(t)("Filename: "))+" "+(0,n.v_)(e.name),1)]),_:2},1024),(0,l.bF)(b,{caption:""},{default:(0,l.k6)(()=>[(0,l.eW)((0,n.v_)((0,s.R1)(t)("Size: "))+(0,n.v_)((0,s.R1)(g.Ay).humanStorageSize(e.size)),1)]),_:2},1024),(0,l.bF)(b,{caption:""},{default:(0,l.k6)(()=>[(0,l.eW)((0,n.v_)((0,s.R1)(t)("Uploaded on: "))+(0,n.v_)(e.creationDate)+" ("+(0,n.v_)(e.creationDateTimeAgo)+") ",1)]),_:2},1024)]),_:2},1024),(0,l.bF)(d,{side:"",middle:"",class:"q-mr-sm q-item-section-attachment-actions"},{default:(0,l.k6)(()=>[(0,l.bF)(f,{size:"md",square:"",class:(0,n.C4)(["theme-default-q-chip shadow-1 full-width text-center",{"cursor-not-allowed":A.value}]),clickable:!A.value,onClick:(0,o.D$)(e=>E(a),["stop","prevent"])},{default:(0,l.k6)(()=>[(0,l.bF)(v,{class:"theme-default-q-avatar text-white bg-blue-6",icon:"delete"}),(0,l.eW)(" "+(0,n.v_)((0,s.R1)(t)("Remove")),1)]),_:1},8,["class","clickable","onClick"]),(0,s.R1)(p)(e.name)?((0,l.uX)(),(0,l.Wv)(f,{key:0,size:"md",square:"",class:(0,n.C4)(["theme-default-q-chip shadow-1 full-width",{"cursor-not-allowed":A.value||!(0,s.R1)(p)(e.name)}]),clickable:!A.value&&(0,s.R1)(p)(e.name),onClick:(0,o.D$)(e=>D(a),["stop","prevent"])},{default:(0,l.k6)(()=>[(0,l.bF)(v,{class:"theme-default-q-avatar text-white bg-blue-6",icon:"preview"}),(0,l.eW)(" "+(0,n.v_)((0,s.R1)(t)("Preview")),1)]),_:1},8,["class","clickable","onClick"])):(0,l.Q3)("",!0)]),_:2},1024),(0,l.bF)(I.A,null,{default:(0,l.k6)(()=>[(0,l.eW)((0,n.v_)((0,s.R1)(t)("Click to download")),1)]),_:1})]),_:2},1032,["href","onClick"]),[[o.aG,!R.value.includes(e.id)]]),a!==y.value?.length-1?(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{key:0,class:"q-my-sm"},null,512)),[[o.aG,!R.value.includes(e.id)]]):(0,l.Q3)("",!0)]))),128))])):A.value?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(O.A,{key:2,warning:"",text:"No document attachments found",class:"q-ma-none"}))]),_:1})}}};var W=t(2807),Q=t(3999),S=t(124),X=t(5173),P=t(492),z=t(6384),L=t(386),K=t(3796),N=t(6760),$=t(3952);const B=(0,W.A)(M,[["__scopeId","data-v-de4861b0"]]),G=B;E()(M,"components",{QList:Q.A,QItem:S.A,QItemSection:X.A,QInput:x.A,QIcon:P.A,QBtn:z.A,QSeparator:L.A,QItemLabel:K.A,QChip:N.A,QAvatar:$.A});const H={key:0},J={class:"readonly-label"},Y={class:"absolute-top-right text-grey q-mt-sm"},j={key:0,class:"text-red q-ml-sm error-message"},Z={__name:"InteractiveTextFieldCustomInput",props:{startModeEditable:{type:Boolean,required:!1,default:!0},modelValue:{type:String,required:!1,default:""},label:{type:String,required:!1},maxLines:{type:Number,required:!1,default:2},rules:{type:Array,default:()=>[],validator(e){return Array.isArray(e)}},autofocus:{type:Boolean,default:!1},error:{type:Boolean,required:!1,default:!1},errorMessage:{type:String,required:!1,default:null}},emits:["update:modelValue"],setup(e,{expose:a,emit:t}){const r=e,d=(0,l.OA)(),{t:m}=(0,i.s9)(),c=(0,u.A)(),p=(0,l.EW)(()=>c.platform.is.desktop),g=t,b=(0,s.KR)(null),v=(0,s.KR)(!r.startModeEditable),f=(0,l.EW)({get(){return r.modelValue},set(e){g("update:modelValue",e)}}),h=(0,s.KR)(!p.value),k=(0,s.KR)(!0),A=()=>{(0,l.dY)(()=>{b.value?.focus()})},y=()=>{p.value&&(h.value=!0)},R=()=>{p.value&&(h.value=!1)},q=()=>{v.value=!v.value,v.value||A()},_=()=>{v.value=!1};return a({focus:A,unsetReadOnly:_}),(0,l.sV)(()=>{r.autofocus&&r.startModeEditable&&A()}),(a,t)=>{const i=(0,l.g2)("q-icon"),u=(0,l.g2)("q-input");return v.value?((0,l.uX)(),(0,l.CE)("div",H,[(0,l.Lk)("div",{class:(0,n.C4)(["cursor-pointer q-pa-sm q-mb-md relative-position white-space-pre-line read-only-input-container",{"border-error":e.error}]),onMouseenter:y,onMouseleave:R,onClick:q},[(0,l.Lk)("div",J,(0,n.v_)(r.label),1),(0,l.Lk)("span",Y,[(0,l.RG)(a.$slots,"top-icon-prepend",{showTopHoverIcons:h.value}),(0,l.bo)((0,l.bF)(i,{name:k.value?"expand":"unfold_less",size:"sm",onClick:t[0]||(t[0]=(0,o.D$)(e=>k.value=!k.value,["stop"])),"aria-label":(0,s.R1)(m)(k.value?"Click to expand":"Click to collapse")},{default:(0,l.k6)(()=>[(0,l.bF)(I.A,null,{default:(0,l.k6)(()=>[(0,l.eW)((0,n.v_)((0,s.R1)(m)(k.value?"Click to expand":"Click to collapse")),1)]),_:1})]),_:1},8,["name","aria-label"]),[[o.aG,h.value]]),(0,l.bo)((0,l.bF)(i,{name:"edit",size:"sm",class:"q-ml-sm","aria-label":(0,s.R1)(m)("Click to toggle edit mode")},{default:(0,l.k6)(()=>[(0,l.bF)(I.A,null,{default:(0,l.k6)(()=>[(0,l.eW)((0,n.v_)((0,s.R1)(m)("Click to toggle edit mode")),1)]),_:1})]),_:1},8,["aria-label"]),[[o.aG,h.value]]),(0,l.RG)(a.$slots,"top-icon-append",{showTopHoverIcons:h.value})]),(0,l.Lk)("div",{class:(0,n.C4)(["q-mt-sm",{collapsed:k.value}]),style:(0,n.Tr)(`--max-lines: ${e.maxLines}`)},(0,n.v_)(f.value),7)],34),e.error?((0,l.uX)(),(0,l.CE)("p",j,(0,n.v_)(e.errorMessage),1)):(0,l.Q3)("",!0)])):((0,l.uX)(),(0,l.Wv)(u,(0,l.v6)({key:1},(0,s.R1)(d),{ref_key:"qInputRef",ref:b,label:e.label,modelValue:f.value,"onUpdate:modelValue":t[1]||(t[1]=e=>f.value=e),modelModifiers:{trim:!0},rules:e.rules,error:e.error,"error-message":e.errorMessage}),{append:(0,l.k6)(()=>[e.error?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(i,{key:0,name:"done",class:"cursor-pointer",onClick:(0,o.D$)(q,["stop"])},{default:(0,l.k6)(()=>[(0,l.bF)(I.A,null,{default:(0,l.k6)(()=>[(0,l.eW)((0,n.v_)((0,s.R1)(m)("Click to toggle edit mode")),1)]),_:1})]),_:1})),(0,l.RG)(a.$slots,"icon-append-on-edit")]),_:3},16,["label","modelValue","rules","error","error-message"]))}}},ee=(0,W.A)(Z,[["__scopeId","data-v-380afeee"]]),ae=ee;E()(Z,"components",{QIcon:P.A,QInput:x.A});const te={key:0,class:"q-list-notes-container scroll"},le={__name:"DocumentDetailsNotes",props:{modelValue:{type:Array,required:!1,default:()=>[],validator(e){return Array.isArray(e)}},disable:{type:Boolean,required:!1,default:!1}},emits:["update:modelValue"],setup(e,{emit:a}){const{t}=(0,i.s9)(),{requiredFieldRules:r,fieldIsRequiredLabel:d}=(0,p.b)(),{escapeRegExp:u,getNewNote:m}=f(),c=a,g=e,b=(0,l.EW)({get(){return g.modelValue},set(e){c("update:modelValue",e)}}),v=(0,s.KR)([]),h=(0,l.EW)(()=>b.value?.length>0),k=(0,s.KR)(null),A=e=>{if(e){const a=new RegExp(u(e),"i");v.value=b.value?.filter(e=>!e.body?.match(a)).map(e=>e.id)}else v.value=[]},y=()=>{b.value=[m(),...b.value]},R=e=>{b.value=b.value.filter((a,t)=>t!==e)};return(a,i)=>{const u=(0,l.g2)("q-icon"),m=(0,l.g2)("q-input"),c=(0,l.g2)("q-item-section"),p=(0,l.g2)("q-btn"),g=(0,l.g2)("q-item"),f=(0,l.g2)("q-separator"),q=(0,l.g2)("q-list");return(0,l.uX)(),(0,l.Wv)(q,{class:"bg-transparent q-pa-sm"},{default:(0,l.k6)(()=>[(0,l.bF)(g,{class:"transparent-background text-color-primary q-pa-none"},{default:(0,l.k6)(()=>[(0,l.bo)((0,l.bF)(c,null,{default:(0,l.k6)(()=>[(0,l.bF)(m,{type:"search",outlined:"",dense:"",clearable:"",disable:e.disable||!h.value,modelValue:k.value,"onUpdate:modelValue":[i[0]||(i[0]=e=>k.value=e),A],modelModifiers:{trim:!0},label:(0,s.R1)(t)("Filter by text on note body"),placeholder:(0,s.R1)(t)("type text search condition")},{prepend:(0,l.k6)(()=>[(0,l.bF)(u,{name:"filter_alt"})]),_:1},8,["disable","modelValue","label","placeholder"])]),_:1},512),[[o.aG,h.value]]),(0,l.bF)(c,{side:""},{default:(0,l.k6)(()=>[(0,l.bF)(p,{size:"md",label:(0,s.R1)(t)("Add note"),icon:"add",class:"bg-blue text-white full-width",disable:e.disable,onClick:(0,o.D$)(y,["stop","prevent"])},null,8,["label","disable"])]),_:1})]),_:1}),(0,l.bF)(f,{class:"q-my-md"}),h.value?((0,l.uX)(),(0,l.CE)("div",te,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(b.value,(a,i)=>(0,l.bo)(((0,l.uX)(),(0,l.Wv)(g,{class:"q-pa-none bg-transparent",key:a.id},{default:(0,l.k6)(()=>[(0,l.bF)(c,null,{default:(0,l.k6)(()=>[(0,l.bF)(ae,{modelValue:a.body,"onUpdate:modelValue":e=>a.body=e,modelModifiers:{trim:!0},dense:"",outlined:"",type:"textarea",maxlength:"4096",autogrow:"",name:"description",label:`${a.creationDate} (${a.creationDateTimeAgo})`,"start-mode-editable":!!a.startOnEditMode,disable:e.disable,clearable:"","max-lines":6,rules:(0,s.R1)(r),error:!a.body,"error-message":(0,s.R1)(d),autofocus:a.startOnEditMode,placeholder:(0,s.R1)(t)("type note body")},{"top-icon-append":(0,l.k6)(({showTopHoverIcons:e})=>[(0,l.bo)((0,l.bF)(u,{name:"delete",size:"sm",class:"q-ml-sm q-mr-sm",clickable:"",onClick:(0,o.D$)(e=>R(i),["stop","prevent"])},{default:(0,l.k6)(()=>[(0,l.bF)(I.A,null,{default:(0,l.k6)(()=>[(0,l.eW)((0,n.v_)((0,s.R1)(t)("Click to remove note")),1)]),_:1})]),_:1},8,["onClick"]),[[o.aG,e]])]),"icon-append-on-edit":(0,l.k6)(()=>[(0,l.bF)(u,{name:"delete",size:"sm",class:"cursor-pointer",clickable:"",onClick:(0,o.D$)(e=>R(i),["stop","prevent"])},null,8,["onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","label","start-mode-editable","disable","rules","error","error-message","autofocus","placeholder"])]),_:2},1024)]),_:2},1024)),[[o.aG,!v.value.includes(a.id)]])),128))])):e.disable?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(O.A,{key:1,warning:"",text:"No document notes found",class:"q-ma-none"}))]),_:1})}}},se=(0,W.A)(le,[["__scopeId","data-v-252f544a"]]),re=se;E()(le,"components",{QList:Q.A,QItem:S.A,QItemSection:X.A,QInput:x.A,QIcon:P.A,QBtn:z.A,QSeparator:L.A});const oe={class:"text-left"},ne={class:"text-left"},ie={__name:"DocumentDetailsHistory",props:{modelValue:{type:Array,required:!1,default:()=>[],validator(e){return Array.isArray(e)}},disable:{type:Boolean,required:!1,default:!1}},setup(e){const{t:a}=(0,i.s9)(),t=e,r=(0,l.EW)({get(){return t.modelValue},set(e){emit("update:modelValue",e)}}),o=(0,l.EW)(()=>r.value?.length>0);return(t,i)=>{const d=(0,l.g2)("q-icon"),u=(0,l.g2)("q-markup-table");return o.value?((0,l.uX)(),(0,l.Wv)(u,{key:0,class:"bg-transparent q-pa-sm q-list-history-container scroll"},{default:(0,l.k6)(()=>[(0,l.Lk)("thead",null,[(0,l.Lk)("tr",null,[(0,l.Lk)("th",oe,(0,n.v_)((0,s.R1)(a)("Date")),1),(0,l.Lk)("th",ne,(0,n.v_)((0,s.R1)(a)("Operation")),1)])]),(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.value,e=>((0,l.uX)(),(0,l.CE)("tr",{key:e.historyOperationTimestamp},[(0,l.Lk)("td",null,(0,n.v_)(e.creationDate)+" ("+(0,n.v_)(e.creationDateTimeAgo)+")",1),(0,l.Lk)("td",null,[(0,l.bF)(d,{size:"md",name:e.icon,class:"q-mr-sm"},null,8,["name"]),(0,l.eW)((0,n.v_)((0,s.R1)(a)(e.label)),1)])]))),128))])]),_:1})):e.disable?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(O.A,{key:1,warning:"",text:"No document history found",class:"q-ma-none"}))}}};var de=t(857);const ue=(0,W.A)(ie,[["__scopeId","data-v-05f6341b"]]),me=ue;E()(ie,"components",{QMarkupTable:de.A,QList:Q.A,QIcon:P.A});var ce=t(7091);const pe={class:"q-ma-md"},ge={__name:"DeleteDocumentConfirmationDialog",props:{documentId:{type:String,required:!0}},emits:["close"],setup(e,{emit:a}){const{t}=(0,i.s9)(),d=a,{bus:u}=(0,m.U)(),{api:p}=(0,c.M)(),g=(0,r.rd)(),b=e,v=(0,s.KR)(!0),f=(0,s.Kh)({loading:!1,loadingError:!1,errorMessage:null,apiError:null,deleted:!1}),h=()=>{f.loading=!0,f.loadingError=!1,f.errorMessage=null,f.apiError=null,p.document.remove(b.documentId).then(e=>{f.loading=!1,f.deleted=!0}).catch(e=>{if(f.loadingError=!0,e.isAPIError)switch(f.apiError=e.customAPIErrorDetails,e.response.status){case 401:f.errorMessage="Auth session expired, requesting new...",u.emit("reAuthRequired",{emitter:"DeleteDocumentConfirmationDialog.onDelete"});break;case 403:f.errorMessage="Error removing (non existent) document";break;case 404:f.errorMessage="Error removing document: access denied";break;default:f.errorMessage="API Error: fatal error";break}else f.errorMessage=`Uncaught exception: ${e}`,console.error(e);f.loading=!1})},k=()=>{v.value=!1,f.deleted?g.push({name:"index"}):d("close")};return(0,l.sV)(()=>{u.on("reAuthSucess",e=>{e.to?.includes("DeleteDocumentConfirmationDialog.onDelete")&&h()})}),(0,l.xo)(()=>{u.off("reAuthSucess")}),(e,a)=>{const r=(0,l.g2)("q-btn");return(0,l.uX)(),(0,l.Wv)(ce.A,{modelValue:v.value,"onUpdate:modelValue":a[0]||(a[0]=e=>v.value=e),onClose:k,width:"1280px","max-width":"80vw"},{"header-left":(0,l.k6)(()=>[(0,l.eW)((0,n.v_)((0,s.R1)(t)("Delete document")),1)]),body:(0,l.k6)(()=>[(0,l.Lk)("div",pe,[(0,l.Lk)("p",null,(0,n.v_)((0,s.R1)(t)("You are about to delete the current document. Are you sure? (this action cannot be undone).")),1),f.deleted?((0,l.uX)(),(0,l.Wv)(O.A,{key:0,class:"q-mt-lg",success:"",text:"The document has been deleted. Upon closing this dialog, you will be redirected to the home screen."})):f.loadingError?((0,l.uX)(),(0,l.Wv)(C.A,{key:1,text:f.errorMessage,"api-error":f.apiError,class:"q-mt-lg"},null,8,["text","api-error"])):(0,l.Q3)("",!0)])]),actions:(0,l.k6)(()=>[f.deleted?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(r,{key:0,class:"action-secondary",onClick:(0,o.D$)(k,["stop"]),icon:"close",label:(0,s.R1)(t)("Cancel"),disable:f.loading},null,8,["label","disable"])),f.deleted?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(r,{key:1,color:"primary",onClick:(0,o.D$)(h,["stop"]),icon:"done",label:(0,s.R1)(t)("Ok"),disable:f.loading},null,8,["label","disable"])),f.deleted?((0,l.uX)(),(0,l.Wv)(r,{key:2,color:"primary",onClick:(0,o.D$)(k,["stop"]),icon:"done",label:(0,s.R1)(t)("Close")},null,8,["label"])):(0,l.Q3)("",!0)]),_:1},8,["modelValue"])}}},be=ge,ve=be;E()(ge,"components",{QBtn:z.A});const fe={class:"col-12 col-lg-6 col-xl-6 q-px-sm flex"},he={class:"col-12 col-lg-6 col-xl-6 q-px-sm flex"},ke={__name:"DocumentForm",props:{documentId:{type:String,required:!1}},setup(e){const{t:a}=(0,i.s9)(),t=(0,r.rd)(),{screen:g}=(0,u.A)(),{bus:b}=(0,m.U)(),{api:v}=(0,c.M)(),A=(0,h.N)(),{requiredFieldRules:y,fieldIsRequiredLabel:R}=(0,p.b)(),q=e;(0,l.wB)(()=>q.documentId,e=>{e?(F.id=e,S()):(F.reset(),w.value?.unsetReadOnly(),(0,l.dY)(()=>w.value?.focus()))});const _=(0,l.EW)(()=>g.gt.md),x=(0,l.EW)(()=>!q.documentId),F=f().getNewDocument(),E=(0,l.EW)(()=>A.maxFileSize),D=(0,s.KR)(null),w=(0,s.KR)(null),V=(0,s.Kh)({loading:!1,saving:!1,deleting:!1,uploading:!1,loadingError:!1,errorMessage:null,apiError:null,saveSuccess:!1,savingError:!1,exists:!0}),I=(0,s.KR)(!1),U=(0,s.KR)("metadata"),M=(0,s.KR)("metadata"),W=(0,s.KR)("attachments"),Q=e=>{e.preventDefault();const a=e.dataTransfer.files;a.length&&D.value?.addFiles(a)},S=()=>{F.id&&(V.loading=!0,V.loadingError=!1,V.errorMessage=null,V.apiError=null,V.saveSuccess=!1,V.savingError=!1,V.exists=!0,U.value="metadata",v.document.get(F.id).then(e=>{F.setFromAPIJSON(e.data.document),V.loading=!1,(0,l.dY)(()=>w.value?.focus())}).catch(e=>{if(V.loadingError=!0,e.isAPIError)switch(V.apiError=e.customAPIErrorDetails,e.response.status){case 401:V.apiError=e.customAPIErrorDetails,V.errorMessage="Auth session expired, requesting new...",b.emit("reAuthRequired",{emitter:"DocumentPage.onRefresh"});break;case 404:V.apiError=e.customAPIErrorDetails,V.errorMessage="Document not found",V.exists=!1;break;default:V.errorMessage="API Error: fatal error";break}else V.errorMessage=`Uncaught exception: ${e}`,console.error(e);V.loading=!1}))},X=()=>{V.loading=!0,V.loadingError=!1,V.errorMessage=null,V.apiError=null,V.saveSuccess=!1,V.savingError=!1,V.saving=!0,x.value?(F.id||(F.id=(0,d.A)()),v.document.add(F).then(e=>{V.loading=!1,V.saving=!1,t.push({name:"document",params:{id:F.id}})}).catch(e=>{if(V.loadingError=!0,V.savingError=!0,e.isAPIError)switch(F.id=null,V.apiError=e.customAPIErrorDetails,e.response.status){case 400:e.response.data.invalidOrMissingParams.find(function(e){return"title"===e})?(V.errorMessage=a("API Error: missing document title param"),U.value="metadata",(0,l.dY)(()=>w.value?.focus())):e.response.data.invalidOrMissingParams.find(function(e){return"noteBody"===e})?(V.errorMessage=a("API Error: missing document note body"),U.value="details",W.value="notes"):V.errorMessage="API Error: fatal error";break;case 401:V.errorMessage="Auth session expired, requesting new...",b.emit("reAuthRequired",{emitter:"AdvancedSearchPage.onSubmitForm"});break;default:V.errorMessage="API Error: fatal error";break}else V.errorMessage=`Uncaught exception: ${e}`,console.error(e);V.loading=!1,V.saving=!1})):v.document.update(F).then(e=>{e.data.document?(F.setFromAPIJSON(e.data.document),V.loading=!1,V.saving=!1,V.saveSuccess=!0,"metadata"==U.value&&(0,l.dY)(()=>{w.value?.focus()})):(V.loading=!1,V.saving=!1)}).catch(e=>{if(V.loadingError=!0,V.savingError=!0,e.isAPIError)switch(V.apiError=e.customAPIErrorDetails,e.response.status){case 400:e.response.data.invalidOrMissingParams.find(function(e){return"title"===e})?(V.errorMessage=a("API Error: missing document title param"),U.value="metadata",(0,l.dY)(()=>w.value?.focus())):e.response.data.invalidOrMissingParams.find(function(e){return"noteBody"===e})?(V.errorMessage=a("API Error: missing document note body"),U.value="details",W.value="notes"):V.errorMessage="API Error: fatal error";break;case 401:V.errorMessage="Auth session expired, requesting new...",b.emit("reAuthRequired",{emitter:"AdvancedSearchPage.onSubmitForm"});break;default:V.errorMessage="API Error: fatal error";break}else V.errorMessage=`Uncaught exception: ${e}`,console.error(e);V.loading=!1,V.saving=!1})},P=()=>{F.id&&(I.value=!0)},z=()=>{W.value="attachments",(0,l.dY)(()=>{D.value.pickFiles()})},L=e=>{V.uploading=!0,b.emit("showUploadingDialog",{transfers:D.value?.files.map(e=>({name:e.name,size:e.size}))})},K=e=>{let a=null;try{a=JSON.parse(e.xhr.response)}catch(e){}if(null!=a)F.addAttachment(a.data.id,e.files[0].name,e.files[0].size),b.emit("refreshUploadingDialog.fileUploaded",{transfers:e.files.map(e=>({name:e.name,size:e.size}))});else{const a=e.files.map(e=>({name:e.name,size:e.size,error:{status:500,statusText:"Invalid JSON response"}}));b.emit("refreshUploadingDialog.fileUploadRejected",{transfers:a})}},N=e=>{const a=e.map(e=>({name:e.file.name,size:e.file.size,error:{status:"max-file-size"==e.failedPropValidation?413:500,statusText:"max-file-size"==e.failedPropValidation?"Content Too Large":"Internal Server Error"}}));b.emit("refreshUploadingDialog.fileUploadRejected",{transfers:a})},$=e=>{const a=e.files.map(a=>({name:a.name,size:a.size,error:{status:e.xhr.status,statusText:e.xhr.statusText}}));b.emit("refreshUploadingDialog.fileUploadFailed",{transfers:a})},B=()=>{V.uploading=!1,D.value?.reset()};return(0,l.sV)(()=>{x.value||q.documentId&&(F.id=q.documentId,S()),b.on("reAuthSucess",e=>{e.to?.includes("DocumentPage.onRefresh")&&S(),e.to?.includes("DocumentPage.onSubmitForm")&&X()})}),(0,l.xo)(()=>{b.off("reAuthSucess")}),(e,t)=>{const r=(0,l.g2)("q-uploader"),i=(0,l.g2)("q-spinner-hourglass"),d=(0,l.g2)("q-btn"),u=(0,l.g2)("q-btn-group"),m=(0,l.g2)("q-tab"),c=(0,l.g2)("q-tabs"),p=(0,l.g2)("q-card-section"),g=(0,l.g2)("q-card"),b=(0,l.g2)("q-badge"),v=(0,l.g2)("q-tab-panel"),f=(0,l.g2)("q-tab-panels");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("div",{onDragover:t[11]||(t[11]=(0,o.D$)(()=>{},["prevent"])),onDragenter:t[12]||(t[12]=(0,o.D$)(()=>{},["prevent"])),onDrop:Q},[(0,l.bF)(r,{ref_key:"uploaderRef",ref:D,class:"hidden","hide-upload-btn":"","no-thumbnails":"","auto-upload":"","field-name":"file",method:"post",url:"api3/attachment","max-file-size":E.value,multiple:"",onUploaded:K,onRejected:N,onFailed:$,onStart:L,onFinish:B},null,8,["max-file-size"]),(0,l.bF)(g,{flat:"",class:"bg-transparent"},{default:(0,l.k6)(()=>[(0,l.Lk)("form",{onSubmit:(0,o.D$)(X,["prevent","stop"]),autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false"},[V.exists?((0,l.uX)(),(0,l.Wv)(u,{key:0,class:"q-ma-sm",spread:""},{default:(0,l.k6)(()=>[(0,l.bF)(d,{type:"submit",icon:"save",size:"md",color:"primary",title:(0,s.R1)(a)("Save"),label:(0,s.R1)(a)("Save"),"no-caps":"",onClick:X,disable:V.loading||V.saving||V.uploading||!(0,s.R1)(F).title,loading:V.saving},{loading:(0,l.k6)(()=>[(0,l.bF)(i,{class:"on-left"}),(0,l.eW)(" "+(0,n.v_)((0,s.R1)(a)("Saving...")),1)]),_:1},8,["title","label","disable","loading"]),x.value?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(d,{key:0,type:"button",icon:"autorenew",size:"md",color:"secondary",title:(0,s.R1)(a)("Reload"),label:(0,s.R1)(a)("Reload"),"no-caps":"",onClick:S,loading:V.loading},{loading:(0,l.k6)(()=>[(0,l.bF)(i,{class:"on-left"}),(0,l.eW)(" "+(0,n.v_)((0,s.R1)(a)("Loading...")),1)]),_:1},8,["title","label","loading"])),x.value?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(d,{key:1,type:"button",icon:"delete",size:"md",color:"red",title:(0,s.R1)(a)("Delete"),label:(0,s.R1)(a)("Delete"),"no-caps":"",onClick:P},null,8,["title","label"]))]),_:1})):(0,l.Q3)("",!0),(0,l.bF)(c,{class:"lt-lg q-mb-sm",modelValue:U.value,"onUpdate:modelValue":t[0]||(t[0]=e=>U.value=e)},{default:(0,l.k6)(()=>[(0,l.bF)(m,{name:"metadata",icon:"description",label:(0,s.R1)(a)("Document metadata"),class:"cursor-default full-width"},null,8,["label"]),(0,l.bF)(m,{name:"details",icon:"list_alt",label:(0,s.R1)(a)("Document details"),class:"cursor-default full-width"},null,8,["label"])]),_:1},8,["modelValue"]),V.exists?((0,l.uX)(),(0,l.Wv)(p,{key:1,class:"row q-pa-none"},{default:(0,l.k6)(()=>[(0,l.bo)((0,l.Lk)("div",fe,[(0,l.bF)(g,{class:"q-ma-xs q-mt-sm full-width"},{default:(0,l.k6)(()=>[(0,l.bF)(p,{class:"q-pa-none q-mb-sm gt-md"},{default:(0,l.k6)(()=>[(0,l.bF)(c,{modelValue:M.value,"onUpdate:modelValue":t[1]||(t[1]=e=>M.value=e)},{default:(0,l.k6)(()=>[(0,l.bF)(m,{name:"metadata",icon:"description",label:(0,s.R1)(a)("Document metadata"),class:"cursor-default full-width"},null,8,["label"])]),_:1},8,["modelValue"])]),_:1}),(0,l.bF)(p,{class:"q-pa-md"},{default:(0,l.k6)(()=>[x.value?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(T,{key:0,"created-on-timestamp":(0,s.R1)(F).createdOn.timestamp,"last-update-timestamp":(0,s.R1)(F).lastUpdate.timestamp},null,8,["created-on-timestamp","last-update-timestamp"])),(0,l.bF)(ae,{ref_key:"documentTitleFieldRef",ref:w,dense:"",class:"q-mb-md",maxlength:"128",outlined:"",modelValue:(0,s.R1)(F).title,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,s.R1)(F).title=e),modelModifiers:{trim:!0},type:"textarea",autogrow:"",name:"title",label:(0,s.R1)(a)("Document title"),disable:V.loading||V.saving,autofocus:!0,clearable:"","start-mode-editable":x.value,rules:(0,s.R1)(y),error:!(0,s.R1)(F).title,"error-message":(0,s.R1)(R),"max-lines":1},null,8,["modelValue","label","disable","start-mode-editable","rules","error","error-message"]),(0,l.bF)(ae,{dense:"",class:"q-mb-md",outlined:"",modelValue:(0,s.R1)(F).description,"onUpdate:modelValue":t[3]||(t[3]=e=>(0,s.R1)(F).description=e),modelModifiers:{trim:!0},type:"textarea",maxlength:"4096",autogrow:"",name:"description",label:(0,s.R1)(a)("Document description"),disable:V.loading||V.saving,clearable:"","start-mode-editable":x.value,"max-lines":6},null,8,["modelValue","label","disable","start-mode-editable"]),(0,l.bF)(k.A,{dense:"",modelValue:(0,s.R1)(F).tags,"onUpdate:modelValue":t[4]||(t[4]=e=>(0,s.R1)(F).tags=e),disabled:V.loading||V.saving,"start-mode-editable":x.value,"deny-change-editable-mode":x.value,clearable:""},null,8,["modelValue","disabled","start-mode-editable","deny-change-editable-mode"])]),_:1})]),_:1})],512),[[o.aG,_.value||"metadata"==U.value]]),(0,l.bo)((0,l.Lk)("div",he,[(0,l.bF)(g,{class:"q-ma-xs q-mt-sm full-width"},{default:(0,l.k6)(()=>[(0,l.bF)(p,{class:"q-pa-none q-mb-sm",style:{"border-bottom":"2px solid rgba(0, 0, 0, 0.12)"}},{default:(0,l.k6)(()=>[(0,l.bF)(c,{modelValue:W.value,"onUpdate:modelValue":t[5]||(t[5]=e=>W.value=e),align:"left"},{default:(0,l.k6)(()=>[(0,l.bF)(m,{name:"attachments",icon:"attach_file",disable:V.loading,label:(0,s.R1)(a)("Attachments")},{default:(0,l.k6)(()=>[(0,l.bo)((0,l.bF)(b,{floating:""},{default:(0,l.k6)(()=>[(0,l.eW)((0,n.v_)((0,s.R1)(F).attachments.length),1)]),_:1},512),[[o.aG,(0,s.R1)(F).hasAttachments]])]),_:1},8,["disable","label"]),(0,l.bF)(m,{name:"notes",icon:"forum",disable:V.loading,label:(0,s.R1)(a)("Notes")},{default:(0,l.k6)(()=>[(0,l.bo)((0,l.bF)(b,{floating:""},{default:(0,l.k6)(()=>[(0,l.eW)((0,n.v_)((0,s.R1)(F).notes.length),1)]),_:1},512),[[o.aG,(0,s.R1)(F).hasNotes]])]),_:1},8,["disable","label"]),(0,s.R1)(F).id?((0,l.uX)(),(0,l.Wv)(m,{key:0,name:"history",icon:"view_timeline",disable:V.loading,label:(0,s.R1)(a)("History")},{default:(0,l.k6)(()=>[(0,l.bo)((0,l.bF)(b,{floating:""},{default:(0,l.k6)(()=>[(0,l.eW)((0,n.v_)((0,s.R1)(F).historyOperations.length),1)]),_:1},512),[[o.aG,(0,s.R1)(F).hasHistoryOperations]])]),_:1},8,["disable","label"])):(0,l.Q3)("",!0)]),_:1},8,["modelValue"])]),_:1}),(0,l.bF)(p,{class:"q-pa-none"},{default:(0,l.k6)(()=>[(0,l.bF)(f,{modelValue:W.value,"onUpdate:modelValue":t[10]||(t[10]=e=>W.value=e),animated:"",class:"bg-transparent"},{default:(0,l.k6)(()=>[(0,l.bF)(v,{name:"attachments",class:"q-pa-none"},{default:(0,l.k6)(()=>[(0,l.bF)(G,{modelValue:(0,s.R1)(F).attachments,"onUpdate:modelValue":t[6]||(t[6]=e=>(0,s.R1)(F).attachments=e),disable:V.loading||V.saving,onAddAttachment:z,onPreviewAttachmentAtIndex:t[7]||(t[7]=e=>(0,s.R1)(F).previewAttachment(e))},null,8,["modelValue","disable"])]),_:1}),(0,l.bF)(v,{name:"notes",class:"q-pa-none"},{default:(0,l.k6)(()=>[(0,l.bF)(re,{modelValue:(0,s.R1)(F).notes,"onUpdate:modelValue":t[8]||(t[8]=e=>(0,s.R1)(F).notes=e),disable:V.loading||V.saving},null,8,["modelValue","disable"])]),_:1}),(0,s.R1)(F).id?((0,l.uX)(),(0,l.Wv)(v,{key:0,name:"history",class:"q-pa-none"},{default:(0,l.k6)(()=>[(0,l.bF)(me,{modelValue:(0,s.R1)(F).historyOperations,"onUpdate:modelValue":t[9]||(t[9]=e=>(0,s.R1)(F).historyOperations=e),disable:V.loading||V.saving},null,8,["modelValue","disable"])]),_:1})):(0,l.Q3)("",!0)]),_:1},8,["modelValue"])]),_:1})]),_:1})],512),[[o.aG,_.value||"details"==U.value]])]),_:1})):(0,l.Q3)("",!0),(0,l.bF)(p,{class:"q-ma-xs q-mt-sm q-px-xs"},{default:(0,l.k6)(()=>[V.saveSuccess?((0,l.uX)(),(0,l.Wv)(O.A,{key:0,class:"q-mt-md",text:"Document saved",success:""})):V.loadingError||V.savingError?((0,l.uX)(),(0,l.Wv)(C.A,{key:1,class:"q-mt-md","api-error":V.apiError,text:V.errorMessage},null,8,["api-error","text"])):(0,l.Q3)("",!0)]),_:1}),V.exists?((0,l.uX)(),(0,l.Wv)(u,{key:2,class:"q-ma-sm",spread:""},{default:(0,l.k6)(()=>[(0,l.bF)(d,{type:"submit",icon:"save",size:"md",color:"primary",title:(0,s.R1)(a)("Save"),label:(0,s.R1)(a)("Save"),"no-caps":"",onClick:X,disable:V.loading||V.saving||V.uploading||!(0,s.R1)(F).title,loading:V.saving},{loading:(0,l.k6)(()=>[(0,l.bF)(i,{class:"on-left"}),(0,l.eW)(" "+(0,n.v_)((0,s.R1)(a)("Saving...")),1)]),_:1},8,["title","label","disable","loading"]),x.value?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(d,{key:0,type:"button",icon:"autorenew",size:"md",color:"secondary",title:(0,s.R1)(a)("Reload"),label:(0,s.R1)(a)("Reload"),"no-caps":"",onClick:S,loading:V.loading},{loading:(0,l.k6)(()=>[(0,l.bF)(i,{class:"on-left"}),(0,l.eW)(" "+(0,n.v_)((0,s.R1)(a)("Loading...")),1)]),_:1},8,["title","label","loading"])),x.value?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(d,{key:1,type:"button",icon:"delete",size:"md",color:"red",title:(0,s.R1)(a)("Delete"),label:(0,s.R1)(a)("Delete"),"no-caps":"",onClick:P},null,8,["title","label"]))]),_:1})):(0,l.Q3)("",!0)],32)]),_:1})],32),I.value?((0,l.uX)(),(0,l.Wv)(ve,{key:0,"document-id":(0,s.R1)(F).id,onClose:t[13]||(t[13]=e=>I.value=!1)},null,8,["document-id"])):(0,l.Q3)("",!0)],64)}}};var Ae=t(1298),ye=t(3316),Re=t(6031),qe=t(3194),_e=t(2980),xe=t(327),Fe=t(4189),Ee=t(3954),De=t(9041),Te=t(1746);const we=ke,Ve=we;E()(ke,"components",{QUploader:Ae.A,QCard:ye.A,QBtnGroup:Re.A,QBtn:z.A,QSpinnerHourglass:qe.A,QTabs:_e.A,QTab:xe.A,QCardSection:Fe.A,QBadge:Ee.A,QTabPanels:De.A,QTabPanel:Te.A});const Ie={__name:"DocumentPage",setup(e){const a=(0,r.rd)(),t=(0,r.lq)(),o=(0,s.KR)("document"==t.name&&t.params?.id||null);return a.beforeEach(async(e,a)=>{"newDocument"==e.name?o.value=null:"document"==e.name&&e.params.id&&(o.value=e.params.id)}),(e,a)=>{const t=(0,l.g2)("q-page");return(0,l.uX)(),(0,l.Wv)(t,null,{default:(0,l.k6)(()=>[(0,l.bF)(Ve,{"document-id":o.value},null,8,["document-id"])]),_:1})}}};var Ce=t(7716);const Oe=Ie,Ue=Oe;E()(Ie,"components",{QPage:Ce.A})}}]);