"use strict";(globalThis["webpackChunkhomedocs"]=globalThis["webpackChunkhomedocs"]||[]).push([[388],{9738:(e,a,t)=>{t.d(a,{A:()=>D});var l=t(1758),r=t(8734),o=t(8790),s=t(660),i=t(3537);const d={__name:"TagSelector",props:{modelValue:Array,disabled:Boolean,dense:Boolean},emits:["update:modelValue","error"],setup(e,{emit:a}){const{t}=(0,i.s9)(),d=e,n=a,u=(0,r.KR)(""),m=(0,r.KR)(!1),c=(0,r.KR)(!1),f=(0,r.KR)([]),D=(0,r.KR)([]),p=(0,l.EW)((()=>d.modelValue||[]));let b=[];function y(e,a){a(""===e?()=>{f.value=b.value}:()=>{const a=e.toLowerCase();f.value=b.filter((e=>e.toLowerCase().indexOf(a)>-1))})}function v(){c.value=!1,m.value=!0,s.api.tag.search().then((e=>{b=e.data.tags,D.value=p.value,m.value=!1})).catch((e=>{c.value=!0,m.value=!1,n("error",e.response)}))}function g(e){u.value.hidePopup()}function h(e){D.value.splice(e,1)}return(0,l.wB)(p,(e=>{D.value=e||[]})),(0,l.wB)(D,(e=>{n("update:modelValue",e||[])})),v(),(a,s)=>{const i=(0,l.g2)("q-chip"),d=(0,l.g2)("q-select");return(0,l.uX)(),(0,l.Wv)(d,{ref_key:"selectRef",ref:u,label:(0,r.R1)(t)("Tags"),modelValue:D.value,"onUpdate:modelValue":s[0]||(s[0]=e=>D.value=e),dense:e.dense,outlined:"","use-input":"","use-chips":"",multiple:"","hide-dropdown-icon":"",options:f.value,"input-debounce":"0","new-value-mode":"add-unique",clearable:"",disable:e.disabled||m.value||c.value,loading:m.value,error:c.value,errorMessage:(0,r.R1)(t)("Error loading available tags"),onFilter:y,onAdd:g},{selected:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(D.value,((e,a)=>((0,l.uX)(),(0,l.Wv)(i,{removable:"",key:e,onRemove:e=>h(a),color:"dark","text-color":"white",icon:"label_important"},{default:(0,l.k6)((()=>[(0,l.eW)((0,o.v_)(e),1)])),_:2},1032,["onRemove"])))),128))])),_:1},8,["label","modelValue","dense","options","disable","loading","error","errorMessage"])}}};var n=t(5178),u=t(6760),m=t(8582),c=t.n(m);const f=d,D=f;c()(d,"components",{QSelect:n.A,QChip:u.A})},4388:(e,a,t)=>{t.r(a),t.d(a,{default:()=>N});t(239);var l=t(1758),r=t(8790),o=t(8734),s=t(9104),i=t(455),d=t(6246),n=t(4907),u=t(3537),m=t(660),c=t(587);const f=(0,c.nY)("advancedSearchData",{state:()=>({filter:{title:null,description:null,dateFilterType:null,dateRange:null,fromDate:null,toDate:null,fromTimestamp:null,toTimestamp:null,tags:[]},sort:{field:"createdOnTimestamp",order:"DESC"},pager:{currentPage:1,resultsPage:32,totalResults:0,totalPages:0},results:[]}),getters:{isSortAscending:e=>"ASC"==e.sort,isSortDescending:e=>"DESC"==e.sort,sortField:e=>e.sort.field,sortOrder:e=>e.sort.order,hasResults:e=>e.results&&e.results.length>0,hasFromDateFilter:e=>e.filter.dateFilterType&&[3,4,5,6,8,10].includes(e.filter.dateFilterType.value),hasToDateFilter:e=>e.filter.dateFilterType&&[3,4,5,6,9,10].includes(e.filter.dateFilterType.value),hasFixedDateFilter:e=>e.filter.dateFilterType&&[1,2,7].includes(e.filter.dateFilterType.value),denyChangeDateFilters:e=>e.filter.dateFilterType&&[1,2,3,4,5,6].includes(e.filter.dateFilterType.value)},actions:{isSortedByField(e){return this.sort.field==e},toggleSort(e){this.sort.field==e?this.sort.order="ASC"==this.sort.order?"DESC":"ASC":(this.sort.field=e,this.sort.order="ASC")},setCurrentPage(e){this.pager.currentPage=e},recalcDates(e){switch(e.value){case 0:this.filter.fromDate=null,this.filter.fromTimestamp=null,this.filter.toDate=null,this.filter.toTimestamp=null;break;case 1:this.filter.fromDate=d.Ay.formatDate(Date.now(),"YYYY/MM/DD"),this.filter.toDate=d.Ay.formatDate(Date.now(),"YYYY/MM/DD");break;case 2:this.filter.fromDate=d.Ay.formatDate(d.Ay.addToDate(Date.now(),{days:-1}),"YYYY/MM/DD"),this.filter.toDate=d.Ay.formatDate(d.Ay.addToDate(Date.now(),{days:-1}),"YYYY/MM/DD");break;case 3:this.filter.fromDate=d.Ay.formatDate(d.Ay.addToDate(Date.now(),{days:-7}),"YYYY/MM/DD"),this.filter.toDate=d.Ay.formatDate(d.Ay.addToDate(Date.now(),{days:-1}),"YYYY/MM/DD");break;case 4:this.filter.fromDate=d.Ay.formatDate(d.Ay.addToDate(Date.now(),{days:-15}),"YYYY/MM/DD"),this.filter.toDate=d.Ay.formatDate(d.Ay.addToDate(Date.now(),{days:-1}),"YYYY/MM/DD");break;case 5:this.filter.fromDate=d.Ay.formatDate(d.Ay.addToDate(Date.now(),{days:-31}),"YYYY/MM/DD"),this.filter.toDate=d.Ay.formatDate(d.Ay.addToDate(Date.now(),{days:-1}),"YYYY/MM/DD");break;case 6:this.filter.fromDate=d.Ay.formatDate(d.Ay.addToDate(Date.now(),{days:-365}),"YYYY/MM/DD"),this.filter.toDate=d.Ay.formatDate(d.Ay.addToDate(Date.now(),{days:-1}),"YYYY/MM/DD");break;case 7:this.filter.fromDate=d.Ay.formatDate(Date.now(),"YYYY/MM/DD"),this.filter.toDate=d.Ay.formatDate(Date.now(),"YYYY/MM/DD");break;case 8:this.filter.fromDate=d.Ay.formatDate(Date.now(),"YYYY/MM/DD"),this.filter.toDate=d.Ay.formatDate(Date.now(),"YYYY/MM/DD");break;case 9:this.filter.fromDate=d.Ay.formatDate(Date.now(),"YYYY/MM/DD"),this.filter.toDate=d.Ay.formatDate(Date.now(),"YYYY/MM/DD");break;case 10:this.filter.fromDate=d.Ay.formatDate(Date.now(),"YYYY/MM/DD"),this.filter.toDate=d.Ay.formatDate(Date.now(),"YYYY/MM/DD");break}}}});var D=t(9738);const p={class:"q-pa-md"},b={class:"q-mt-sm"},y={class:"q-gutter-y-md"},v={class:"row"},g={class:"col"},h={key:0,class:"col"},k={class:"row items-center justify-end"},Y={key:1,class:"col"},R={class:"row items-center justify-end"},F={key:2,class:"col"},A={class:"row items-center justify-end"},_={key:0,class:"q-pa-lg flex flex-center"},M={class:"text-left"},w={class:"text-left"},T={class:"text-right"},V={key:1,class:"q-pa-lg flex flex-center"},C={__name:"AdvancedSearchPage",setup(e){const a=(0,n.A)(),{t}=(0,u.s9)(),c=(0,i.lq)(),C=(0,o.KR)(!1),x=(0,o.KR)(!1),q=(0,o.KR)(!0),P=(0,o.KR)(!1),S=(0,o.KR)([{label:t("Any date"),value:0},{label:t("Today"),value:1},{label:t("Yesterday"),value:2},{label:t("Last 7 days"),value:3},{label:t("Last 15 days"),value:4},{label:t("Last 31 days"),value:5},{label:t("Last 365 days"),value:6},{label:t("Fixed date"),value:7},{label:t("From date"),value:8},{label:t("To date"),value:9},{label:t("Between dates"),value:10}]),Q=f();Q.filter.dateFilterType=S.value[0],Q.filter.tags=void 0!==c.params.tag?[c.params.tag]:[];const L=(0,l.EW)((()=>Q.isSortAscending?"keyboard_double_arrow_up":"keyboard_double_arrow_down"));function X(e){Q.setCurrentPage(e),W(!1)}function E(e){Q.toggleSort(e),W(!1)}function W(e){e&&(Q.pager.currentPage=1),C.value=!0,d.Ay.isValid(Q.filter.fromDate)?Q.filter.fromTimestamp=d.Ay.formatDate(d.Ay.adjustDate(d.Ay.extractDate(Q.filter.fromDate,"YYYY/MM/DD"),{hour:0,minute:0,second:0,millisecond:0}),"X"):Q.filter.fromTimestamp=null,d.Ay.isValid(Q.filter.toDate)?Q.filter.toTimestamp=d.Ay.formatDate(d.Ay.adjustDate(d.Ay.extractDate(Q.filter.toDate,"YYYY/MM/DD"),{hour:23,minute:59,second:59,millisecond:999}),"X"):Q.filter.toTimestamp=null,m.api.document.search(Q.pager.currentPage,Q.pager.resultsPage,Q.filter,Q.sortField,Q.sortOrder).then((e=>{Q.pager=e.data.results.pagination,Q.results=e.data.results.documents.map((e=>(e.createdOn=d.Ay.formatDate(1e3*e.createdOnTimestamp,"YYYY-MM-DD HH:mm:ss"),e))),C.value=!1,x.value=!0,Q.hasResults&&(P.value=!0)})).catch((e=>{switch(e.response.status){case 400:a.notify({type:"negative",message:t("API Error: invalid/missing param")});break;case 401:this.$router.push({name:"signIn"});break;default:a.notify({type:"negative",message:t("API Error: fatal error"),caption:t("API Error: fatal error details",{status:e.response.status,statusText:e.response.statusText})});break}C.value=!1}))}return(0,l.wB)((()=>Q.filter.dateFilterType),(e=>{Q.recalcDates(e)})),Q.filter.tags.length>0&&W(!0),(e,a)=>{const i=(0,l.g2)("q-icon"),d=(0,l.g2)("q-input"),n=(0,l.g2)("q-select"),u=(0,l.g2)("q-btn"),m=(0,l.g2)("q-date"),c=(0,l.g2)("q-popup-proxy"),f=(0,l.g2)("q-spinner-hourglass"),U=(0,l.g2)("q-expansion-item"),B=(0,l.g2)("q-card-section"),K=(0,l.g2)("q-card"),I=(0,l.g2)("q-pagination"),O=(0,l.g2)("router-link"),j=(0,l.g2)("q-markup-table"),z=(0,l.g2)("q-banner"),H=(0,l.g2)("q-page"),$=(0,l.gN)("close-popup");return(0,l.uX)(),(0,l.Wv)(H,{class:"bg-grey-2"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",p,[(0,l.Lk)("h3",b,(0,r.v_)((0,o.R1)(t)("Advanced search")),1),(0,l.Lk)("div",y,[(0,l.bF)(K,null,{default:(0,l.k6)((()=>[(0,l.bF)(B,null,{default:(0,l.k6)((()=>[(0,l.bF)(U,{"expand-separator":"",icon:"filter_alt",label:(0,o.R1)(t)("Conditions"),"model-value":q.value},{default:(0,l.k6)((()=>[(0,l.Lk)("form",{onSubmit:a[10]||(a[10]=(0,s.D$)((e=>W(!0)),["prevent","stop"])),autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false",class:"q-mt-md"},[(0,l.bF)(d,{class:"q-mb-md",dense:"",outlined:"",modelValue:(0,o.R1)(Q).filter.title,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,o.R1)(Q).filter.title=e),type:"text",name:"title",clearable:"",label:(0,o.R1)(t)("Document title"),disable:C.value,autofocus:!0},{prepend:(0,l.k6)((()=>[(0,l.bF)(i,{name:"search"})])),_:1},8,["modelValue","label","disable"]),(0,l.bF)(d,{class:"q-mb-md",dense:"",outlined:"",modelValue:(0,o.R1)(Q).filter.description,"onUpdate:modelValue":a[1]||(a[1]=e=>(0,o.R1)(Q).filter.description=e),type:"text",name:"description",clearable:"",label:(0,o.R1)(t)("Document description"),disable:C.value},{prepend:(0,l.k6)((()=>[(0,l.bF)(i,{name:"search"})])),_:1},8,["modelValue","label","disable"]),(0,l.Lk)("div",v,[(0,l.Lk)("div",g,[(0,l.bF)(n,{class:"q-mb-md",dense:"",outlined:"",modelValue:(0,o.R1)(Q).filter.dateFilterType,"onUpdate:modelValue":a[2]||(a[2]=e=>(0,o.R1)(Q).filter.dateFilterType=e),options:S.value,label:(0,o.R1)(t)("Document date"),disable:C.value},null,8,["modelValue","options","label","disable"])]),(0,o.R1)(Q).hasFromDateFilter?((0,l.uX)(),(0,l.CE)("div",h,[(0,l.bF)(d,{dense:"",outlined:"",mask:"date",modelValue:(0,o.R1)(Q).filter.fromDate,"onUpdate:modelValue":a[4]||(a[4]=e=>(0,o.R1)(Q).filter.fromDate=e),label:(0,o.R1)(t)("From date"),disable:C.value||(0,o.R1)(Q).denyChangeDateFilters},{append:(0,l.k6)((()=>[(0,l.bF)(i,{name:"event",class:"cursor-pointer"},{default:(0,l.k6)((()=>[(0,l.bF)(c,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,l.k6)((()=>[(0,l.bF)(m,{modelValue:(0,o.R1)(Q).filter.fromDate,"onUpdate:modelValue":a[3]||(a[3]=e=>(0,o.R1)(Q).filter.fromDate=e),"today-btn":"",disable:C.value||(0,o.R1)(Q).denyChangeDateFilters},{default:(0,l.k6)((()=>[(0,l.Lk)("div",k,[(0,l.bo)((0,l.bF)(u,{label:"Close",color:"primary",flat:""},null,512),[[$]])])])),_:1},8,["modelValue","disable"])])),_:1})])),_:1})])),_:1},8,["modelValue","label","disable"])])):(0,l.Q3)("",!0),(0,o.R1)(Q).hasToDateFilter?((0,l.uX)(),(0,l.CE)("div",Y,[(0,l.bF)(d,{dense:"",outlined:"",mask:"date",modelValue:(0,o.R1)(Q).filter.toDate,"onUpdate:modelValue":a[6]||(a[6]=e=>(0,o.R1)(Q).filter.toDate=e),label:(0,o.R1)(t)("To date"),disable:C.value||(0,o.R1)(Q).denyChangeDateFilters},{append:(0,l.k6)((()=>[(0,l.bF)(i,{name:"event",class:"cursor-pointer"},{default:(0,l.k6)((()=>[(0,l.bF)(c,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,l.k6)((()=>[(0,l.bF)(m,{modelValue:(0,o.R1)(Q).filter.toDate,"onUpdate:modelValue":a[5]||(a[5]=e=>(0,o.R1)(Q).filter.toDate=e),"today-btn":"",disable:C.value||(0,o.R1)(Q).denyChangeDateFilters},{default:(0,l.k6)((()=>[(0,l.Lk)("div",R,[(0,l.bo)((0,l.bF)(u,{label:"Close",color:"primary",flat:""},null,512),[[$]])])])),_:1},8,["modelValue","disable"])])),_:1})])),_:1})])),_:1},8,["modelValue","label","disable"])])):(0,l.Q3)("",!0),(0,o.R1)(Q).hasFixedDateFilter?((0,l.uX)(),(0,l.CE)("div",F,[(0,l.bF)(d,{dense:"",outlined:"",mask:"date",modelValue:(0,o.R1)(Q).filter.fromDate,"onUpdate:modelValue":a[8]||(a[8]=e=>(0,o.R1)(Q).filter.fromDate=e),label:(0,o.R1)(t)("Fixed date"),disable:C.value||(0,o.R1)(Q).denyChangeDateFilters},{append:(0,l.k6)((()=>[(0,l.bF)(i,{name:"event",class:"cursor-pointer"},{default:(0,l.k6)((()=>[(0,l.bF)(c,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,l.k6)((()=>[(0,l.bF)(m,{modelValue:(0,o.R1)(Q).filter.fromDate,"onUpdate:modelValue":a[7]||(a[7]=e=>(0,o.R1)(Q).filter.fromDate=e),"today-btn":"",disable:C.value||(0,o.R1)(Q).denyChangeDateFilters},{default:(0,l.k6)((()=>[(0,l.Lk)("div",A,[(0,l.bo)((0,l.bF)(u,{label:"Close",color:"primary",flat:""},null,512),[[$]])])])),_:1},8,["modelValue","disable"])])),_:1})])),_:1})])),_:1},8,["modelValue","label","disable"])])):(0,l.Q3)("",!0)]),(0,l.bF)(D.A,{modelValue:(0,o.R1)(Q).filter.tags,"onUpdate:modelValue":a[9]||(a[9]=e=>(0,o.R1)(Q).filter.tags=e),disabled:C.value||(0,o.R1)(Q).denyChangeDateFilters,dense:""},null,8,["modelValue","disabled"]),(0,l.bF)(u,{color:"dark",size:"md",label:e.$t("Search"),"no-caps":"",class:"full-width",icon:"search",disable:C.value,loading:C.value,type:"submit"},{loading:(0,l.k6)((()=>[(0,l.bF)(f,{class:"on-left"}),(0,l.eW)(" "+(0,r.v_)((0,o.R1)(t)("Searching...")),1)])),_:1},8,["label","disable","loading"])],32)])),_:1},8,["label","model-value"])])),_:1})])),_:1}),x.value?((0,l.uX)(),(0,l.Wv)(K,{key:0},{default:(0,l.k6)((()=>[(0,l.bF)(B,null,{default:(0,l.k6)((()=>[(0,o.R1)(Q).hasResults?((0,l.uX)(),(0,l.Wv)(U,{key:0,"expand-separator":"",icon:"folder_open",label:(0,o.R1)(t)("Results")+" ("+(0,o.R1)(Q).pager.totalResults+")","model-value":P.value},{default:(0,l.k6)((()=>[(0,o.R1)(Q).pager.totalPages>1?((0,l.uX)(),(0,l.CE)("div",_,[(0,l.bF)(I,{modelValue:(0,o.R1)(Q).pager.currentPage,"onUpdate:modelValue":[a[11]||(a[11]=e=>(0,o.R1)(Q).pager.currentPage=e),X],color:"dark",max:(0,o.R1)(Q).pager.totalPages,"max-pages":5,"boundary-numbers":"","direction-links":"","boundary-links":"",disable:C.value},null,8,["modelValue","max","disable"])])):(0,l.Q3)("",!0),(0,l.bF)(j,null,{default:(0,l.k6)((()=>[(0,l.Lk)("thead",null,[(0,l.Lk)("tr",null,[(0,l.Lk)("th",{style:{width:"60%"},class:"text-left cursor-pointer",onClick:a[12]||(a[12]=e=>E("title"))},[(0,l.eW)((0,r.v_)((0,o.R1)(t)("Title"))+" ",1),(0,o.R1)(Q).isSortedByField("title")?((0,l.uX)(),(0,l.Wv)(i,{key:0,name:L.value,size:"sm"},null,8,["name"])):(0,l.Q3)("",!0)]),(0,l.Lk)("th",{style:{width:"20%"},class:"text-left cursor-pointer",onClick:a[13]||(a[13]=e=>E("createdOnTimestamp"))},[(0,l.eW)((0,r.v_)((0,o.R1)(t)("Date"))+" ",1),(0,o.R1)(Q).isSortedByField("createdOnTimestamp")?((0,l.uX)(),(0,l.Wv)(i,{key:0,name:L.value,size:" sm"},null,8,["name"])):(0,l.Q3)("",!0)]),(0,l.Lk)("th",{style:{width:"10%"},class:"text-right cursor-pointer",onClick:a[14]||(a[14]=e=>E("fileCount"))},[(0,l.eW)((0,r.v_)((0,o.R1)(t)("Files")),1),(0,o.R1)(Q).isSortedByField("fileCount")?((0,l.uX)(),(0,l.Wv)(i,{key:0,name:L.value,size:"sm"},null,8,["name"])):(0,l.Q3)("",!0)])])]),(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)((0,o.R1)(Q).results,(e=>((0,l.uX)(),(0,l.CE)("tr",{key:e.id},[(0,l.Lk)("td",M,[(0,l.bF)(O,{to:{name:"document",params:{id:e.id}}},{default:(0,l.k6)((()=>[(0,l.eW)((0,r.v_)(e.title),1)])),_:2},1032,["to"])]),(0,l.Lk)("td",w,(0,r.v_)(e.createdOn),1),(0,l.Lk)("td",T,(0,r.v_)(e.fileCount),1)])))),128))])])),_:1}),(0,o.R1)(Q).pager.totalPages>1?((0,l.uX)(),(0,l.CE)("div",V,[(0,l.bF)(I,{modelValue:(0,o.R1)(Q).pager.currentPage,"onUpdate:modelValue":[a[15]||(a[15]=e=>(0,o.R1)(Q).pager.currentPage=e),X],color:"dark",max:(0,o.R1)(Q).pager.totalPages,"max-pages":5,"boundary-numbers":"","direction-links":"","boundary-links":"",disable:C.value},null,8,["modelValue","max","disable"])])):(0,l.Q3)("",!0)])),_:1},8,["label","model-value"])):((0,l.uX)(),(0,l.Wv)(z,{key:1,dense:""},{avatar:(0,l.k6)((()=>[(0,l.bF)(i,{name:"error"})])),default:(0,l.k6)((()=>[(0,l.eW)(" "+(0,r.v_)((0,o.R1)(t)("No results found with current filter")),1)])),_:1}))])),_:1})])),_:1})):(0,l.Q3)("",!0)])])])),_:1})}}};var x=t(7716),q=t(3316),P=t(4189),S=t(9459),Q=t(9270),L=t(492),X=t(5178),E=t(8975),W=t(4147),U=t(6384),B=t(3194),K=t(4700),I=t(857),O=t(6868),j=t(8672),z=t(8582),H=t.n(z);const $=C,N=$;H()(C,"components",{QPage:x.A,QCard:q.A,QCardSection:P.A,QExpansionItem:S.A,QInput:Q.A,QIcon:L.A,QSelect:X.A,QPopupProxy:E.A,QDate:W.A,QBtn:U.A,QSpinnerHourglass:B.A,QPagination:K.A,QMarkupTable:I.A,QBanner:O.A}),H()(C,"directives",{ClosePopup:j.A})}}]);