import{x as D,y as k,j as B,a as Q,b as V,e as d,w as r,h as u,a6 as q,p as m,ac as l,o as c,f as $,S as T,g as A,s as w,am as S}from"./index-BwTDC915.js";import{u as z,b as N,Q as g}from"./QBtn-BMgEeOPb.js";import{Q as P,b as C,u as H}from"./CustomErrorBanner.vue_vue_type_script_setup_true_lang-Cbck3fGF.js";import{h as I}from"./_plugin-vue_export-helper-Co9B7mNd.js";import{e as W}from"./QMarkupTable-CeWcxYwg.js";import{C as j}from"./ClosePopup-BcGTXUO_.js";import{f as E,a as R}from"./QItemLabel-BSQs6rL4.js";import{D as p}from"./dateTime-B2K_Uhl3.js";const F=D({name:"QSpace",setup(){const t=k("div",{class:"q-space"});return()=>t}}),U=D({name:"QCardActions",props:{...z,vertical:Boolean},setup(t,{slots:a}){const e=N(t),s=B(()=>`q-card__actions ${e.value} q-card__actions--${t.vertical===!0?"vert column":"horiz row"}`);return()=>k("div",{class:s.value},I(a.default))}}),x={class:"col flex items-center"},at=Q({__name:"BaseDialog",props:{modelValue:{type:Boolean},showHeaderCloseButton:{type:Boolean,default:!0},width:{default:null},minWidth:{default:null},maxWidth:{default:null},confirmationDialog:{type:Boolean,default:!1},disable:{type:Boolean,default:!1},persistent:{type:Boolean,default:!1},hideFooter:{type:Boolean,default:!1}},emits:["update:modelValue","show","close","confirm","cancel"],setup(t,{emit:a}){const{t:e}=V(),s=a,o=t,i=B({get(){return o.modelValue},set(n){s("update:modelValue",n)}}),h=()=>{s("show")},f=()=>{i.value=!1,s("close")},b=()=>{i.value=!1,s("confirm")},y=()=>{i.value=!1,s("cancel")};return(n,v)=>(c(),d(W,{modelValue:i.value,"onUpdate:modelValue":v[0]||(v[0]=O=>i.value=O),persistent:t.persistent,onHide:f,onShow:h},{default:r(()=>[u(P,{class:"q-card-base-dialog",style:q({width:t.width,minWidth:t.minWidth,maxWidth:t.maxWidth})},{default:r(()=>[u(C,{class:"q-py-xs row self-center q-dialog-header"},{default:r(()=>[l(n.$slots,"header",{},()=>[$("div",x,[l(n.$slots,"header-left")]),u(F),$("div",null,[l(n.$slots,"header-right"),t.showHeaderCloseButton&&!t.persistent?T((c(),d(g,{key:0,icon:"close",flat:"",round:"",dense:"","aria-label":"Close modal"},null,512)),[[j]]):m("",!0)])])]),_:3}),u(C,{class:"q-pa-none q-dialog-body"},{default:r(()=>[l(n.$slots,"body")]),_:3}),t.hideFooter?m("",!0):(c(),d(C,{key:0,class:"q-pa-none q-dialog-footer"},{default:r(()=>[l(n.$slots,"footer",{},()=>[u(U,{align:"right"},{default:r(()=>[l(n.$slots,"actions",{},()=>[l(n.$slots,"actions-prepend"),t.confirmationDialog?(c(),d(g,{key:0,class:"action-secondary",onClick:w(y,["stop"]),disable:t.disable,icon:"close",label:A(e)("Cancel")},null,8,["disable","label"])):m("",!0),t.confirmationDialog?(c(),d(g,{key:1,color:"primary",onClick:w(b,["stop"]),disable:t.disable,icon:"done",label:A(e)("Ok")},null,8,["disable","label"])):m("",!0),t.confirmationDialog?m("",!0):(c(),d(g,{key:2,color:"primary",size:"md","no-caps":"",onClick:w(f,["stop"]),disable:t.disable||t.persistent,icon:"close",label:A(e)("Close")},null,8,["disable","label"]))])]),_:3})])]),_:3}))]),_:3},8,["style"])]),_:3},8,["modelValue","persistent"]))}}),st=t=>!!t?.match(/.(jpg|jpeg|png|gif|mp3|pdf)$/i),it=t=>{if(t)return!!t?.match(/.(jpg|jpeg|png|gif)$/i)},nt=t=>!!t?.match(/.(mp3)$/i),ot=t=>!!t?.match(/.(pdf)$/i),lt=(t,a=!1)=>a?`${S}/attachment/${t}`:`/attachment/${t}`,dt=(t,a=!1)=>a?`${S}/attachment/${t}/inline`:`/attachment/${t}/inline`;class M{id;name;hash;size;humanSize;createdAt;orphaned;constructor(a,e,s,o,i,h){this.id=a,this.name=e,this.hash=s,this.size=o,this.humanSize=E.humanStorageSize(o),this.createdAt=i,this.orphaned=h}}class L{id;body;createdAt;expanded;startOnEditMode;constructor(a,e,s,o,i){this.id=a,this.body=e,this.createdAt=s,this.expanded=o,this.startOnEditMode=i}}class J{id;createdAt;label;icon;constructor(a,e){switch(this.id=H(),e){case 1:this.label="Document created",this.icon="post_add";break;case 2:this.label="Document updated",this.icon="edit_note";break;default:this.label="Unknown operation",this.icon="error";break}this.createdAt=a}}class rt{id;createdAt;updatedAt;title;description;tags;attachments;notes;historyOperations;constructor(a=null,e=null,s=null,o="",i="",h=[],f=[],b=[],y=[]){this.id=a,this.createdAt=e,this.updatedAt=s,this.title=o,this.description=i,this.tags=h,this.attachments=f,this.notes=b,this.historyOperations=y}hasTags=()=>this.tags.length>0;hasAttachments=()=>this.attachments.length>0;hasNotes=()=>this.notes.length>0;hasHistoryOperations=()=>this.historyOperations.length>0;reset=()=>{this.id=null,this.createdAt=null,this.updatedAt=null,this.title="",this.description="",this.tags.length=0,this.attachments.length=0,this.notes.length=0,this.historyOperations.length=0};previewAttachment=a=>a>=0&&a<this.attachments.length?(R.emit("showDocumentFilePreviewDialog",{document:{id:this.id,title:this.title,attachments:this.attachments},currentIndex:a}),!0):(console.error("Invalid attachment index",a),!1);parseJSONResponse(a,e){this.id=e.data.document.id,this.title=e.data.document.title,this.description=e.data.document.description||"",this.createdAt=new p(a,e.data.document.createdAtTimestamp),e.data.document.updatedAtTimestamp?this.updatedAt=new p(a,e.data.document.updatedAtTimestamp):this.updatedAt=null,this.tags.length=0,e.data.document.tags.length>0&&this.tags.push(...e.data.document.tags),this.attachments.length=0,e.data.document.attachments.length>0&&this.attachments.push(...e.data.document.attachments.map(s=>new M(s.id,s.name,s.hash,s.size,new p(a,s.createdAtTimestamp),!1))),this.notes.length=0,e.data.document.notes.length>0&&this.notes.push(...e.data.document.notes.map(s=>new L(s.id,s.body,new p(a,s.createdAtTimestamp),!1,!1))),this.historyOperations.length=0,e.data.document.historyOperations.length>0&&this.historyOperations.push(...e.data.document.historyOperations.map(s=>new J(new p(a,s.createdAtTimestamp),s.operationType)))}}export{M as A,rt as D,L as N,F as Q,at as _,nt as a,ot as b,st as c,lt as d,dt as g,it as i};
