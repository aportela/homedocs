import{Q as H}from"./QPage-DqAH0F3p.js";import{Q as S,c as y,d as J}from"./QItem-BX9y_1c8.js";import{Q as I,a as z,D as K}from"./dateTime-BFTmAOKA.js";import{u as X,b as Z}from"./use-timeout-Dk6CO65c.js";import{x as ee,z as te,j as C,y as ae,a as Q,b as B,l as $,k as D,_ as M,R as N,D as V,e as u,w as s,n as p,T as w,U as j,S as W,a3 as U,h as t,q as E,t as _,g as q,o,f as v,p as R,s as T}from"./index-B4QQtCX7.js";import{h as se}from"./_plugin-vue_export-helper-BlOQ7VLK.js";import{Q as x}from"./QItemLabel-CGAxV7IM.js";import{a as ne}from"./QCardSection-7odpSX0S.js";import{a as b,o as oe,c as re}from"./bus-CVwhliaE.js";import{a as L}from"./api-CoAF7EnE.js";import{d as A,a as F,_ as O}from"./CustomErrorBanner.vue_vue_type_script_setup_true_lang-DBTLD8xq.js";import{_ as Y}from"./CustomExpansionWidget.vue_vue_type_script_setup_true_lang-DowvR3NI.js";import{_ as G}from"./BrowseByTagButton.vue_vue_type_script_setup_true_lang-BqhrY0lq.js";import{_ as P}from"./ViewDocumentDetailsButton.vue_vue_type_script_setup_true_lang-X8tzi3Zg.js";import"./scroll-CCWCkPPq.js";import"./session-BvJG7K2f.js";import"./dateUtils-tkffsgZl.js";import"./index-CG2WSiiR.js";import"./serverEnvironment-AswETgyQ.js";const ie=["text","rect","circle","QBtn","QBadge","QChip","QToolbar","QCheckbox","QRadio","QToggle","QSlider","QRange","QInput","QAvatar"],le=["wave","pulse","pulse-x","pulse-y","fade","blink","none"],f=ee({name:"QSkeleton",props:{...X,tag:{type:String,default:"div"},type:{type:String,validator:n=>ie.includes(n),default:"rect"},animation:{type:String,validator:n=>le.includes(n),default:"wave"},animationSpeed:{type:[String,Number],default:1500},square:Boolean,bordered:Boolean,size:String,width:String,height:String},setup(n,{slots:d}){const g=te(),c=Z(n,g.proxy.$q),e=C(()=>{const h=n.size!==void 0?[n.size,n.size]:[n.width,n.height];return{"--q-skeleton-speed":`${n.animationSpeed}ms`,width:h[0],height:h[1]}}),l=C(()=>`q-skeleton q-skeleton--${c.value===!0?"dark":"light"} q-skeleton--type-${n.type}`+(n.animation!=="none"?` q-skeleton--anim q-skeleton--anim-${n.animation}`:"")+(n.square===!0?" q-skeleton--square":"")+(n.bordered===!0?" q-skeleton--bordered":""));return()=>ae(n.tag,{class:l.value,style:e.value},se(d.default))}});class ue{id;updatedAt;title;description;tags;attachmentCount;noteCount;constructor(d,g,c,e,l,h,m){this.id=d,this.updatedAt=g,this.title=c,this.description=e,this.tags=l,this.attachmentCount=h,this.noteCount=m}}const de={class:"row items-left q-gutter-sm"},ce={class:"text-weight-bold"},me={class:"text-weight-bold"},pe=Q({__name:"RecentDocumentsWidget",props:{expanded:{type:Boolean,default:!0}},setup(n){const{t:d}=B(),c=$(n.expanded),e=D({...A}),l=M([]),h=C(()=>l.value.length>0),m=()=>{e.ajaxRunning||(Object.assign(e,A),e.ajaxRunning=!0,L.document.searchRecent(16).then(r=>{l.value=r.data.documents.map(i=>new ue(i.id,new K(d,i.updatedAtTimestamp),i.title,i.description,i.tags,i.attachmentCount,i.noteCount))}).catch(r=>{if(e.ajaxErrors=!0,r.isAPIError)switch(e.ajaxAPIErrorDetails=r.customAPIErrorDetails,r.response.status){case 401:e.ajaxErrors=!1,b.emit("reAuthRequired",{emitter:"RecentDocumentsWidget"});break;default:e.ajaxErrorMessage="API Error: fatal error";break}else e.ajaxErrorMessage=`Uncaught exception: ${r}`,console.error(r)}).finally(()=>{e.ajaxRunning=!1}))};return N(()=>{m(),b.on("reAuthSucess",r=>{r.to?.includes("RecentDocumentsWidget")&&m()})}),V(()=>{b.off("reAuthSucess")}),(r,i)=>(o(),u(Y,{title:"Most recent activity",icon:"work_history","icon-tool-tip":"Click to refresh data","on-header-icon-click":m,loading:e.ajaxRunning,error:e.ajaxErrors,expanded:c.value,onExpand:i[0]||(i[0]=a=>c.value=!0),onCollapse:i[1]||(i[1]=a=>c.value=!1)},{"header-extra":s(()=>[W(t(z,{square:"",size:"sm",class:"theme-q-chip-highlight"},{default:s(()=>[E(_(q(d)("Total document count",{count:l.value.length})),1)]),_:1},512),[[U,l.value.length>0]])]),content:s(()=>[e.ajaxRunning?(o(),u(I,{key:0},{default:s(()=>[(o(),p(j,null,w(4,a=>v("div",{key:a,class:"border-bottom-except-last-item"},[t(S,{class:"transparent-background text-color-primary q-pa-sm"},{default:s(()=>[t(y,{top:"",avatar:"",class:"gt-xs q-mt-lg"},{default:s(()=>[t(f,{type:"QAvatar",square:"",size:"32px"})]),_:1}),t(y,{class:"q-mx-md"},{default:s(()=>[t(x,null,{default:s(()=>[t(f,{type:"text"})]),_:1}),t(x,{caption:"",lines:"2"},{default:s(()=>[t(f,{type:"text",height:"2em"})]),_:1}),t(x,null,{default:s(()=>[v("div",de,[(o(),p(j,null,w(5,k=>t(f,{square:"",width:"6em",height:"2em",class:"",key:k})),64))])]),_:1})]),_:1}),t(y,{side:"",top:""},{default:s(()=>[t(x,{caption:""},{default:s(()=>[t(f,{type:"text",width:"8em",height:"2em"}),t(f,{square:"",width:"8em",height:"2em",class:"q-mt-sm"}),t(f,{square:"",width:"8em",height:"2em",class:"q-mt-sm"})]),_:1})]),_:1})]),_:1})])),64))]),_:1})):e.ajaxErrors?(o(),u(F,{key:1,text:e.ajaxErrorMessage||"Error loading data","api-error":e.ajaxAPIErrorDetails},null,8,["text","api-error"])):h.value?(o(),u(I,{key:2},{default:s(()=>[(o(!0),p(j,null,w(l.value,a=>(o(),p("div",{key:a.id,class:"border-bottom-except-last-item"},[t(S,{class:"transparent-background text-color-primary q-pa-sm",clickable:"",to:{name:"document",params:{id:a.id}}},{default:s(()=>[t(y,{top:"",avatar:"",class:"gt-xs"},{default:s(()=>[t(ne,{square:"",icon:"work",size:"64px","aria-label":"Document avatar"})]),_:1}),t(y,{top:""},{default:s(()=>[t(x,null,{default:s(()=>[v("span",ce,_(q(d)("Title"))+":",1),E(" "+_(a.title),1)]),_:2},1024),a.description?(o(),u(x,{key:0,caption:"",lines:"2"},{default:s(()=>[v("span",me,_(q(d)("Description"))+":",1),E(" "+_(a.description),1)]),_:2},1024)):R("",!0),a.tags?.length>0?(o(),u(x,{key:1},{default:s(()=>[(o(!0),p(j,null,w(a.tags,k=>(o(),u(G,{key:k,tag:k,icon:"tag"},null,8,["tag"]))),128))]),_:2},1024)):R("",!0)]),_:2},1024),t(y,{side:"",top:""},{default:s(()=>[t(x,{caption:""},{default:s(()=>[E(_(a.updatedAt?.timeAgo),1)]),_:2},1024),t(P,{size:"md",square:"",class:"min-width-9em",count:a.attachmentCount,label:"Total attachments count","tool-tip":"View document attachments",disable:e.ajaxRunning,onClick:T(k=>q(oe)(a.id,a.title),["stop","prevent"])},null,8,["count","disable","onClick"]),t(P,{size:"md",square:"",class:"min-width-9em",count:a.noteCount,label:"Total notes","tool-tip":"View document notes",disable:e.ajaxRunning,onClick:T(k=>q(re)(a.id,a.title),["stop","prevent"])},null,8,["count","disable","onClick"])]),_:2},1024)]),_:2},1032,["to"])]))),128))]),_:1})):(o(),u(O,{key:3,warning:"",text:"You haven't created any documents yet"}))]),_:1},8,["loading","error","expanded"]))}}),ge={key:0,class:"row items-center q-gutter-sm q-mt-none q-pa-xs"},he={key:2},xe=Q({__name:"TagCloudWidget",props:{expanded:{type:Boolean,default:!0}},setup(n){const{t:d}=B(),c=$(n.expanded),e=D({...A}),l=M([]),h=C(()=>l.value.length>0),m=()=>{e.ajaxRunning||(Object.assign(e,A),e.ajaxRunning=!0,L.tag.getCloud().then(r=>{l.value=r.data.tags}).catch(r=>{if(e.ajaxErrors=!0,r.isAPIError)switch(e.ajaxAPIErrorDetails=r.customAPIErrorDetails,r.response.status){case 401:e.ajaxErrors=!1,b.emit("reAuthRequired",{emitter:"TagCloudWidget"});break;default:e.ajaxErrorMessage="API Error: fatal error";break}else e.ajaxErrorMessage=`Uncaught exception: ${r}`,console.error(r)}).finally(()=>{e.ajaxRunning=!1}))};return N(()=>{m(),b.on("reAuthSucess",r=>{r.to?.includes("TagCloudWidget")&&m()})}),V(()=>{b.off("reAuthSucess")}),(r,i)=>(o(),u(Y,{title:"Tag cloud",icon:"tag","icon-tool-tip":"Click to refresh data","on-header-icon-click":m,loading:e.ajaxRunning,error:e.ajaxErrors,expanded:c.value,onExpand:i[0]||(i[0]=a=>c.value=!0),onCollapse:i[1]||(i[1]=a=>c.value=!1)},{"header-extra":s(()=>[W(t(z,{square:"",size:"sm",class:"theme-q-chip-highlight"},{default:s(()=>[E(_(q(d)("Total tags",{count:l.value.length})),1)]),_:1},512),[[U,l.value.length>0]])]),content:s(()=>[e.ajaxRunning?(o(),p("div",ge,[(o(),p(j,null,w(32,a=>t(f,{square:"",width:"12em",height:"2em",class:"",key:a})),64))])):e.ajaxErrors?(o(),u(F,{key:1,text:e.ajaxErrorMessage||"Error loading data","api-error":e.ajaxAPIErrorDetails},null,8,["text","api-error"])):h.value?(o(),p("div",he,[(o(!0),p(j,null,w(l.value,a=>(o(),u(G,{key:a.tag,tag:a.tag,caption:String(a.total),"q-chip-class":"q-chip-10em"},null,8,["tag","caption"]))),128))])):(o(),u(O,{key:3,warning:"",text:"You haven't created any tags yet"}))]),_:1},8,["loading","error","expanded"]))}}),fe={class:"row q-col-gutter-sm"},_e={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-6"},ve={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-6"},Me=Q({__name:"IndexPage",setup(n){const d=J(),g=$(!d.screen.lt.md);return(c,e)=>(o(),u(H,null,{default:s(()=>[v("div",fe,[v("div",_e,[t(pe,{expanded:g.value},null,8,["expanded"])]),v("div",ve,[t(xe,{expanded:g.value},null,8,["expanded"])])])]),_:1}))}});export{Me as default};
