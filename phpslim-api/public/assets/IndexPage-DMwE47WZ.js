import{Q as F}from"./QPage-JA5HT188.js";import{b as Y,e as G,h as I,i as v,j as H}from"./QItem-D4EQvWHO.js";import{Q as R,a as M,D as J}from"./date-time-BzOgC_OT.js";import{p as K,s as X,g as C,q as Z,a as Q,i as S,h as A,M as B,z as D,c as u,w as s,j as p,O as w,P as j,e as t,l as E,t as _,u as q,o,b as k,k as T,m as P}from"./index-BSZHI2pT.js";import{h as ee}from"./_plugin-vue_export-helper-BidlGddk.js";import{a as b,Q as x,o as te,c as ae}from"./QItemLabel-D2xHNXGJ.js";import{d as $,c as N,_ as V,a as se}from"./CustomErrorBanner.vue_vue_type_script_setup_true_lang-a2ZcyAYi.js";import{a as W}from"./api-DiLYfQz-.js";import{_ as L}from"./CustomExpansionWidget.vue_vue_type_script_setup_true_lang-BNzkgcxa.js";import{_ as O}from"./BrowseByTagButton.vue_vue_type_script_setup_true_lang-DVpKc6yV.js";import{_ as z}from"./ViewDocumentDetailsButton.vue_vue_type_script_setup_true_lang-Chcpa00U.js";import{u as U}from"./vue-i18n.runtime-C1BpSJts.js";import"./localStorage-dsyGJO5t.js";import"./axios-RI6aZEej.js";import"./session-bV_Kq9am.js";const ne=["text","rect","circle","QBtn","QBadge","QChip","QToolbar","QCheckbox","QRadio","QToggle","QSlider","QRange","QInput","QAvatar"],oe=["wave","pulse","pulse-x","pulse-y","fade","blink","none"],f=K({name:"QSkeleton",props:{...Y,tag:{type:String,default:"div"},type:{type:String,validator:n=>ne.includes(n),default:"rect"},animation:{type:String,validator:n=>oe.includes(n),default:"wave"},animationSpeed:{type:[String,Number],default:1500},square:Boolean,bordered:Boolean,size:String,width:String,height:String},setup(n,{slots:d}){const g=X(),c=G(n,g.proxy.$q),e=C(()=>{const h=n.size!==void 0?[n.size,n.size]:[n.width,n.height];return{"--q-skeleton-speed":`${n.animationSpeed}ms`,width:h[0],height:h[1]}}),l=C(()=>`q-skeleton q-skeleton--${c.value===!0?"dark":"light"} q-skeleton--type-${n.type}`+(n.animation!=="none"?` q-skeleton--anim q-skeleton--anim-${n.animation}`:"")+(n.square===!0?" q-skeleton--square":"")+(n.bordered===!0?" q-skeleton--bordered":""));return()=>Z(n.tag,{class:l.value,style:e.value},ee(d.default))}});class re{id;updatedAt;title;description;tags;attachmentCount;noteCount;constructor(d,g,c,e,l,h,m){this.id=d,this.updatedAt=g,this.title=c,this.description=e,this.tags=l,this.attachmentCount=h,this.noteCount=m}}const ie={class:"row items-left q-gutter-sm"},le={class:"text-weight-bold"},ue={class:"text-weight-bold"},de=Q({__name:"RecentDocumentsWidget",props:{expanded:{type:Boolean,default:!0}},setup(n){const{t:d}=U(),c=S(n.expanded),e=A({...$}),l=A([]),h=C(()=>l.length>0),m=()=>{e.ajaxRunning||(Object.assign(e,$),e.ajaxRunning=!0,W.document.searchRecent(16).then(r=>{l.length=0,l.push(...r.data.documents.map(i=>new re(i.id,new J(d,i.updatedAtTimestamp),i.title,i.description,i.tags,i.attachmentCount,i.noteCount)))}).catch(r=>{if(e.ajaxErrors=!0,r.isAPIError)switch(e.ajaxAPIErrorDetails=r.customAPIErrorDetails,r.response.status){case 401:e.ajaxErrorMessage="Auth session expired, requesting new...",b.emit("reAuthRequired",{emitter:"RecentDocumentsWidget"});break;default:e.ajaxErrorMessage="API Error: fatal error";break}else e.ajaxErrorMessage=`Uncaught exception: ${r}`,console.error(r)}).finally(()=>{e.ajaxRunning=!1}))};return B(()=>{m(),b.on("reAuthSucess",r=>{r.to?.includes("RecentDocumentsWidget")&&m()})}),D(()=>{b.off("reAuthSucess")}),(r,i)=>(o(),u(L,{title:"Most recent activity",icon:"work_history","icon-tool-tip":"Click to refresh data","on-header-icon-click":m,loading:e.ajaxRunning,error:e.ajaxErrors,expanded:c.value,onExpand:i[0]||(i[0]=a=>c.value=!0),onCollapse:i[1]||(i[1]=a=>c.value=!1)},{"header-extra":s(()=>[t(M,{square:"",size:"sm",color:"grey-7","text-color":"white"},{default:s(()=>[E(_(q(d)("Total document count",{count:l.length})),1)]),_:1})]),content:s(()=>[e.ajaxRunning?(o(),u(R,{key:0},{default:s(()=>[(o(),p(j,null,w(4,a=>k("div",{key:a,class:"border-bottom-except-last-item"},[t(I,{class:"transparent-background text-color-primary q-pa-sm"},{default:s(()=>[t(v,{top:"",avatar:"",class:"gt-xs q-mt-lg"},{default:s(()=>[t(f,{type:"QAvatar",square:"",size:"32px"})]),_:1}),t(v,{class:"q-mx-md"},{default:s(()=>[t(x,null,{default:s(()=>[t(f,{type:"text"})]),_:1}),t(x,{caption:"",lines:"2"},{default:s(()=>[t(f,{type:"text",height:"2em"})]),_:1}),t(x,null,{default:s(()=>[k("div",ie,[(o(),p(j,null,w(5,y=>t(f,{square:"",width:"6em",height:"2em",class:"",key:y})),64))])]),_:1})]),_:1}),t(v,{side:"",top:""},{default:s(()=>[t(x,{caption:""},{default:s(()=>[t(f,{type:"text",width:"8em",height:"2em"}),t(f,{square:"",width:"8em",height:"2em",class:"q-mt-sm"}),t(f,{square:"",width:"8em",height:"2em",class:"q-mt-sm"})]),_:1})]),_:1})]),_:1})])),64))]),_:1})):e.ajaxErrors?(o(),u(N,{key:1,text:e.ajaxErrorMessage||"Error loading data","api-error":e.ajaxAPIErrorDetails},null,8,["text","api-error"])):h.value?(o(),u(R,{key:2},{default:s(()=>[(o(!0),p(j,null,w(l,a=>(o(),p("div",{key:a.id,class:"border-bottom-except-last-item"},[t(I,{class:"transparent-background text-color-primary q-pa-sm",clickable:"",to:{name:"document",params:{id:a.id}}},{default:s(()=>[t(v,{top:"",avatar:"",class:"gt-xs"},{default:s(()=>[t(se,{square:"",icon:"work",size:"64px","aria-label":"Document avatar"})]),_:1}),t(v,{top:""},{default:s(()=>[t(x,null,{default:s(()=>[k("span",le,_(q(d)("Title"))+":",1),E(" "+_(a.title),1)]),_:2},1024),a.description?(o(),u(x,{key:0,caption:"",lines:"2"},{default:s(()=>[k("span",ue,_(q(d)("Description"))+":",1),E(" "+_(a.description),1)]),_:2},1024)):T("",!0),a.tags?.length>0?(o(),u(x,{key:1},{default:s(()=>[(o(!0),p(j,null,w(a.tags,y=>(o(),u(O,{key:y,tag:y,icon:"tag"},null,8,["tag"]))),128))]),_:2},1024)):T("",!0)]),_:2},1024),t(v,{side:"",top:""},{default:s(()=>[t(x,{caption:""},{default:s(()=>[E(_(a.updatedAt?.timeAgo),1)]),_:2},1024),t(z,{size:"md",square:"",class:"min-width-9em",count:a.attachmentCount,label:"Total attachments count","tool-tip":"View document attachments",disable:e.ajaxRunning,onClick:P(y=>q(te)(a.id,a.title),["stop","prevent"])},null,8,["count","disable","onClick"]),t(z,{size:"md",square:"",class:"min-width-9em",count:a.noteCount,label:"Total notes","tool-tip":"View document notes",disable:e.ajaxRunning,onClick:P(y=>q(ae)(a.id,a.title),["stop","prevent"])},null,8,["count","disable","onClick"])]),_:2},1024)]),_:2},1032,["to"])]))),128))]),_:1})):(o(),u(V,{key:3,warning:"",text:"You haven't created any documents yet"}))]),_:1},8,["loading","error","expanded"]))}}),ce={key:0,class:"row items-center q-gutter-sm q-mt-none q-pa-xs"},me={key:2},pe=Q({__name:"TagCloudWidget",props:{expanded:{type:Boolean,default:!0}},setup(n){const{t:d}=U(),c=S(n.expanded),e=A({...$}),l=A([]),h=C(()=>l.length>0),m=()=>{e.ajaxRunning||(Object.assign(e,$),e.ajaxRunning=!0,W.tag.getCloud().then(r=>{l.length=0,l.push(...r.data.tags)}).catch(r=>{if(e.ajaxErrors=!0,r.isAPIError)switch(e.ajaxAPIErrorDetails=r.customAPIErrorDetails,r.response.status){case 401:e.ajaxErrorMessage="Auth session expired, requesting new...",b.emit("reAuthRequired",{emitter:"TagCloudWidget"});break;default:e.ajaxErrorMessage="API Error: fatal error";break}else e.ajaxErrorMessage=`Uncaught exception: ${r}`,console.error(r)}).finally(()=>{e.ajaxRunning=!1}))};return B(()=>{m(),b.on("reAuthSucess",r=>{r.to?.includes("TagCloudWidget")&&m()})}),D(()=>{b.off("reAuthSucess")}),(r,i)=>(o(),u(L,{title:"Tag cloud",icon:"tag","icon-tool-tip":"Click to refresh data","on-header-icon-click":m,loading:e.ajaxRunning,error:e.ajaxErrors,expanded:c.value,onExpand:i[0]||(i[0]=a=>c.value=!0),onCollapse:i[1]||(i[1]=a=>c.value=!1)},{"header-extra":s(()=>[t(M,{square:"",size:"sm",color:"grey-7","text-color":"white"},{default:s(()=>[E(_(q(d)("Total tags",{count:l.length})),1)]),_:1})]),content:s(()=>[e.ajaxRunning?(o(),p("div",ce,[(o(),p(j,null,w(32,a=>t(f,{square:"",width:"12em",height:"2em",class:"",key:a})),64))])):e.ajaxErrors?(o(),u(N,{key:1,text:e.ajaxErrorMessage||"Error loading data","api-error":e.ajaxAPIErrorDetails},null,8,["text","api-error"])):h.value?(o(),p("div",me,[(o(!0),p(j,null,w(l,a=>(o(),u(O,{key:a.tag,tag:a.tag,caption:String(a.total),"q-chip-class":"q-chip-10em"},null,8,["tag","caption"]))),128))])):(o(),u(V,{key:3,warning:"",text:"You haven't created any tags yet"}))]),_:1},8,["loading","error","expanded"]))}}),ge={class:"row q-col-gutter-sm"},he={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-6"},xe={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-6"},Ie=Q({__name:"IndexPage",setup(n){const d=H(),g=S(!d.screen.lt.md);return(c,e)=>(o(),u(F,null,{default:s(()=>[k("div",ge,[k("div",he,[t(de,{expanded:g.value},null,8,["expanded"])]),k("div",xe,[t(pe,{expanded:g.value},null,8,["expanded"])])])]),_:1}))}});export{Ie as default};
