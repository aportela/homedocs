import{a as p}from"./index-CG2WSiiR.js";import{am as m}from"./index-B4QQtCX7.js";import{u as h}from"./session-BvJG7K2f.js";const c=h(),e=p.create({baseURL:m});e.interceptors.request.use(t=>(c.accessToken&&(t.headers.Authorization=`Bearer ${c.accessToken}`,t.withCredentials=!0),t),t=>{throw t});e.interceptors.response.use(t=>t,t=>{throw t?(t.response||(t.response={status:0,statusText:"undefined"}),t.response?.status===401&&c.hasAccessToken&&c.removeAccessToken(),t.isAPIError=t.response.headers["content-type"]=="application/json"&&t.response.data.APIError===!0,t.customAPIErrorDetails={method:t.config?.method||"N/A",url:t.request?.responseURL||"N/A",httpCode:t.response?.status||"N/A",httpStatus:t.response?.statusText||"Unknown error",contentType:t.response.headers["content-type"],request:{params:{query:t.config.params||null,data:t.config.data||null}},response:t.response.data||null},t):new Error("Unknown API error")});const f=async(t,s="fileName")=>{const a=Date.now(),n=await e.get(t,{responseType:"blob"}),o=new Blob([n.data]),r=document.createElement("a"),i=URL.createObjectURL(o);r.href=i,r.download=s,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(i);const u=Date.now();return{fileName:s,url:t,mimeType:o.type,length:o.size,msTime:u-a}},A={common:{getServerEnvironment:()=>e.get("/server_environment")},auth:{login:function(t,s){const a={email:t,password:s};return e.post("/auth/login",a)},renewAccessToken:function(){return e.post("/auth/renew_access_token")},logout:()=>e.post("/auth/logout"),register:function(t,s,a){const n={id:t,email:s,password:a};return e.post("/auth/register",n)}},user:{getProfile:()=>e.get("/user/profile"),setProfile:function(t,s){const a={email:t,password:s};return e.put("/user/profile",a)}},document:{searchRecent:function(t){const s={count:t};return e.post("/search/recent_documents",s)},search:function(t,s,a,n){const o={pager:t,filter:s,sort:a,returnFragments:n};return e.post("/search/document",o)},add:function(t){const s={id:t.id,title:t.title,description:t.description||null,tags:t.tags||[],attachments:t.attachments||[],notes:t.notes||[]};return e.post("/document/"+t.id,s)},update:function(t){const s={id:t.id,title:t.title,description:t.description||null,tags:t.tags||[],attachments:t.attachments||[],notes:t.notes||[]};return e.put("/document/"+t.id,s)},remove:t=>e.delete("/document/"+t),get:t=>e.get("/document/"+t),getNotes:t=>e.get("/document/"+t+"/notes"),getAttachments:t=>e.get("/document/"+t+"/attachments"),removeFile:t=>e.delete("/attachment/"+t)},tag:{getCloud:()=>e.get("/tag-cloud"),search:()=>e.get("/tags")},stats:{documentCount:()=>e.get("/stats/total-published-documents"),attachmentCount:()=>e.get("/stats/total-uploaded-attachments"),attachmentDiskSize:()=>e.get("/stats/total-uploaded-attachments-disk-usage"),getActivityHeatMapData:t=>e.get("/stats/heatmap-activity-data",{params:{fromTimestamp:t||null}})},attachmentShare:{create:t=>e.post(`/attachment/${t}/share`),update:(t,s,a,n)=>{const o={enabled:s,expiresAtTimestamp:a,accessLimit:n};return e.put(`/attachment/${t}/share`,o)},remove:t=>e.delete(`/attachment/${t}/share`),get:t=>e.get(`/attachment/${t}/share`),search:function(t,s){const a={pager:t,sort:s};return e.post("/search/attachment_share",a)}}};export{A as a,f as b};
