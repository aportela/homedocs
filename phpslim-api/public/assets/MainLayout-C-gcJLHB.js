import{a as bt,Q as re}from"./QBtn-DctWh9_T.js";import{Q as Lt}from"./ClosePopup-CNyqlWth.js";import{x as qe,j as k,y as B,z as tt,A as ve,l as E,B as j,C as wt,D as me,E as _t,F as Nt,H as Ue,I as ye,J as Qe,K as Ut,L as Te,M as Ge,N as it,O as Oe,P as Qt,Q as Ot,R as fe,v as Ve,S as de,a as Z,b as ie,e as F,w as d,h as c,n as I,f as D,q as T,T as Fe,U as ze,t as y,g as p,i as yt,V as xt,o as x,W as Ht,X as Wt,Y as Yt,Z as rt,k as G,_ as Xt,$ as Kt,a0 as Gt,a1 as St,a2 as Se,p as N,s as se,a3 as Ae,a4 as Jt,a5 as Zt,r as Ie,a6 as ea,a7 as ut,G as ta}from"./index-Ct92d8Em.js";import{h as at,a as aa,Q as la,b as dt,s as oa,g as na,c as sa,_ as De}from"./_plugin-vue_export-helper-oRIn74M6.js";import{Q as ia}from"./QPageContainer-BZvIEkre.js";import{Q as ra}from"./QLayout-B-oDrUdd.js";import{c as ua,u as da,b as ca,d as ma,e as fa,f as Je,g as va,h as he,i as X,Q as ne,R as ct,a as ha,v as He,_ as Ze,j as ga}from"./QItem-D3SSeFk8.js";import{u as je}from"./session-XhBIPT0q.js";import{Q as lt,a as ue,D as ke,f as mt,c as We}from"./date-time-ByGSvQ9F.js";import{b as $e,Q as K,a as z,o as pa,c as ba,f as et}from"./QItemLabel-BTaOLrdI.js";import{g as ft,s as vt,a as ce,d as ge,c as Me,_ as pe}from"./CustomErrorBanner.vue_vue_type_script_setup_true_lang-BwzH5vCg.js";import{u as wa,a as _a,b as ya,c as xa,Q as kt,d as ht}from"./QMarkupTable-BsEaLHgn.js";import{a as Ce,b as qt}from"./api-ByO76S85.js";import{_ as be,Q as ot,i as Sa,g as Ye,a as ka,b as qa,c as Dt,d as Ee,A as Da,N as Ca,D as Pa}from"./document-CIfyGa1Z.js";import{Q as Ta}from"./QInput-DCOUNvfM.js";import{S as $a,a as Va,b as Aa,Q as Ea}from"./QPagination-cFA0g3jN.js";import{_ as gt}from"./ViewDocumentDetailsButton.vue_vue_type_script_setup_true_lang-Cr8Ybagl.js";import{_ as Fa,a as za,b as Ia}from"./GitHubButton.vue_vue_type_script_setup_true_lang-D7axCefZ.js";import{_ as ja}from"./LoginForm.vue_vue_type_script_setup_true_lang-B0O2pdz0.js";import{u as Ma}from"./browserSupport-He0zzorG.js";import{Q as Ra}from"./QToggle-BLq7iIfH.js";import{u as Ba}from"./serverEnvironment-T24gP8gM.js";import"./index-CG2WSiiR.js";import"./darkMode-DTGZ6KEA.js";import"./useFormUtils-B_DmTkpa.js";import"./PasswordFieldCustomInput.vue_vue_type_script_setup_true_lang-CgCAhJU6.js";const La=qe({name:"QToolbar",props:{inset:Boolean},setup(e,{slots:h}){const o=k(()=>"q-toolbar row no-wrap items-center"+(e.inset===!0?" q-toolbar--inset":""));return()=>B("div",{class:o.value,role:"toolbar"},at(h.default))}}),Na=qe({name:"QHeader",props:{modelValue:{type:Boolean,default:!0},reveal:Boolean,revealOffset:{type:Number,default:250},bordered:Boolean,elevated:Boolean,heightHint:{type:[String,Number],default:50}},emits:["reveal","focusin"],setup(e,{slots:h,emit:o}){const{proxy:{$q:n}}=tt(),t=wt(_t,ve);if(t===ve)return console.error("QHeader needs to be child of QLayout"),ve;const l=E(parseInt(e.heightHint,10)),s=E(!0),g=k(()=>e.reveal===!0||t.view.value.indexOf("H")!==-1||n.platform.is.ios&&t.isContainer.value===!0),S=k(()=>{if(e.modelValue!==!0)return 0;if(g.value===!0)return s.value===!0?l.value:0;const u=l.value-t.scroll.value.position;return u>0?u:0}),_=k(()=>e.modelValue!==!0||g.value===!0&&s.value!==!0),a=k(()=>e.modelValue===!0&&_.value===!0&&e.reveal===!0),P=k(()=>"q-header q-layout__section--marginal "+(g.value===!0?"fixed":"absolute")+"-top"+(e.bordered===!0?" q-header--bordered":"")+(_.value===!0?" q-header--hidden":"")+(e.modelValue!==!0?" q-layout--prevent-focus":"")),w=k(()=>{const u=t.rows.value.top,$={};return u[0]==="l"&&t.left.space===!0&&($[n.lang.rtl===!0?"right":"left"]=`${t.left.size}px`),u[2]==="r"&&t.right.space===!0&&($[n.lang.rtl===!0?"left":"right"]=`${t.right.size}px`),$});function b(u,$){t.update("header",u,$)}function v(u,$){u.value!==$&&(u.value=$)}function i({height:u}){v(l,u),b("size",u)}function m(u){a.value===!0&&v(s,!0),o("focusin",u)}j(()=>e.modelValue,u=>{b("space",u),v(s,!0),t.animate()}),j(S,u=>{b("offset",u)}),j(()=>e.reveal,u=>{u===!1&&v(s,e.modelValue)}),j(s,u=>{t.animate(),o("reveal",u)}),j(t.scroll,u=>{e.reveal===!0&&v(s,u.direction==="up"||u.position<=e.revealOffset||u.position-u.inflectionPoint<100)});const r={};return t.instances.header=r,e.modelValue===!0&&b("size",l.value),b("space",e.modelValue),b("offset",S.value),me(()=>{t.instances.header===r&&(t.instances.header=void 0,b("size",0),b("offset",0),b("space",!1))}),()=>{const u=aa(h.default,[]);return e.elevated===!0&&u.push(B("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),u.push(B(la,{debounce:0,onResize:i})),B("header",{class:P.value,style:w.value,onFocusin:m},u)}}});function Xe(e,h,o){const n=Ge(e);let t,l=n.left-h.event.x,s=n.top-h.event.y,g=Math.abs(l),S=Math.abs(s);const _=h.direction;_.horizontal===!0&&_.vertical!==!0?t=l<0?"left":"right":_.horizontal!==!0&&_.vertical===!0?t=s<0?"up":"down":_.up===!0&&s<0?(t="up",g>S&&(_.left===!0&&l<0?t="left":_.right===!0&&l>0&&(t="right"))):_.down===!0&&s>0?(t="down",g>S&&(_.left===!0&&l<0?t="left":_.right===!0&&l>0&&(t="right"))):_.left===!0&&l<0?(t="left",g<S&&(_.up===!0&&s<0?t="up":_.down===!0&&s>0&&(t="down"))):_.right===!0&&l>0&&(t="right",g<S&&(_.up===!0&&s<0?t="up":_.down===!0&&s>0&&(t="down")));let a=!1;if(t===void 0&&o===!1){if(h.event.isFirst===!0||h.event.lastDir===void 0)return{};t=h.event.lastDir,a=!0,t==="left"||t==="right"?(n.left-=l,g=0,l=0):(n.top-=s,S=0,s=0)}return{synthetic:a,payload:{evt:e,touch:h.event.mouse!==!0,mouse:h.event.mouse===!0,position:n,direction:t,isFirst:h.event.isFirst,isFinal:o===!0,duration:Date.now()-h.event.time,distance:{x:g,y:S},offset:{x:l,y:s},delta:{x:n.left-h.event.lastX,y:n.top-h.event.lastY}}}}let Ua=0;const Ke=Nt({name:"touch-pan",beforeMount(e,{value:h,modifiers:o}){if(o.mouse!==!0&&ye.has.touch!==!0)return;function n(l,s){o.mouse===!0&&s===!0?Ot(l):(o.stop===!0&&Oe(l),o.prevent===!0&&it(l))}const t={uid:"qvtp_"+Ua++,handler:h,modifiers:o,direction:ft(o),noop:Ut,mouseStart(l){vt(l,t)&&Qt(l)&&(Te(t,"temp",[[document,"mousemove","move","notPassiveCapture"],[document,"mouseup","end","passiveCapture"]]),t.start(l,!0))},touchStart(l){if(vt(l,t)){const s=l.target;Te(t,"temp",[[s,"touchmove","move","notPassiveCapture"],[s,"touchcancel","end","passiveCapture"],[s,"touchend","end","passiveCapture"]]),t.start(l)}},start(l,s){if(ye.is.firefox===!0&&Qe(e,!0),t.lastEvt=l,s===!0||o.stop===!0){if(t.direction.all!==!0&&(s!==!0||t.modifiers.mouseAllDir!==!0&&t.modifiers.mousealldir!==!0)){const _=l.type.indexOf("mouse")!==-1?new MouseEvent(l.type,l):new TouchEvent(l.type,l);l.defaultPrevented===!0&&it(_),l.cancelBubble===!0&&Oe(_),Object.assign(_,{qKeyEvent:l.qKeyEvent,qClickOutside:l.qClickOutside,qAnchorHandled:l.qAnchorHandled,qClonedBy:l.qClonedBy===void 0?[t.uid]:l.qClonedBy.concat(t.uid)}),t.initialEvent={target:l.target,event:_}}Oe(l)}const{left:g,top:S}=Ge(l);t.event={x:g,y:S,time:Date.now(),mouse:s===!0,detected:!1,isFirst:!0,isFinal:!1,lastX:g,lastY:S}},move(l){if(t.event===void 0)return;const s=Ge(l),g=s.left-t.event.x,S=s.top-t.event.y;if(g===0&&S===0)return;t.lastEvt=l;const _=t.event.mouse===!0,a=()=>{n(l,_);let b;o.preserveCursor!==!0&&o.preservecursor!==!0&&(b=document.documentElement.style.cursor||"",document.documentElement.style.cursor="grabbing"),_===!0&&document.body.classList.add("no-pointer-events--children"),document.body.classList.add("non-selectable"),ua(),t.styleCleanup=v=>{if(t.styleCleanup=void 0,b!==void 0&&(document.documentElement.style.cursor=b),document.body.classList.remove("non-selectable"),_===!0){const i=()=>{document.body.classList.remove("no-pointer-events--children")};v!==void 0?setTimeout(()=>{i(),v()},50):i()}else v!==void 0&&v()}};if(t.event.detected===!0){t.event.isFirst!==!0&&n(l,t.event.mouse);const{payload:b,synthetic:v}=Xe(l,t,!1);b!==void 0&&(t.handler(b)===!1?t.end(l):(t.styleCleanup===void 0&&t.event.isFirst===!0&&a(),t.event.lastX=b.position.left,t.event.lastY=b.position.top,t.event.lastDir=v===!0?void 0:b.direction,t.event.isFirst=!1));return}if(t.direction.all===!0||_===!0&&(t.modifiers.mouseAllDir===!0||t.modifiers.mousealldir===!0)){a(),t.event.detected=!0,t.move(l);return}const P=Math.abs(g),w=Math.abs(S);P!==w&&(t.direction.horizontal===!0&&P>w||t.direction.vertical===!0&&P<w||t.direction.up===!0&&P<w&&S<0||t.direction.down===!0&&P<w&&S>0||t.direction.left===!0&&P>w&&g<0||t.direction.right===!0&&P>w&&g>0?(t.event.detected=!0,t.move(l)):t.end(l,!0))},end(l,s){if(t.event!==void 0){if(Ue(t,"temp"),ye.is.firefox===!0&&Qe(e,!1),s===!0)t.styleCleanup?.(),t.event.detected!==!0&&t.initialEvent!==void 0&&t.initialEvent.target.dispatchEvent(t.initialEvent.event);else if(t.event.detected===!0){t.event.isFirst===!0&&t.handler(Xe(l===void 0?t.lastEvt:l,t).payload);const{payload:g}=Xe(l===void 0?t.lastEvt:l,t,!0),S=()=>{t.handler(g)};t.styleCleanup!==void 0?t.styleCleanup(S):S()}t.event=void 0,t.initialEvent=void 0,t.lastEvt=void 0}}};if(e.__qtouchpan=t,o.mouse===!0){const l=o.mouseCapture===!0||o.mousecapture===!0?"Capture":"";Te(t,"main",[[e,"mousedown","mouseStart",`passive${l}`]])}ye.has.touch===!0&&Te(t,"main",[[e,"touchstart","touchStart",`passive${o.capture===!0?"Capture":""}`],[e,"touchmove","noop","notPassiveCapture"]])},updated(e,h){const o=e.__qtouchpan;o!==void 0&&(h.oldValue!==h.value&&(typeof value!="function"&&o.end(),o.handler=h.value),o.direction=ft(h.modifiers))},beforeUnmount(e){const h=e.__qtouchpan;h!==void 0&&(h.event!==void 0&&h.end(),Ue(h,"main"),Ue(h,"temp"),ye.is.firefox===!0&&Qe(e,!1),h.styleCleanup?.(),delete e.__qtouchpan)}}),pt=150,Qa=qe({name:"QDrawer",inheritAttrs:!1,props:{...ma,...ca,side:{type:String,default:"left",validator:e=>["left","right"].includes(e)},width:{type:Number,default:300},mini:Boolean,miniToOverlay:Boolean,miniWidth:{type:Number,default:57},noMiniAnimation:Boolean,breakpoint:{type:Number,default:1023},showIfAbove:Boolean,behavior:{type:String,validator:e=>["default","desktop","mobile"].includes(e),default:"default"},bordered:Boolean,elevated:Boolean,overlay:Boolean,persistent:Boolean,noSwipeOpen:Boolean,noSwipeClose:Boolean,noSwipeBackdrop:Boolean},emits:[...da,"onLayout","miniState"],setup(e,{slots:h,emit:o,attrs:n}){const t=tt(),{proxy:{$q:l}}=t,s=fa(e,l),{preventBodyScroll:g}=_a(),{registerTimeout:S,removeTimeout:_}=Je(),a=wt(_t,ve);if(a===ve)return console.error("QDrawer needs to be child of QLayout"),ve;let P,w=null,b;const v=E(e.behavior==="mobile"||e.behavior!=="desktop"&&a.totalWidth.value<=e.breakpoint),i=k(()=>e.mini===!0&&v.value!==!0),m=k(()=>i.value===!0?e.miniWidth:e.width),r=E(e.showIfAbove===!0&&v.value===!1?!0:e.modelValue===!0),u=k(()=>e.persistent!==!0&&(v.value===!0||Ct.value===!0));function $(f,A){if(ee(),f!==!1&&a.animate(),W(0),v.value===!0){const O=a.instances[q.value];O?.belowBreakpoint===!0&&O.hide(!1),le(1),a.isContainer.value!==!0&&g(!0)}else le(0),f!==!1&&Be(!1);S(()=>{f!==!1&&Be(!0),A!==!0&&o("show",f)},pt)}function M(f,A){te(),f!==!1&&a.animate(),le(0),W(Y.value*m.value),Le(),A!==!0?S(()=>{o("hide",f)},pt):_()}const{show:J,hide:H}=va({showing:r,hideOnRouteChange:u,handleShow:$,handleHide:M}),{addToHistory:ee,removeFromHistory:te}=wa(r,H,u),ae={belowBreakpoint:v,hide:H},U=k(()=>e.side==="right"),Y=k(()=>(l.lang.rtl===!0?-1:1)*(U.value===!0?1:-1)),V=E(0),L=E(!1),C=E(!1),R=E(m.value*Y.value),q=k(()=>U.value===!0?"left":"right"),Q=k(()=>r.value===!0&&v.value===!1&&e.overlay===!1?e.miniToOverlay===!0?e.miniWidth:m.value:0),we=k(()=>e.overlay===!0||e.miniToOverlay===!0||a.view.value.indexOf(U.value?"R":"L")!==-1||l.platform.is.ios===!0&&a.isContainer.value===!0),_e=k(()=>e.overlay===!1&&r.value===!0&&v.value===!1),Ct=k(()=>e.overlay===!0&&r.value===!0&&v.value===!1),Pt=k(()=>"fullscreen q-drawer__backdrop"+(r.value===!1&&L.value===!1?" hidden":"")),Tt=k(()=>({backgroundColor:`rgba(0,0,0,${V.value*.4})`})),nt=k(()=>U.value===!0?a.rows.value.top[2]==="r":a.rows.value.top[0]==="l"),$t=k(()=>U.value===!0?a.rows.value.bottom[2]==="r":a.rows.value.bottom[0]==="l"),Vt=k(()=>{const f={};return a.header.space===!0&&nt.value===!1&&(we.value===!0?f.top=`${a.header.offset}px`:a.header.space===!0&&(f.top=`${a.header.size}px`)),a.footer.space===!0&&$t.value===!1&&(we.value===!0?f.bottom=`${a.footer.offset}px`:a.footer.space===!0&&(f.bottom=`${a.footer.size}px`)),f}),At=k(()=>{const f={width:`${m.value}px`,transform:`translateX(${R.value}px)`};return v.value===!0?f:Object.assign(f,Vt.value)}),Et=k(()=>"q-drawer__content fit "+(a.isContainer.value!==!0?"scroll":"overflow-auto")),Ft=k(()=>`q-drawer q-drawer--${e.side}`+(C.value===!0?" q-drawer--mini-animate":"")+(e.bordered===!0?" q-drawer--bordered":"")+(s.value===!0?" q-drawer--dark q-dark":"")+(L.value===!0?" no-transition":r.value===!0?"":" q-layout--prevent-focus")+(v.value===!0?" fixed q-drawer--on-top q-drawer--mobile q-drawer--top-padding":` q-drawer--${i.value===!0?"mini":"standard"}`+(we.value===!0||_e.value!==!0?" fixed":"")+(e.overlay===!0||e.miniToOverlay===!0?" q-drawer--on-top":"")+(nt.value===!0?" q-drawer--top-padding":""))),zt=k(()=>{const f=l.lang.rtl===!0?e.side:q.value;return[[Ke,Rt,void 0,{[f]:!0,mouse:!0}]]}),It=k(()=>{const f=l.lang.rtl===!0?q.value:e.side;return[[Ke,st,void 0,{[f]:!0,mouse:!0}]]}),jt=k(()=>{const f=l.lang.rtl===!0?q.value:e.side;return[[Ke,st,void 0,{[f]:!0,mouse:!0,mouseAllDir:!0}]]});function Re(){Bt(v,e.behavior==="mobile"||e.behavior!=="desktop"&&a.totalWidth.value<=e.breakpoint)}j(v,f=>{f===!0?(P=r.value,r.value===!0&&H(!1)):e.overlay===!1&&e.behavior!=="mobile"&&P!==!1&&(r.value===!0?(W(0),le(0),Le()):J(!1))}),j(()=>e.side,(f,A)=>{a.instances[A]===ae&&(a.instances[A]=void 0,a[A].space=!1,a[A].offset=0),a.instances[f]=ae,a[f].size=m.value,a[f].space=_e.value,a[f].offset=Q.value}),j(a.totalWidth,()=>{(a.isContainer.value===!0||document.qScrollPrevented!==!0)&&Re()}),j(()=>e.behavior+e.breakpoint,Re),j(a.isContainer,f=>{r.value===!0&&g(f!==!0),f===!0&&Re()}),j(a.scrollbarWidth,()=>{W(r.value===!0?0:void 0)}),j(Q,f=>{oe("offset",f)}),j(_e,f=>{o("onLayout",f),oe("space",f)}),j(U,()=>{W()}),j(m,f=>{W(),Ne(e.miniToOverlay,f)}),j(()=>e.miniToOverlay,f=>{Ne(f,m.value)}),j(()=>l.lang.rtl,()=>{W()}),j(()=>e.mini,()=>{e.noMiniAnimation||e.modelValue===!0&&(Mt(),a.animate())}),j(i,f=>{o("miniState",f)});function W(f){f===void 0?Ve(()=>{f=r.value===!0?0:m.value,W(Y.value*f)}):(a.isContainer.value===!0&&U.value===!0&&(v.value===!0||Math.abs(f)===m.value)&&(f+=Y.value*a.scrollbarWidth.value),R.value=f)}function le(f){V.value=f}function Be(f){const A=f===!0?"remove":a.isContainer.value!==!0?"add":"";A!==""&&document.body.classList[A]("q-body--drawer-toggle")}function Mt(){w!==null&&clearTimeout(w),t.proxy&&t.proxy.$el&&t.proxy.$el.classList.add("q-drawer--mini-animate"),C.value=!0,w=setTimeout(()=>{w=null,C.value=!1,t?.proxy?.$el?.classList.remove("q-drawer--mini-animate")},150)}function Rt(f){if(r.value!==!1)return;const A=m.value,O=$e(f.distance.x,0,A);if(f.isFinal===!0){O>=Math.min(75,A)===!0?J():(a.animate(),le(0),W(Y.value*A)),L.value=!1;return}W((l.lang.rtl===!0?U.value!==!0:U.value)?Math.max(A-O,0):Math.min(0,O-A)),le($e(O/A,0,1)),f.isFirst===!0&&(L.value=!0)}function st(f){if(r.value!==!0)return;const A=m.value,O=f.direction===e.side,Pe=(l.lang.rtl===!0?O!==!0:O)?$e(f.distance.x,0,A):0;if(f.isFinal===!0){Math.abs(Pe)<Math.min(75,A)===!0?(a.animate(),le(1),W(0)):H(),L.value=!1;return}W(Y.value*Pe),le($e(1-Pe/A,0,1)),f.isFirst===!0&&(L.value=!0)}function Le(){g(!1),Be(!0)}function oe(f,A){a.update(e.side,f,A)}function Bt(f,A){f.value!==A&&(f.value=A)}function Ne(f,A){oe("size",f===!0?e.miniWidth:A)}return a.instances[e.side]=ae,Ne(e.miniToOverlay,m.value),oe("space",_e.value),oe("offset",Q.value),e.showIfAbove===!0&&e.modelValue!==!0&&r.value===!0&&e["onUpdate:modelValue"]!==void 0&&o("update:modelValue",!0),fe(()=>{o("onLayout",_e.value),o("miniState",i.value),P=e.showIfAbove===!0;const f=()=>{(r.value===!0?$:M)(!1,!0)};if(a.totalWidth.value!==0){Ve(f);return}b=j(a.totalWidth,()=>{b(),b=void 0,r.value===!1&&e.showIfAbove===!0&&v.value===!1?J(!1):f()})}),me(()=>{b?.(),w!==null&&(clearTimeout(w),w=null),r.value===!0&&Le(),a.instances[e.side]===ae&&(a.instances[e.side]=void 0,oe("size",0),oe("offset",0),oe("space",!1))}),()=>{const f=[];v.value===!0&&(e.noSwipeOpen===!1&&f.push(de(B("div",{key:"open",class:`q-drawer__opener fixed-${e.side}`,"aria-hidden":"true"}),zt.value)),f.push(dt("div",{ref:"backdrop",class:Pt.value,style:Tt.value,"aria-hidden":"true",onClick:H},void 0,"backdrop",e.noSwipeBackdrop!==!0&&r.value===!0,()=>jt.value)));const A=i.value===!0&&h.mini!==void 0,O=[B("div",{...n,key:""+A,class:[Et.value,n.class]},A===!0?h.mini():at(h.default))];return e.elevated===!0&&r.value===!0&&O.push(B("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),f.push(dt("aside",{ref:"content",class:Ft.value,style:At.value},O,"contentclose",e.noSwipeClose!==!0&&v.value===!0,()=>It.value)),B("div",{class:"q-drawer-container"},f)}}}),Oa=Z({__name:"SidebarDrawer",props:{modelValue:{type:Boolean},mini:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:h}){const o=e,n=h,t=k({get(){return o.modelValue},set(b){n("update:modelValue",b)}}),{t:l}=ie(),s=yt(),g=xt(),S=k(()=>String(g.name)),_=je(),a=k(()=>o.mini),P=[{icon:"home",text:"Home",routeName:"index"},{icon:"account_circle",text:"My profile",routeName:"profile"},{icon:"note_add",text:"Add",routeName:"newDocument"},{icon:"find_in_page",text:"Advanced search",routeName:"advancedSearch",alternateRouteNames:["advancedSearchByTag","advancedSearchByFixedCreationDate","advancedSearchByFixedLastUpdate","advancedSearchByFixedUpdatedOn"]}],w=()=>{Ce.auth.logout().then(()=>{_.removeAccessToken(),s.push({name:"login"}).catch(b=>{console.error(b)})}).catch(b=>{console.error(b),_.removeAccessToken(),s.push({name:"login"}).catch(v=>{console.error(v)})})};return(b,v)=>(x(),F(Qa,{modelValue:t.value,"onUpdate:modelValue":v[0]||(v[0]=i=>t.value=i),"show-if-above":"",bordered:"",width:240,mini:a.value,class:"fit theme-default-q-drawer"},{default:d(()=>[c(lt,null,{default:d(()=>[c(he,{class:"cursor-pointer non-selectable no-pointer-events rounded-borders q-ma-sm theme-default-q-item"},{default:d(()=>[c(X,{avatar:""},{default:d(()=>[c(ce,{square:"",size:"24px"},{default:d(()=>[...v[1]||(v[1]=[D("img",{src:"icons/favicon-128x128.png"},null,-1)])]),_:1})]),_:1}),c(X,null,{default:d(()=>[c(K,{class:"text-weight-bold text-uppercase"},{default:d(()=>[...v[2]||(v[2]=[T("HomeDocs",-1)])]),_:1})]),_:1})]),_:1}),(x(),I(ze,null,Fe(P,i=>de(c(he,{key:i.text,clickable:"",to:{name:i.routeName},class:"rounded-borders q-ma-sm theme-default-q-item",active:i.routeName==S.value||i.alternateRouteNames?.includes(S.value),"active-class":"theme-default-q-item-active"},{default:d(()=>[c(X,{avatar:""},{default:d(()=>[c(ne,{name:i.icon},null,8,["name"])]),_:2},1024),c(X,null,{default:d(()=>[c(K,null,{default:d(()=>[T(y(p(l)(i.text)),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["to","active"]),[[ct]])),64)),de((x(),F(he,{clickable:"",onClick:w,class:"rounded-borders q-ma-sm theme-default-q-item"},{default:d(()=>[c(X,{avatar:""},{default:d(()=>[c(ne,{name:"logout"})]),_:1}),c(X,null,{default:d(()=>[c(K,null,{default:d(()=>[T(y(p(l)("Sign out")),1)]),_:1})]),_:1})]),_:1})),[[ct]])]),_:1})]),_:1},8,["modelValue","mini"]))}});function Ha(e,h){return B("div",e,[B("table",{class:"q-table"},h)])}const Wa={list:lt,table:kt},Ya=["list","table","__qtable"],Xa=qe({name:"QVirtualScroll",props:{...ya,type:{type:String,default:"list",validator:e=>Ya.includes(e)},items:{type:Array,default:()=>[]},itemsFn:Function,itemsSize:Number,scrollTarget:oa},setup(e,{slots:h,attrs:o}){let n;const t=E(null),l=k(()=>e.itemsSize>=0&&e.itemsFn!==void 0?parseInt(e.itemsSize,10):Array.isArray(e.items)?e.items.length:0),{virtualScrollSliceRange:s,localResetVirtualScroll:g,padVirtualScroll:S,onVirtualScrollEvt:_}=xa({virtualScrollLength:l,getVirtualScrollTarget:v,getVirtualScrollEl:b}),a=k(()=>{if(l.value===0)return[];const u=($,M)=>({index:s.value.from+M,item:$});return e.itemsFn===void 0?e.items.slice(s.value.from,s.value.to).map(u):e.itemsFn(s.value.from,s.value.to-s.value.from).map(u)}),P=k(()=>"q-virtual-scroll q-virtual-scroll"+(e.virtualScrollHorizontal===!0?"--horizontal":"--vertical")+(e.scrollTarget!==void 0?"":" scroll")),w=k(()=>e.scrollTarget!==void 0?{}:{tabindex:0});j(l,()=>{g()}),j(()=>e.scrollTarget,()=>{m(),i()});function b(){return t.value.$el||t.value}function v(){return n}function i(){n=na(b(),e.scrollTarget),n.addEventListener("scroll",_,rt.passive)}function m(){n!==void 0&&(n.removeEventListener("scroll",_,rt.passive),n=void 0)}function r(){let u=S(e.type==="list"?"div":"tbody",a.value.map(h.default));return h.before!==void 0&&(u=h.before().concat(u)),sa(h.after,u)}return Ht(()=>{g()}),fe(()=>{i()}),Wt(()=>{i()}),Yt(()=>{m()}),me(()=>{m()}),()=>{if(h.default===void 0){console.error("QVirtualScroll: default scoped slot is required for rendering");return}return e.type==="__qtable"?Ha({ref:t,class:"q-table__middle "+P.value},r()):B(Wa[e.type],{...o,ref:t,class:[o.class,P.value],...w.value},r)}}}),Ka={class:"q-pa-sm row items-center q-gutter-sm"},Ga={class:"col-auto"},Ja={style:{"flex-grow":"1"}},Za={key:0},el=["innerHTML"],tl={class:"text-color-primary"},al=Z({__name:"SearchDialog",props:{modelValue:{type:Boolean}},emits:["update:modelValue","close"],setup(e,{emit:h}){const o=e,n=yt(),t=xt(),l=je(),s=E(t.name=="document"&&t.params?.id||null),{t:g}=ie(),S=h,_=k({get(){return o.modelValue},set(C){S("update:modelValue",C)}}),a=G({...ge}),P=k(()=>[{label:"Title",value:"title"},{label:"Description",value:"description"},{label:"Notes",value:"notesBody"},{label:"Attachment names",value:"attachmentsFilename"}]),w={field:"lastUpdateTimestamp",label:"",order:"DESC"},b=E(P.value[0]);j(()=>b.value,()=>{Ve().then(()=>{ee.value?.focus()}).catch(C=>{console.error(C)})});const v=E(null),i=G({currentPageIndex:1,resultsPage:l.searchDialogResultsPage,totalResults:0,totalPages:0}),m=[1,2,3,4,6,8,12,16,24,32,64,128],r=C=>{l.setSearchDialogResultsPage(C),te(u.value)},u=E(""),$=Xt([]),M=E(-1),J=E(0),H=E(!1),ee=E(null),te=C=>{if(i.totalResults=0,i.totalPages=0,H.value=!1,C&&C.trim().length>0){M.value=-1,Object.assign(a,ge),a.ajaxRunning=!0;const R={text:new $a(b.value.value=="title"?C.trim():null,b.value.value=="description"?C.trim():null,b.value.value=="notesBody"?C.trim():null,b.value.value=="attachmentsFilename"?C.trim():null),tags:[],dates:new Va};Ce.document.search(i,R,w,!0).then(q=>{i.totalResults=q.data.results.pagination.totalResults,i.totalPages=q.data.results.pagination.totalPages,$.value=q.data.results.documents.map(Q=>new Aa(g,Q.id,new ke(g,Q.createdAtTimestamp),new ke(g,Q.updatedAtTimestamp),Q.title,Q.description,Q.tags,Q.attachmentCount,Q.noteCount,Q.matchedFragments,C.trim())),H.value=$.value.length<=0}).catch(q=>{if(a.ajaxErrors=!0,q.isAPIError)switch(a.ajaxAPIErrorDetails=q.customAPIErrorDetails,q.response.status){case 401:a.ajaxErrors=!1,z.emit("reAuthRequired",{emitter:"SearchDialog.onSearch"});break;default:a.ajaxErrorMessage="API Error: fatal error";break}else a.ajaxErrorMessage=`Uncaught exception: ${q}`,console.error(q)}).finally(()=>{a.ajaxRunning=!1})}else $.value=[]},ae=C=>{J.value=C.index},U=C=>{v.value&&v.value.scrollTo(C,"start-force")},Y=C=>{C.key==="ArrowUp"?$.value.length>0&&M.value>0&&(M.value--,U(M.value),C.preventDefault(),C.stopPropagation()):C.key==="ArrowDown"?$.value.length>0&&M.value<$.value.length-1&&(M.value++,U(M.value),C.preventDefault(),C.stopPropagation()):C.key==="Enter"&&$.value.length>0&&M.value>=0&&M.value<$.value.length&&n.push({name:"document",params:{id:$.value[M.value].id}}).catch(R=>{console.error(R)})},V=()=>{i.resultsPage=l.searchDialogResultsPage,i.totalResults=0,i.totalPages=0,window.addEventListener("keydown",Y),Ve().then(()=>{ee.value?.focus()}).catch(C=>{console.error(C)})},L=()=>{$.value=[],u.value="",H.value=!1,window.removeEventListener("keydown",Y),S("close")};return fe(()=>{z.on("reAuthSucess",C=>{C.to?.includes("SearchDialog.onSearch")&&te(u.value)})}),me(()=>{z.off("reAuthSucess")}),(C,R)=>(x(),F(be,{modelValue:_.value,"onUpdate:modelValue":R[5]||(R[5]=q=>_.value=q),onShow:V,onClose:L,width:"1280px","max-width":"80vw"},{"header-left":d(()=>[T(y(p(g)("Search on HomeDocs...")),1)]),"header-right":d(()=>[!a.ajaxRunning&&!a.ajaxErrors?de((x(),F(ue,{key:0,size:"md",square:"",class:"gt-sm theme-default-q-chip shadow-1"},{default:d(()=>[c(ce,{class:"theme-default-q-avatar theme-default-q-avatar-width-auto"},{default:d(()=>[T(y(i.totalResults),1)]),_:1}),T(" "+y(p(g)("Results count",{count:i.totalResults})),1)]),_:1},512)),[[Ae,i.totalResults>0]]):N("",!0)]),body:d(()=>[D("div",Ka,[D("div",Ga,[c(ht,{modelValue:b.value,"onUpdate:modelValue":[R[0]||(R[0]=q=>b.value=q),R[1]||(R[1]=q=>te(u.value))],options:P.value,"display-value":`${b.value?p(g)(b.value.label):""}`,dense:"","options-dense":"",outlined:"",style:{"min-width":"8em"},label:p(g)("Search on"),disable:a.ajaxRunning},{option:d(q=>[c(he,Kt(Gt(q.itemProps)),{default:d(()=>[c(X,null,{default:d(()=>[c(K,null,{default:d(()=>[T(y(p(g)(q.label)),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options","display-value","label","disable"])]),D("div",Ja,[c(p(Ta),{type:"text",dense:"",color:"grey-3","label-color":"grey-7",label:p(g)("Search text..."),modelValue:u.value,"onUpdate:modelValue":[R[2]||(R[2]=q=>u.value=q),R[3]||(R[3]=q=>te(u.value))],clearable:"",outlined:"",ref_key:"searchTextField",ref:ee},{prepend:d(()=>[c(ne,{name:"search"})]),_:1},8,["label","modelValue"])])]),c(ha),a.ajaxErrors?(x(),I("div",Za,[c(Me,{text:a.ajaxErrorMessage||"Error loading data","api-error":a.ajaxAPIErrorDetails},null,8,["text","api-error"])])):(x(),F(p(Xa),{key:1,component:"q-list",items:$.value,onVirtualScroll:ae,ref_key:"virtualListRef",ref:v,class:"q-virtual-scroll-container"},St({default:d(({item:q,index:Q})=>[D("div",{class:Se(["border-bottom-except-last-item",{"current-keyboard-selected-item":M.value===Q}])},[(x(),F(he,{key:q.id,class:Se(["transparent-background text-color-primary q-pa-sm",{"cursor-not-allowed is-current":q.id===s.value}]),clickable:q.id!==s.value,to:{name:"document",params:{id:q.id}}},{default:d(()=>[c(X,{side:"",class:"gt-sm"},{default:d(()=>[c(ne,{name:"work"})]),_:1}),c(X,null,{default:d(()=>[c(K,null,{default:d(()=>[T(y(q.title),1)]),_:2},1024),q.matchedOnFragment?(x(),F(K,{key:0,caption:""},{default:d(()=>[D("div",{innerHTML:q.matchedOnFragment},null,8,el)]),_:2},1024)):N("",!0)]),_:2},1024),c(X,{side:"",top:""},{default:d(()=>[c(K,{caption:""},{default:d(()=>[T(" ("+y(q.updatedAt.timeAgo||q.createdAt.timeAgo)+") ",1),D("span",tl,y(q.updatedAt.dateTime||q.createdAt.dateTime),1)]),_:2},1024),c(gt,{size:"md",square:"",class:"min-width-9em",count:q.attachmentCount,label:"Total attachments count","tool-tip":"View document attachments",disable:a.ajaxRunning,onClick:se(we=>p(pa)(q.id,q.label),["stop","prevent"])},null,8,["count","disable","onClick"]),c(gt,{size:"md",square:"",class:"min-width-9em",count:q.noteCount,label:"Total notes","tool-tip":"View document notes",disable:a.ajaxRunning,onClick:se(we=>p(ba)(q.id,q.label),["stop","prevent"])},null,8,["count","disable","onClick"])]),_:2},1024)]),_:2},1032,["class","clickable","to"]))],2)]),_:2},[H.value?{name:"before",fn:d(()=>[c(pe,{warning:"",class:"q-ma-md",text:"Unfortunately, your search didn't return any results. You might want to modify your filters or search terms"})]),key:"0"}:void 0]),1032,["items"]))]),"actions-prepend":d(()=>[c(ot),c(ht,{modelValue:i.resultsPage,"onUpdate:modelValue":[R[4]||(R[4]=q=>i.resultsPage=q),r],filled:"",options:m,label:p(g)("Max results"),"stack-label":"",dense:"","options-dense":"",class:"q-mr-md",style:{"min-width":"12em"}},null,8,["modelValue","label"])]),_:1},8,["modelValue"]))}}),ll=De(al,[["__scopeId","data-v-77e3f51e"]]),ol={class:"q-mt-sm q-mb-md text-h4 text-weight-bolder"},nl={class:"text-color-secondary"},sl=Z({__name:"ReAuthDialog",emits:["close","success"],setup(e,{emit:h}){const{t:o}=ie(),n=h,t=E(!0),l=()=>{n("close")},s=()=>{n("success")};return(g,S)=>(x(),F(be,{modelValue:t.value,"onUpdate:modelValue":S[0]||(S[0]=_=>t.value=_),onClose:l,width:"512px","max-width":"80vw","hide-footer":"",persistent:""},{"header-left":d(()=>[T(y(p(o)("Session lost... re-auth required")),1)]),body:d(()=>[c(ja,{"show-extra-bottom":!1,onSuccess:s},{slogan:d(()=>[D("h4",ol,y(p(o)("Oooops")),1),D("div",nl,y(p(o)("Please enter again your credentials")),1)]),_:1})]),_:1},8,["modelValue"]))}}),il={ratio:[String,Number]};function rl(e,h){return k(()=>{const o=Number(e.ratio||(h!==void 0?h.value:void 0));return isNaN(o)!==!0&&o>0?{paddingBottom:`${100/o}%`}:null})}const ul=1.7778,dl=qe({name:"QImg",props:{...il,src:String,srcset:String,sizes:String,alt:String,crossorigin:String,decoding:String,referrerpolicy:String,draggable:Boolean,loading:{type:String,default:"lazy"},loadingShowDelay:{type:[Number,String],default:0},fetchpriority:{type:String,default:"auto"},width:String,height:String,initialRatio:{type:[Number,String],default:ul},placeholderSrc:String,errorSrc:String,fit:{type:String,default:"cover"},position:{type:String,default:"50% 50%"},imgClass:String,imgStyle:Object,noSpinner:Boolean,noNativeMenu:Boolean,noTransition:Boolean,spinnerColor:String,spinnerSize:String},emits:["load","error"],setup(e,{slots:h,emit:o}){const n=E(e.initialRatio),t=rl(e,n),l=tt(),{registerTimeout:s,removeTimeout:g}=Je(),{registerTimeout:S,removeTimeout:_}=Je(),a=k(()=>e.placeholderSrc!==void 0?{src:e.placeholderSrc}:null),P=k(()=>e.errorSrc!==void 0?{src:e.errorSrc,__qerror:!0}:null),w=[E(null),E(a.value)],b=E(0),v=E(!1),i=E(!1),m=k(()=>`q-img q-img--${e.noNativeMenu===!0?"no-":""}menu`),r=k(()=>({width:e.width,height:e.height})),u=k(()=>`q-img__image ${e.imgClass!==void 0?e.imgClass+" ":""}q-img__image--with${e.noTransition===!0?"out":""}-transition q-img__image--`),$=k(()=>({...e.imgStyle,objectFit:e.fit,objectPosition:e.position}));function M(){if(_(),e.loadingShowDelay===0){v.value=!0;return}S(()=>{v.value=!0},e.loadingShowDelay)}function J(){_(),v.value=!1}function H({target:V}){He(l)===!1&&(g(),n.value=V.naturalHeight===0?.5:V.naturalWidth/V.naturalHeight,ee(V,1))}function ee(V,L){L===1e3||He(l)===!0||(V.complete===!0?te(V):s(()=>{ee(V,L+1)},50))}function te(V){He(l)!==!0&&(b.value=b.value^1,w[b.value].value=null,J(),V.getAttribute("__qerror")!=="true"&&(i.value=!1),o("load",V.currentSrc||V.src))}function ae(V){g(),J(),i.value=!0,w[b.value].value=P.value,w[b.value^1].value=a.value,o("error",V)}function U(V){const L=w[V].value,C={key:"img_"+V,class:u.value,style:$.value,alt:e.alt,crossorigin:e.crossorigin,decoding:e.decoding,referrerpolicy:e.referrerpolicy,height:e.height,width:e.width,loading:e.loading,fetchpriority:e.fetchpriority,"aria-hidden":"true",draggable:e.draggable,...L};return b.value===V?Object.assign(C,{class:C.class+"current",onLoad:H,onError:ae}):C.class+="loaded",B("div",{class:"q-img__container absolute-full",key:"img"+V},B("img",C))}function Y(){return v.value===!1?B("div",{key:"content",class:"q-img__content absolute-full q-anchor--skip"},at(h[i.value===!0?"error":"default"])):B("div",{key:"loading",class:"q-img__loading absolute-full flex flex-center"},h.loading!==void 0?h.loading():e.noSpinner===!0?void 0:[B(bt,{color:e.spinnerColor,size:e.spinnerSize})])}{let V=function(){j(()=>e.src||e.srcset||e.sizes?{src:e.src,srcset:e.srcset,sizes:e.sizes}:null,L=>{g(),i.value=!1,L===null?(J(),w[b.value^1].value=a.value):M(),w[b.value].value=L},{immediate:!0})};Jt.value===!0?fe(V):V()}return()=>{const V=[];return t.value!==null&&V.push(B("div",{key:"filler",style:t.value})),w[0].value!==null&&V.push(U(0)),w[1].value!==null&&V.push(U(1)),V.push(B(Zt,{name:"q-transition--fade"},Y)),B("div",{key:"main",class:m.value,style:r.value,role:"img","aria-label":e.alt},V)}}}),xe={visible:!1,success:!1,error:!1,text:null},cl=["src"],ml=Z({__name:"PDFWrapper",props:{path:{},innerContentClass:{}},setup(e){return(h,o)=>(x(),I("iframe",{id:"pdf-container",src:e.path,class:Se(e.innerContentClass)},null,10,cl))}}),fl=De(ml,[["__scopeId","data-v-ccba34f9"]]),vl={key:0},hl={key:1},gl={class:"text-center text-bold q-my-md"},pl={class:"q-pt-none"},bl={key:1},wl={class:"text-center q-my-md"},_l={controls:"",class:"q-mt-md full-width"},yl=["src"],xl={key:2,class:"pdf-container q-mx-auto q-mb-md"},Sl={key:3},kl={class:"text-center q-my-md"},ql={key:4,class:"text-subtitle1 text-center"},Dl={class:"text-center q-my-md"},Cl=Z({__name:"FilePreviewDialog",props:{document:{},currentIndex:{default:0}},emits:["close"],setup(e,{emit:h}){const{t:o}=ie(),n=h,t=E(!1),l=e,s=E(!0),g=k(()=>l.document?.attachments?.length>0),S=k(()=>g.value?l.document?.attachments?.length:0),_=E(l.currentIndex+1||1),a=k(()=>l.document.attachments.length>0&&_.value<=l.document.attachments.length?l.document.attachments[_.value-1]:{id:"",name:"",size:0,hash:"",humanSize:"",createdAt:new ke(o,null),orphaned:!0}),P=()=>{n("close")},w=G({...xe}),b=Ma(),v=()=>{Object.assign(w,xe),t.value=!1},i=()=>{t.value=!0,w.success=!1,w.error=!0,w.text=o("Error loading preview"),w.visible=!0},m=(r,u)=>{Object.assign(w,xe),qt(Ee(r),u).then($=>{w.success=!0,w.text=o("FileDownloadedMessage",{filename:$.fileName,length:$.length})}).catch(()=>{w.error=!0,w.text=o("FileDownloadErrorMessage",{filename:u})}).finally(()=>{w.visible=!0})};return(r,u)=>{const $=Ie("router-link");return x(),F(be,{modelValue:s.value,"onUpdate:modelValue":u[2]||(u[2]=M=>s.value=M),onClose:P,width:"1280px","max-width":"80vw"},St({"header-left":d(()=>[e.document.title?(x(),I("div",vl,[T(y(p(o)("Document title"))+": ",1),c($,{to:{name:"document",params:{id:e.document.id}},class:"text-decoration-hover"},{default:d(()=>[T(y(e.document.title),1)]),_:1},8,["to"])])):(x(),I("div",hl,y(p(o)("Document attachments preview",{count:S.value})),1))]),"header-right":d(()=>[c(ue,{size:"md",square:"",class:"gt-sm theme-default-q-chip shadow-1"},{default:d(()=>[c(ce,{class:"theme-default-q-avatar"},{default:d(()=>[T(y(S.value),1)]),_:1}),T(" "+y(p(o)("Total attachments count",{count:S.value})),1)]),_:1})]),_:2},[a.value?{name:"body",fn:d(()=>[D("div",null,[D("p",gl,y(a.value.name)+" ("+y(a.value.humanSize)+")",1),S.value>1?(x(),F(Ea,{key:0,class:"flex flex-center q-my-md",modelValue:_.value,"onUpdate:modelValue":[u[0]||(u[0]=M=>_.value=M),v],max:S.value,color:"dark","max-pages":5,"boundary-numbers":"","direction-links":"","icon-first":"skip_previous","icon-last":"skip_next","icon-prev":"fast_rewind","icon-next":"fast_forward",gutter:"md"},null,8,["modelValue","max"])):N("",!0)]),D("div",pl,[p(Sa)(a.value.name)?de((x(),F(dl,{key:0,src:p(Ye)(a.value.id,!0),loading:"lazy","spinner-color":"white",onError:i,alt:"image preview",fit:"scale-down",class:"q-img-max-height q-my-md","img-class":"q-mx-auto"},null,8,["src"])),[[Ae,!t.value]]):p(ka)(a.value.name)?(x(),I("div",bl,[D("p",wl,[c(ne,{name:"audio_file",size:"128px"})]),D("audio",_l,[D("source",{src:p(Ye)(a.value.id,!0),type:"audio/mpeg"},null,8,yl),T(" "+y(p(o)("Your browser does not support the audio element")),1)])])):p(qa)(a.value.name)?(x(),I("div",xl,[p(b).allowPDFPreviews?(x(),F(fl,{key:0,path:p(Ye)(a.value.id,!0),"inner-content-class":"pdf-wrapper-inner-class"},null,8,["path"])):(x(),F(Me,{key:1,text:p(o)("Missing browser PDF preview support")},null,8,["text"]))])):(x(),I("div",Sl,[D("p",kl,[c(ne,{name:"hide_source",size:"128px"})])])),t.value?(x(),I("div",ql,[D("p",Dl,[c(ne,{name:"bug_report",size:"128px"})])])):N("",!0)])]),key:"0"}:void 0,a.value?{name:"actions-prepend",fn:d(()=>[w.visible?(x(),F(pe,{key:0,success:w.success,error:w.error},{text:d(()=>[T(y(w.text),1)]),_:1},8,["success","error"])):p(Dt)(a.value.name)?N("",!0):(x(),F(pe,{key:1,warning:""},{text:d(()=>[T(y(p(o)("Attachment preview not available",{filename:a.value.name})),1)]),_:1})),c(ot),c(re,{color:"primary","no-caps":"",href:p(Ee)(a.value.id,!0),label:p(o)("Download"),icon:"download",onClick:u[1]||(u[1]=se(M=>m(a.value.id,a.value.name),["stop","prevent","stop"])),"aria-label":"Download file"},null,8,["href","label"])]),key:"1"}:void 0]),1032,["modelValue"])}}}),Pl={key:0},Tl={key:1},$l={class:"q-pt-none scroll attachments-scrolled-container"},Vl={key:0},Al={key:1},El={key:2},Fl={class:"row full-width"},zl={class:"col-xl-10 col-lg-10 col-md-9 col-sm-12 col-xs-12"},Il={class:"text-weight-bold"},jl={class:"text-weight-bold"},Ml={class:"text-weight-bold"},Rl={class:"col-xl-2 col-lg-2 col-md-3 col-sm-12 col-xs-12"},Bl=Z({__name:"DocumentFilesPreviewDialog",props:{documentId:{},documentTitle:{}},emits:["close"],setup(e,{emit:h}){const{t:o}=ie(),n=e,t=h,l=E(!0),s=G({...ge}),g=G([]),S=k(()=>g?.length>0),_=v=>{z.emit("showDocumentFilePreviewDialog",{document:{id:n.documentId,title:n.documentTitle,attachments:g},currentIndex:v})},a=G({...xe}),P=(v,i)=>{Object.assign(a,xe),qt(Ee(v),i).then(m=>{a.success=!0,a.text=o("FileDownloadedMessage",{filename:m.fileName,length:et.humanStorageSize(m.length)})}).catch(()=>{a.error=!0,a.text=o("FileDownloadeErrorMessage",{filename:i})}).finally(()=>{a.visible=!0})},w=v=>{s.ajaxRunning||(Object.assign(s,ge),s.ajaxRunning=!0,Ce.document.getAttachments(v).then(i=>{g.length=0,g.push(...i.data.attachments.map(m=>new Da(m.id,m.name,m.hash,m.size,new ke(o,m.createdAtTimestamp),!1)))}).catch(i=>{if(s.ajaxErrors=!0,i.isAPIError)switch(s.ajaxAPIErrorDetails=i.customAPIErrorDetails,i.response.status){case 401:s.ajaxErrors=!1,z.emit("reAuthRequired",{emitter:"DocumentFilesPreviewDialog"});break;default:s.ajaxErrorMessage="API Error: fatal error";break}else s.ajaxErrorMessage=`Uncaught exception: ${i}`,console.error(i)}).finally(()=>{s.ajaxRunning=!1}))},b=()=>{t("close")};return fe(()=>{w(n.documentId),z.on("reAuthSucess",v=>{v.to?.includes("DocumentFilesPreviewDialog")&&w(n.documentId)})}),me(()=>{z.off("reAuthSucess")}),(v,i)=>{const m=Ie("router-link");return x(),F(be,{modelValue:l.value,"onUpdate:modelValue":i[0]||(i[0]=r=>l.value=r),onClose:b,width:"1280px","max-width":"80vw"},{"header-left":d(()=>[e.documentTitle?(x(),I("div",Pl,[T(y(p(o)("Document title"))+": ",1),c(m,{to:{name:"document",params:{id:e.documentId}},class:"text-decoration-hover"},{default:d(()=>[T(y(e.documentTitle),1)]),_:1},8,["to"])])):(x(),I("div",Tl,y(p(o)("Document attachments")),1))]),"header-right":d(()=>[!s.ajaxRunning&&!s.ajaxErrors?(x(),F(ue,{key:0,size:"md",square:"",class:"gt-sm theme-default-q-chip shadow-1"},{default:d(()=>[c(ce,{class:"theme-default-q-avatar"},{default:d(()=>[T(y(g.length),1)]),_:1}),T(" "+y(p(o)("Total attachments count",{count:g.length})),1)]),_:1})):N("",!0)]),body:d(()=>[D("div",$l,[s.ajaxRunning?(x(),I("div",Vl)):s.ajaxErrors?(x(),I("div",Al,[c(Me,{text:s.ajaxErrorMessage||"Error loading data","api-error":s.ajaxAPIErrorDetails},null,8,["text","api-error"])])):S.value?(x(),F(lt,{key:3},{default:d(()=>[(x(!0),I(ze,null,Fe(g,(r,u)=>(x(),I("div",{key:r.id,class:"border-bottom-except-last-item"},[c(he,{class:"transparent-background text-color-primary q-pa-sm cursor-default",clickable:""},{default:d(()=>[c(X,null,{default:d(()=>[D("div",Fl,[D("div",zl,[c(K,null,{default:d(()=>[D("span",Il,y(p(o)("Name"))+":",1),T(" "+y(r.name),1)]),_:2},1024),c(K,null,{default:d(()=>[D("span",jl,y(p(o)("Size"))+":",1),T(" "+y(r.humanSize),1)]),_:2},1024),c(K,null,{default:d(()=>[D("span",Ml,y(p(o)("Uploaded on"))+":",1),T(" "+y(r.createdAt.dateTime)+" ("+y(r.createdAt.timeAgo)+")",1)]),_:2},1024)]),D("div",Rl,[c(re,{align:"left",size:"md",color:"primary",class:"q-mt-sm full-width",disable:s.ajaxRunning,icon:"save",label:p(o)("Download"),"no-caps":"",onClick:se($=>P(r.id,r.name),["stop","prevent"]),href:p(Ee)(r.id,!0)},null,8,["disable","label","onClick","href"]),p(Dt)(r.name)?(x(),F(re,{key:0,align:"left",size:"md",color:"primary",class:"q-mt-sm full-width",disable:s.ajaxRunning,icon:"preview",label:p(o)("Preview"),"no-caps":"",onClick:se($=>_(u),["stop","prevent"])},null,8,["disable","label","onClick"])):N("",!0)])])]),_:2},1024)]),_:2},1024)]))),128))]),_:1})):(x(),I("div",El,[c(pe,{warning:"",text:"This document has no associated attachments."})]))])]),"actions-prepend":d(()=>[a.visible?(x(),F(pe,{key:0,success:a.success,error:a.error},{text:d(()=>[T(y(a.text),1)]),_:1},8,["success","error"])):N("",!0),c(ot)]),_:1},8,["modelValue"])}}}),Ll=De(Bl,[["__scopeId","data-v-3d7d4059"]]),Nl={key:0},Ul={key:1},Ql={class:"q-pt-none scroll notes-scrolled-container"},Ol={key:0},Hl={key:1},Wl={key:2},Yl={key:3},Xl={class:"note-date-label"},Kl=Z({__name:"DocumentNotesPreviewDialog",props:{documentId:{},documentTitle:{},maxLines:{default:2}},emits:["close"],setup(e,{emit:h}){const{t:o}=ie(),n=e,t=h,l=E(!0),s=G({...ge}),g=G([]),S=k(()=>g?.length>0),_=P=>{s.ajaxRunning||(Object.assign(s,ge),s.ajaxRunning=!0,Ce.document.getNotes(P).then(w=>{g.length=0,g.push(...w.data.notes.map(b=>new Ca(b.id,b.body,new ke(o,b.createdAtTimestamp),!1,!1)))}).catch(w=>{if(s.ajaxErrors=!0,w.isAPIError)switch(s.ajaxAPIErrorDetails=w.customAPIErrorDetails,w.response.status){case 401:s.ajaxErrors=!1,z.emit("reAuthRequired",{emitter:"DocumentNotesPreviewDialog"});break;default:s.ajaxErrorMessage="API Error: fatal error";break}else s.ajaxErrorMessage=`Uncaught exception: ${w}`,console.error(w)}).finally(()=>{s.ajaxRunning=!1}))},a=()=>{t("close")};return fe(()=>{_(n.documentId),z.on("reAuthSucess",P=>{P.to?.includes("DocumentNotesPreviewDialog")&&_(n.documentId)})}),me(()=>{z.off("reAuthSucess")}),(P,w)=>{const b=Ie("router-link");return x(),F(be,{modelValue:l.value,"onUpdate:modelValue":w[0]||(w[0]=v=>l.value=v),onClose:a,width:"1280px","max-width":"80vw"},{"header-left":d(()=>[e.documentTitle?(x(),I("div",Nl,[T(y(p(o)("Document title"))+": ",1),c(b,{to:{name:"document",params:{id:e.documentId}},class:"text-decoration-hover"},{default:d(()=>[T(y(e.documentTitle),1)]),_:1},8,["to"])])):(x(),I("div",Ul,y(p(o)("Document notes")),1))]),"header-right":d(()=>[!s.ajaxRunning&&!s.ajaxErrors?(x(),F(ue,{key:0,size:"md",square:"",class:"gt-sm theme-default-q-chip shadow-1"},{default:d(()=>[c(ce,{class:"theme-default-q-avatar"},{default:d(()=>[T(y(g.length),1)]),_:1}),T(" "+y(p(o)("Total notes",{count:g.length})),1)]),_:1})):N("",!0)]),body:d(()=>[D("div",Ql,[s.ajaxRunning?(x(),I("div",Ol)):s.ajaxErrors?(x(),I("div",Hl,[c(Me,{text:s.ajaxErrorMessage||"Error loading data","api-error":s.ajaxAPIErrorDetails},null,8,["text","api-error"])])):S.value?(x(),I("div",Yl,[(x(!0),I(ze,null,Fe(g,v=>(x(),I("div",{key:v.id,class:"q-pa-sm relative-position white-space-pre-line border-bottom-except-last-item"},[D("div",Xl,y(v.createdAt.dateTime)+" ("+y(v.createdAt.timeAgo)+")",1),c(ne,{name:v.expanded?"unfold_less":"expand",size:"sm",class:"absolute-top-right text-grey cursor-pointer q-mr-sm q-mt-sm",color:"blue",onClick:se(i=>v.expanded=!v.expanded,["stop"])},{default:d(()=>[c(Ze,null,{default:d(()=>[T(y(p(o)(v.expanded?"Click to collapse":"Click to expand")),1)]),_:2},1024)]),_:2},1032,["name","onClick"]),D("div",{class:Se(["q-mt-sm",{collapsed:!v.expanded}]),style:ea(`--max-lines: ${e.maxLines}`)},y(v.body),7)]))),128))])):(x(),I("div",Wl,[c(pe,{warning:"",text:"This document has no associated notes."})]))])]),_:1},8,["modelValue"])}}}),Gl=De(Kl,[["__scopeId","data-v-95d4bcf6"]]),Jl={class:"q-p-none q-markup-table-container scroll"},Zl={class:"text-left"},eo={class:"text-right"},to={class:"text-right"},ao={class:"text-right"},lo={class:"text-center"},oo={class:"text-left"},no={class:"text-right"},so={class:"text-right"},io={class:"text-right"},ro={key:0},uo={class:"text-center"},co=Z({__name:"UploadingDialog",props:{modelValue:{type:Boolean},transfers:{}},emits:["update:modelValue","close","clearProcessedTransfers"],setup(e,{emit:h}){const{t:o}=ie(),n=Ba(),t=je(),l=h,s=e,g=k(()=>s.transfers?.length>0),S=k({get(){return s.modelValue},set(i){if(i){const m=t.openUploadDialog;m!==a.value&&(a.value=m)}l("update:modelValue",i)}}),_=k(()=>s.transfers.length>0?s.transfers.find(i=>i.processed===!0)!==void 0:!1),a=E(t.openUploadDialog);j(()=>S.value,i=>{i&&(a.value=t.openUploadDialog)});const P=i=>{t.setOpenUploadDialog(i)},w=k(()=>a.value?"Always display this progress window when uploading files":"Only display this progress window when uploading failed"),b=()=>{S.value=!1,l("update:modelValue",!1)},v=()=>{l("clearProcessedTransfers")};return(i,m)=>(x(),F(be,{modelValue:S.value,"onUpdate:modelValue":m[1]||(m[1]=r=>S.value=r),onClose:b,width:"1280px","max-width":"80vw"},{"header-left":d(()=>[T(y(p(o)("File upload activity & status")),1)]),body:d(()=>[D("div",Jl,[g.value?(x(),F(kt,{key:0},{default:d(()=>[D("thead",null,[D("tr",null,[D("th",Zl,y(p(o)("Name")),1),D("th",eo,y(p(o)("Size")),1),D("th",to,y(p(o)("Started")),1),D("th",ao,y(p(o)("End")),1),D("th",lo,y(p(o)("Status")),1)])]),D("tbody",null,[(x(!0),I(ze,null,Fe(e.transfers,r=>(x(),I("tr",{key:r.id,class:Se(["text-white",{"bg-green-5":r.done,"bg-red-4":r.error,"bg-light-blue":r.uploading}])},[D("td",oo,y(r.filename),1),D("td",no,y(p(et).humanStorageSize(r.filesize)),1),D("td",so,y(p(mt)(r.start,p(t).savedDateTimeFormat)),1),D("td",io,[r.end&&r.end>0?(x(),I("span",ro,y(p(mt)(r.end,p(t).savedDateTimeFormat)),1)):N("",!0)]),D("td",uo,[r.error?(x(),F(ue,{key:0,square:"",class:"full-width bg-red-9 text-white"},{default:d(()=>[c(ce,{icon:"cancel",class:"q-ma-xs"}),T(" "+y(r.errorHTTPCode==413?p(o)("Transfer rejected max filesize",{maxUploadFileSize:p(et).humanStorageSize(p(n).maxUploadFileSize)}):p(o)(r.errorMessage||"Error")),1)]),_:2},1024)):r.done?(x(),F(ue,{key:1,square:"",class:"full-width bg-green-9 text-white"},{default:d(()=>[c(ce,{icon:"check",class:"q-ma-xs"}),T(" "+y(p(o)("Transfer complete")),1)]),_:1})):r.uploading?(x(),F(ue,{key:2,square:"",class:"full-width bg-light-blue-9 text-white"},{default:d(()=>[c(bt,{size:"sm",class:"q-ma-xs"}),T(" "+y(p(o)("Transfering...")),1)]),_:1})):N("",!0)])],2))),128))])]),_:1})):N("",!0)])]),"actions-prepend":d(()=>[c(Ra,{modelValue:a.value,"onUpdate:modelValue":[m[0]||(m[0]=r=>a.value=r),P],"checked-icon":"check",color:"green",label:p(o)(w.value),"unchecked-icon":"clear",class:"q-mr-md"},null,8,["modelValue","label"]),c(re,{color:"primary",size:"md","no-caps":"",onClick:se(v,["stop"]),disable:!_.value,icon:"close",label:p(o)("Clear processed transfers")},null,8,["disable","label"])]),_:1},8,["modelValue"]))}}),mo=De(co,[["__scopeId","data-v-5095cb5c"]]),Bo=Z({__name:"MainLayout",setup(e){const h=ga(),{t:o}=ie(),n=G({reauth:{visible:!1},filePreview:{visible:!1,document:new Pa,currentIndex:0},documentFilesPreview:{visible:!1,document:{id:null,title:null}},documentNotesPreview:{visible:!1,document:{id:null,title:null}},fastSearch:{visible:!1},uploading:{visible:!1,transfers:[]}}),t=G([]),l=je(),s=()=>{n.reauth.visible=!1,z.emit("reAuthSucess",{to:t}),t.length=0},g=E(!1),S=E(h.screen.gt.sm),_=ut.getItem("miniSidebarCurrentMode");_!=null&&(g.value=!0);const a=E(_!=null?_==!0:h.screen.md),P=k(()=>h.screen.name);j(P,()=>{g.value||(a.value=h.screen.lt.lg)});const w=k(()=>h.screen.gt.xs?o("Search on HomeDocs..."):""),b=()=>{a.value=!a.value,g.value=!0,ut.set("miniSidebarCurrentMode",a.value)},v=()=>{n.uploading.transfers=n.uploading.transfers.filter(i=>!i.processed)};return fe(()=>{z.on("reAuthRequired",i=>{i.emitter&&t.push(i.emitter),Ce.auth.renewAccessToken().then(m=>{l.setAccessToken(m.data.accessToken),z.emit("reAuthSucess",{to:t}),t.length=0}).catch(m=>{console.error(m),n.reauth.visible=!0})}),z.on("showDocumentFilePreviewDialog",i=>{n.filePreview.document.id=i?.document?.id||null,n.filePreview.document.title=i?.document?.title||"",n.filePreview.document.attachments=i?.document?.attachments||[],n.filePreview.currentIndex=i?.currentIndex||0,n.filePreview.visible=!0}),z.on("showDocumentFilesPreviewDialog",i=>{n.documentFilesPreview.document.id=i?.document?.id||null,n.documentFilesPreview.document.title=i?.document?.title||null,n.documentFilesPreview.visible=!0}),z.on("showDocumentNotesPreviewDialog",i=>{n.documentNotesPreview.document.id=i?.document?.id||null,n.documentNotesPreview.document.title=i?.document?.title||null,n.documentNotesPreview.visible=!0}),z.on("showUploadingDialog",i=>{n.uploading.transfers.unshift(...i.transfers),n.uploading.visible=n.uploading.transfers?.length>0&&l.openUploadDialog}),z.on("refreshUploadingDialog.fileUploaded",i=>{n.uploading.transfers.length>0?i.transfers?.forEach(m=>{const r=n.uploading.transfers?.find(u=>!u.processed&&m.filename==u.filename&&m.filesize==u.filesize);r?(r.end=We(),r.uploading=!1,r.done=!0,r.processed=!0):console.error("Transfer not found",m)}):console.error("Missing previous transfers"),n.uploading.visible=n.uploading.transfers?.length>0&&l.openUploadDialog}),z.on("refreshUploadingDialog.fileUploadRejected",i=>{i.transfers?.forEach(m=>{const r=n.uploading.transfers?.find(u=>!u.processed&&m.filename==u.filename&&m.filesize==u.filesize);r?(r.end=We(),r.uploading=!1,r.error=!0,r.errorHTTPCode=m.errorHTTPCode,r.errorMessage="Transfer rejected",r.processed=!0):n.uploading.transfers.unshift(m)}),n.uploading.visible=n.uploading.transfers?.length>0}),z.on("refreshUploadingDialog.fileUploadFailed",i=>{i.transfers?.forEach(m=>{const r=n.uploading.transfers?.find(u=>!u.processed&&m.filename==u.filename&&m.filesize==u.filesize);r?(r.end=We(),r.uploading=!1,r.error=!0,r.errorHTTPCode=m.errorHTTPCode,r.errorMessage="Transfer failed",r.processed=!0):n.uploading.transfers.unshift(m)}),n.uploading.visible=n.uploading.transfers?.length>0})}),me(()=>{z.off("reAuthRequired"),z.off("showDocumentFilePreviewDialog"),z.off("showDocumentFilesPreviewDialog"),z.off("showDocumentNotesPreviewDialog"),z.off("showUploadingDialog"),z.off("refreshUploadingDialog.fileUploaded"),z.off("refreshUploadingDialog.fileUploadRejected"),z.off("refreshUploadingDialog.fileUploadFailed")}),(i,m)=>{const r=Ie("router-view");return x(),F(ra,{view:"lHh lpR lFf",class:"theme-default-q-layout"},{default:d(()=>[c(Na,{"height-hint":"61.59",class:"theme-default-q-header",bordered:""},{default:d(()=>[c(La,{class:"theme-default-q-toolbar"},{default:d(()=>[de(c(re,{flat:"",dense:"",round:"",onClick:m[0]||(m[0]=u=>{S.value=!S.value}),"aria-label":"Toggle drawer",icon:"menu",class:"q-mr-md"},null,512),[[Ae,!S.value]]),de(c(re,{flat:"",dense:"",round:"",onClick:b,"aria-label":"Toggle drawer",icon:a.value?"arrow_forward_ios":"arrow_back_ios_new",class:"q-mr-md"},{default:d(()=>[c(Ze,null,{default:d(()=>[T(y(p(o)(a.value?"Expand sidebar":"Collapse sidebar")),1)]),_:1})]),_:1},8,["icon"]),[[Ae,S.value]]),c(re,{type:"button","no-caps":"","no-wrap":"",align:"left",outline:"",label:w.value,icon:"search",class:"full-width no-caps theme-default-q-btn",onClick:m[1]||(m[1]=se(u=>n.fastSearch.visible=!0,["prevent"]))},{default:d(()=>[c(Ze,{anchor:"bottom middle",self:"top middle"},{default:d(()=>[T(y(p(o)("Click to open fast search")),1)]),_:1})]),_:1},8,["label"]),c(Lt,{flat:"",class:"q-ml-md"},{default:d(()=>[c(Fa,{dense:""}),c(za,{"short-labels":!0,style:{"min-width":"9em"}}),c(Ia,{dense:"",href:p(ta)},null,8,["href"])]),_:1})]),_:1})]),_:1}),c(Oa,{modelValue:S.value,"onUpdate:modelValue":m[2]||(m[2]=u=>S.value=u),mini:a.value},null,8,["modelValue","mini"]),c(ll,{modelValue:n.fastSearch.visible,"onUpdate:modelValue":m[3]||(m[3]=u=>n.fastSearch.visible=u)},null,8,["modelValue"]),c(ia,null,{default:d(()=>[c(r,{class:"q-pa-sm"})]),_:1}),n.reauth.visible?(x(),F(sl,{key:0,onSuccess:s,onClose:m[4]||(m[4]=u=>n.reauth.visible=!1)})):N("",!0),n.filePreview.visible?(x(),F(Cl,{key:1,document:n.filePreview.document,"current-index":n.filePreview.currentIndex,onClose:m[5]||(m[5]=u=>n.filePreview.visible=!1)},null,8,["document","current-index"])):N("",!0),n.documentFilesPreview.visible&&n.documentFilesPreview.document.id&&n.documentFilesPreview.document.title?(x(),F(Ll,{key:2,"document-id":n.documentFilesPreview.document.id,"document-title":n.documentFilesPreview.document.title,onClose:m[6]||(m[6]=u=>n.documentFilesPreview.visible=!1)},null,8,["document-id","document-title"])):N("",!0),n.documentNotesPreview.visible&&n.documentNotesPreview.document.id&&n.documentNotesPreview.document.title?(x(),F(Gl,{key:3,"document-id":n.documentNotesPreview.document.id,"document-title":n.documentNotesPreview.document.title,onClose:m[7]||(m[7]=u=>n.documentNotesPreview.visible=!1)},null,8,["document-id","document-title"])):N("",!0),c(mo,{modelValue:n.uploading.visible,"onUpdate:modelValue":m[8]||(m[8]=u=>n.uploading.visible=u),transfers:n.uploading.transfers,onClearProcessedTransfers:v},null,8,["modelValue","transfers"])]),_:1})}}});export{Bo as default};
