import{x as D,y as k,j as B,a as Q,b as V,e as r,w as c,h as m,a6 as q,p,ac as l,o as h,f as $,S as T,g as A,s as w,am as S}from"./index-B4QQtCX7.js";import{u as z,b as N,Q as g}from"./QBtn-C-aNyInZ.js";import{Q as P,b as C}from"./QCardSection-7odpSX0S.js";import{h as H}from"./_plugin-vue_export-helper-BlOQ7VLK.js";import{d as I}from"./QSelect-Dvj2_7Nw.js";import{C as W}from"./ClosePopup-DMTUaPG6.js";import{f as j,a as E}from"./bus-CVwhliaE.js";import{D as f}from"./dateTime-BFTmAOKA.js";import{u as R}from"./CustomErrorBanner.vue_vue_type_script_setup_true_lang-DBTLD8xq.js";const F=D({name:"QSpace",setup(){const t=k("div",{class:"q-space"});return()=>t}}),U=D({name:"QCardActions",props:{...z,vertical:Boolean},setup(t,{slots:s}){const e=N(t),a=B(()=>`q-card__actions ${e.value} q-card__actions--${t.vertical===!0?"vert column":"horiz row"}`);return()=>k("div",{class:a.value},H(s.default))}}),x={class:"col flex items-center"},st=Q({__name:"BaseDialog",props:{modelValue:{type:Boolean},showHeaderCloseButton:{type:Boolean,default:!0},width:{default:null},minWidth:{default:null},maxWidth:{default:null},confirmationDialog:{type:Boolean,default:!1},disable:{type:Boolean,default:!1},persistent:{type:Boolean,default:!1},hideFooter:{type:Boolean,default:!1}},emits:["update:modelValue","show","close","confirm","cancel"],setup(t,{emit:s}){const{t:e}=V(),a=s,o=t,i=B({get(){return o.modelValue},set(n){a("update:modelValue",n)}}),u=()=>{a("show")},d=()=>{i.value=!1,a("close")},b=()=>{i.value=!1,a("confirm")},y=()=>{i.value=!1,a("cancel")};return(n,v)=>(h(),r(I,{modelValue:i.value,"onUpdate:modelValue":v[0]||(v[0]=O=>i.value=O),persistent:t.persistent,onHide:d,onShow:u},{default:c(()=>[m(P,{class:"q-card-base-dialog",style:q({width:t.width,minWidth:t.minWidth,maxWidth:t.maxWidth})},{default:c(()=>[m(C,{class:"q-py-xs row self-center q-dialog-header"},{default:c(()=>[l(n.$slots,"header",{},()=>[$("div",x,[l(n.$slots,"header-left")]),m(F),$("div",null,[l(n.$slots,"header-right"),t.showHeaderCloseButton&&!t.persistent?T((h(),r(g,{key:0,icon:"close",flat:"",round:"",dense:"","aria-label":"Close modal"},null,512)),[[W]]):p("",!0)])])]),_:3}),m(C,{class:"q-pa-none q-dialog-body"},{default:c(()=>[l(n.$slots,"body")]),_:3}),t.hideFooter?p("",!0):(h(),r(C,{key:0,class:"q-pa-none q-dialog-footer"},{default:c(()=>[l(n.$slots,"footer",{},()=>[m(U,{align:"right"},{default:c(()=>[l(n.$slots,"actions",{},()=>[l(n.$slots,"actions-prepend"),t.confirmationDialog?(h(),r(g,{key:0,class:"action-secondary",onClick:w(y,["stop"]),disable:t.disable,icon:"close",label:A(e)("Cancel")},null,8,["disable","label"])):p("",!0),t.confirmationDialog?(h(),r(g,{key:1,color:"primary",onClick:w(b,["stop"]),disable:t.disable,icon:"done",label:A(e)("Ok")},null,8,["disable","label"])):p("",!0),t.confirmationDialog?p("",!0):(h(),r(g,{key:2,color:"primary",size:"md","no-caps":"",onClick:w(d,["stop"]),disable:t.disable||t.persistent,icon:"close",label:A(e)("Close")},null,8,["disable","label"]))])]),_:3})])]),_:3}))]),_:3},8,["style"])]),_:3},8,["modelValue","persistent"]))}}),it=t=>!!t?.match(/.(jpg|jpeg|png|gif|mp3|pdf)$/i),nt=t=>{if(t)return!!t?.match(/.(jpg|jpeg|png|gif)$/i)},ot=t=>!!t?.match(/.(mp3)$/i),lt=t=>!!t?.match(/.(pdf)$/i),dt=(t,s=!1)=>s?`${S}/attachment/${t}`:`/attachment/${t}`,rt=(t,s=!1)=>s?`${S}/attachment/${t}/inline`:`/attachment/${t}/inline`;class M{id;name;hash;size;humanSize;createdAt;orphaned;shared;constructor(s,e,a,o,i,u,d){this.id=s,this.name=e,this.hash=a,this.size=o,this.humanSize=j.humanStorageSize(o),this.createdAt=i,this.orphaned=u,this.shared=d}}class L{id;body;createdAt;expanded;startOnEditMode;constructor(s,e,a,o,i){this.id=s,this.body=e,this.createdAt=a,this.expanded=o,this.startOnEditMode=i}}class J{id;createdAt;label;icon;constructor(s,e){switch(this.id=R(),e){case 1:this.label="Document created",this.icon="post_add";break;case 2:this.label="Document updated",this.icon="edit_note";break;default:this.label="Unknown operation",this.icon="error";break}this.createdAt=s}}class ct{id;createdAt;updatedAt;title;description;tags;attachments;notes;historyOperations;constructor(s=null,e=null,a=null,o="",i="",u=[],d=[],b=[],y=[]){this.id=s,this.createdAt=e,this.updatedAt=a,this.title=o,this.description=i,this.tags=u,this.attachments=d,this.notes=b,this.historyOperations=y}hasTags=()=>this.tags.length>0;hasAttachments=()=>this.attachments.length>0;hasNotes=()=>this.notes.length>0;hasHistoryOperations=()=>this.historyOperations.length>0;reset=()=>{this.id=null,this.createdAt=null,this.updatedAt=null,this.title="",this.description="",this.tags.length=0,this.attachments.length=0,this.notes.length=0,this.historyOperations.length=0};previewAttachment=s=>s>=0&&s<this.attachments.length?(E.emit("showDocumentFilePreviewDialog",{document:{id:this.id,title:this.title,attachments:this.attachments},currentIndex:s}),!0):(console.error("Invalid attachment index",s),!1);parseJSONResponse(s,e){this.id=e.data.document.id,this.title=e.data.document.title,this.description=e.data.document.description||"",this.createdAt=new f(s,e.data.document.createdAtTimestamp),e.data.document.updatedAtTimestamp?this.updatedAt=new f(s,e.data.document.updatedAtTimestamp):this.updatedAt=null,this.tags.length=0,e.data.document.tags.length>0&&this.tags.push(...e.data.document.tags),this.attachments.length=0,e.data.document.attachments.length>0&&this.attachments.push(...e.data.document.attachments.map(a=>new M(a.id,a.name,a.hash,a.size,new f(s,a.createdAtTimestamp),!1,a.shared))),this.notes.length=0,e.data.document.notes.length>0&&this.notes.push(...e.data.document.notes.map(a=>new L(a.id,a.body,new f(s,a.createdAtTimestamp),!1,!1))),this.historyOperations.length=0,e.data.document.historyOperations.length>0&&this.historyOperations.push(...e.data.document.historyOperations.map(a=>new J(new f(s,a.createdAtTimestamp),a.operationType)))}}export{M as A,ct as D,L as N,F as Q,st as _,ot as a,lt as b,it as c,dt as d,rt as g,nt as i};
