import{a as _t,Q as se}from"./QBtn-DLMd7gxD.js";import{Q as Ot}from"./ClosePopup-Cuig2ZUf.js";import{p as qe,g as S,q as B,s as at,v as fe,i as E,x as j,y as yt,z as de,A as xt,B as Ut,C as Qe,D as ye,E as Oe,F as Ht,G as Te,H as Je,I as rt,J as Ue,K as Wt,L as Yt,M as ce,n as Ve,N as re,a as ee,c as F,w as u,e as m,j as I,b as D,l as P,O as Fe,P as ze,t as y,u as b,f as St,Q as kt,o as x,R as Xt,S as Kt,T as Gt,U as ut,h as G,V as Jt,W as Zt,X as ea,Y as qt,Z as Se,k as L,m as oe,_ as Ae,$ as ta,a0 as aa,a1 as la,r as Ie,a2 as oa}from"./index-BliOkcHh.js";import{h as lt,a as na,Q as sa,b as dt,s as ia,g as ra,c as ua,_ as Ce}from"./_plugin-vue_export-helper-BWF-eywi.js";import{Q as da}from"./QPageContainer-DO_ZZ8fw.js";import{Q as ca}from"./QLayout-CbKMuWnA.js";import{c as ma,u as fa,b as va,d as ha,e as ga,f as Ze,g as pa,h as ve,i as Y,Q as le,R as ct,a as ba,v as He,_ as et,j as wa}from"./QItem-Ch9RgcXO.js";import{s as We,b as _a,a as me,d as mt,P as ft,G as ya}from"./localStorage-DcFk6gN0.js";import{u as Ct,b as Dt}from"./axios-BbAVdsOQ.js";import{Q as ot,a as ie,D as ke,f as vt,c as Ye}from"./date-time-C6aGxrAY.js";import{b as $e,Q as K,a as z,o as xa,c as Sa,f as tt}from"./QItemLabel-BN-8s06S.js";import{g as ht,s as gt,a as ue,d as he,c as je,_ as ge}from"./CustomErrorBanner.vue_vue_type_script_setup_true_lang-gIiYZZpB.js";import{u as ka,a as qa,b as Ca,c as Da,Q as Pt,d as pt}from"./QMarkupTable-q_MatDdJ.js";import{a as De}from"./api-I8w-eQER.js";import{u as ne}from"./vue-i18n.runtime-2HrbWCRO.js";import{_ as pe,Q as nt,i as Pa,g as Xe,a as Ta,b as $a,c as Tt,d as Ee,A as Va,N as Aa,D as Ea}from"./document-BQ7__lud.js";import{Q as Fa}from"./QInput-Bn6qa3do.js";import{S as za,a as Ia,b as ja,Q as Ma}from"./QPagination-By-lwJhP.js";import{_ as bt}from"./ViewDocumentDetailsButton.vue_vue_type_script_setup_true_lang-DQAUnKMj.js";import{_ as Ba,a as Ra,b as La}from"./GitHubButton.vue_vue_type_script_setup_true_lang-D_r-xTO8.js";import{_ as Na}from"./LoginForm.vue_vue_type_script_setup_true_lang-xNTxVsTB.js";import{Q as Qa}from"./QToggle-DeVJ99Jc.js";import{u as Oa}from"./serverEnvironment-B6hdlTTj.js";import"./darkMode-DSR31_gm.js";import"./i18n-C5FOKKxv.js";import"./i18n-C9ehMPRD.js";import"./useFormUtils-Cwdk2aD0.js";import"./PasswordFieldCustomInput.vue_vue_type_script_setup_true_lang-XYkXYY4_.js";const Ua=qe({name:"QToolbar",props:{inset:Boolean},setup(e,{slots:g}){const n=S(()=>"q-toolbar row no-wrap items-center"+(e.inset===!0?" q-toolbar--inset":""));return()=>B("div",{class:n.value,role:"toolbar"},lt(g.default))}}),Ha=qe({name:"QHeader",props:{modelValue:{type:Boolean,default:!0},reveal:Boolean,revealOffset:{type:Number,default:250},bordered:Boolean,elevated:Boolean,heightHint:{type:[String,Number],default:50}},emits:["reveal","focusin"],setup(e,{slots:g,emit:n}){const{proxy:{$q:s}}=at(),t=yt(xt,fe);if(t===fe)return console.error("QHeader needs to be child of QLayout"),fe;const l=E(parseInt(e.heightHint,10)),o=E(!0),w=S(()=>e.reveal===!0||t.view.value.indexOf("H")!==-1||s.platform.is.ios&&t.isContainer.value===!0),k=S(()=>{if(e.modelValue!==!0)return 0;if(w.value===!0)return o.value===!0?l.value:0;const p=l.value-t.scroll.value.position;return p>0?p:0}),d=S(()=>e.modelValue!==!0||w.value===!0&&o.value!==!0),i=S(()=>e.modelValue===!0&&d.value===!0&&e.reveal===!0),T=S(()=>"q-header q-layout__section--marginal "+(w.value===!0?"fixed":"absolute")+"-top"+(e.bordered===!0?" q-header--bordered":"")+(d.value===!0?" q-header--hidden":"")+(e.modelValue!==!0?" q-layout--prevent-focus":"")),h=S(()=>{const p=t.rows.value.top,$={};return p[0]==="l"&&t.left.space===!0&&($[s.lang.rtl===!0?"right":"left"]=`${t.left.size}px`),p[2]==="r"&&t.right.space===!0&&($[s.lang.rtl===!0?"left":"right"]=`${t.right.size}px`),$});function _(p,$){t.update("header",p,$)}function a(p,$){p.value!==$&&(p.value=$)}function r({height:p}){a(l,p),_("size",p)}function c(p){i.value===!0&&a(o,!0),n("focusin",p)}j(()=>e.modelValue,p=>{_("space",p),a(o,!0),t.animate()}),j(k,p=>{_("offset",p)}),j(()=>e.reveal,p=>{p===!1&&a(o,e.modelValue)}),j(o,p=>{t.animate(),n("reveal",p)}),j(t.scroll,p=>{e.reveal===!0&&a(o,p.direction==="up"||p.position<=e.revealOffset||p.position-p.inflectionPoint<100)});const v={};return t.instances.header=v,e.modelValue===!0&&_("size",l.value),_("space",e.modelValue),_("offset",k.value),de(()=>{t.instances.header===v&&(t.instances.header=void 0,_("size",0),_("offset",0),_("space",!1))}),()=>{const p=na(g.default,[]);return e.elevated===!0&&p.push(B("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),p.push(B(sa,{debounce:0,onResize:r})),B("header",{class:T.value,style:h.value,onFocusin:c},p)}}});function Ke(e,g,n){const s=Je(e);let t,l=s.left-g.event.x,o=s.top-g.event.y,w=Math.abs(l),k=Math.abs(o);const d=g.direction;d.horizontal===!0&&d.vertical!==!0?t=l<0?"left":"right":d.horizontal!==!0&&d.vertical===!0?t=o<0?"up":"down":d.up===!0&&o<0?(t="up",w>k&&(d.left===!0&&l<0?t="left":d.right===!0&&l>0&&(t="right"))):d.down===!0&&o>0?(t="down",w>k&&(d.left===!0&&l<0?t="left":d.right===!0&&l>0&&(t="right"))):d.left===!0&&l<0?(t="left",w<k&&(d.up===!0&&o<0?t="up":d.down===!0&&o>0&&(t="down"))):d.right===!0&&l>0&&(t="right",w<k&&(d.up===!0&&o<0?t="up":d.down===!0&&o>0&&(t="down")));let i=!1;if(t===void 0&&n===!1){if(g.event.isFirst===!0||g.event.lastDir===void 0)return{};t=g.event.lastDir,i=!0,t==="left"||t==="right"?(s.left-=l,w=0,l=0):(s.top-=o,k=0,o=0)}return{synthetic:i,payload:{evt:e,touch:g.event.mouse!==!0,mouse:g.event.mouse===!0,position:s,direction:t,isFirst:g.event.isFirst,isFinal:n===!0,duration:Date.now()-g.event.time,distance:{x:w,y:k},offset:{x:l,y:o},delta:{x:s.left-g.event.lastX,y:s.top-g.event.lastY}}}}let Wa=0;const Ge=Ut({name:"touch-pan",beforeMount(e,{value:g,modifiers:n}){if(n.mouse!==!0&&ye.has.touch!==!0)return;function s(l,o){n.mouse===!0&&o===!0?Yt(l):(n.stop===!0&&Ue(l),n.prevent===!0&&rt(l))}const t={uid:"qvtp_"+Wa++,handler:g,modifiers:n,direction:ht(n),noop:Ht,mouseStart(l){gt(l,t)&&Wt(l)&&(Te(t,"temp",[[document,"mousemove","move","notPassiveCapture"],[document,"mouseup","end","passiveCapture"]]),t.start(l,!0))},touchStart(l){if(gt(l,t)){const o=l.target;Te(t,"temp",[[o,"touchmove","move","notPassiveCapture"],[o,"touchcancel","end","passiveCapture"],[o,"touchend","end","passiveCapture"]]),t.start(l)}},start(l,o){if(ye.is.firefox===!0&&Oe(e,!0),t.lastEvt=l,o===!0||n.stop===!0){if(t.direction.all!==!0&&(o!==!0||t.modifiers.mouseAllDir!==!0&&t.modifiers.mousealldir!==!0)){const d=l.type.indexOf("mouse")!==-1?new MouseEvent(l.type,l):new TouchEvent(l.type,l);l.defaultPrevented===!0&&rt(d),l.cancelBubble===!0&&Ue(d),Object.assign(d,{qKeyEvent:l.qKeyEvent,qClickOutside:l.qClickOutside,qAnchorHandled:l.qAnchorHandled,qClonedBy:l.qClonedBy===void 0?[t.uid]:l.qClonedBy.concat(t.uid)}),t.initialEvent={target:l.target,event:d}}Ue(l)}const{left:w,top:k}=Je(l);t.event={x:w,y:k,time:Date.now(),mouse:o===!0,detected:!1,isFirst:!0,isFinal:!1,lastX:w,lastY:k}},move(l){if(t.event===void 0)return;const o=Je(l),w=o.left-t.event.x,k=o.top-t.event.y;if(w===0&&k===0)return;t.lastEvt=l;const d=t.event.mouse===!0,i=()=>{s(l,d);let _;n.preserveCursor!==!0&&n.preservecursor!==!0&&(_=document.documentElement.style.cursor||"",document.documentElement.style.cursor="grabbing"),d===!0&&document.body.classList.add("no-pointer-events--children"),document.body.classList.add("non-selectable"),ma(),t.styleCleanup=a=>{if(t.styleCleanup=void 0,_!==void 0&&(document.documentElement.style.cursor=_),document.body.classList.remove("non-selectable"),d===!0){const r=()=>{document.body.classList.remove("no-pointer-events--children")};a!==void 0?setTimeout(()=>{r(),a()},50):r()}else a!==void 0&&a()}};if(t.event.detected===!0){t.event.isFirst!==!0&&s(l,t.event.mouse);const{payload:_,synthetic:a}=Ke(l,t,!1);_!==void 0&&(t.handler(_)===!1?t.end(l):(t.styleCleanup===void 0&&t.event.isFirst===!0&&i(),t.event.lastX=_.position.left,t.event.lastY=_.position.top,t.event.lastDir=a===!0?void 0:_.direction,t.event.isFirst=!1));return}if(t.direction.all===!0||d===!0&&(t.modifiers.mouseAllDir===!0||t.modifiers.mousealldir===!0)){i(),t.event.detected=!0,t.move(l);return}const T=Math.abs(w),h=Math.abs(k);T!==h&&(t.direction.horizontal===!0&&T>h||t.direction.vertical===!0&&T<h||t.direction.up===!0&&T<h&&k<0||t.direction.down===!0&&T<h&&k>0||t.direction.left===!0&&T>h&&w<0||t.direction.right===!0&&T>h&&w>0?(t.event.detected=!0,t.move(l)):t.end(l,!0))},end(l,o){if(t.event!==void 0){if(Qe(t,"temp"),ye.is.firefox===!0&&Oe(e,!1),o===!0)t.styleCleanup?.(),t.event.detected!==!0&&t.initialEvent!==void 0&&t.initialEvent.target.dispatchEvent(t.initialEvent.event);else if(t.event.detected===!0){t.event.isFirst===!0&&t.handler(Ke(l===void 0?t.lastEvt:l,t).payload);const{payload:w}=Ke(l===void 0?t.lastEvt:l,t,!0),k=()=>{t.handler(w)};t.styleCleanup!==void 0?t.styleCleanup(k):k()}t.event=void 0,t.initialEvent=void 0,t.lastEvt=void 0}}};if(e.__qtouchpan=t,n.mouse===!0){const l=n.mouseCapture===!0||n.mousecapture===!0?"Capture":"";Te(t,"main",[[e,"mousedown","mouseStart",`passive${l}`]])}ye.has.touch===!0&&Te(t,"main",[[e,"touchstart","touchStart",`passive${n.capture===!0?"Capture":""}`],[e,"touchmove","noop","notPassiveCapture"]])},updated(e,g){const n=e.__qtouchpan;n!==void 0&&(g.oldValue!==g.value&&(typeof value!="function"&&n.end(),n.handler=g.value),n.direction=ht(g.modifiers))},beforeUnmount(e){const g=e.__qtouchpan;g!==void 0&&(g.event!==void 0&&g.end(),Qe(g,"main"),Qe(g,"temp"),ye.is.firefox===!0&&Oe(e,!1),g.styleCleanup?.(),delete e.__qtouchpan)}}),wt=150,Ya=qe({name:"QDrawer",inheritAttrs:!1,props:{...ha,...va,side:{type:String,default:"left",validator:e=>["left","right"].includes(e)},width:{type:Number,default:300},mini:Boolean,miniToOverlay:Boolean,miniWidth:{type:Number,default:57},noMiniAnimation:Boolean,breakpoint:{type:Number,default:1023},showIfAbove:Boolean,behavior:{type:String,validator:e=>["default","desktop","mobile"].includes(e),default:"default"},bordered:Boolean,elevated:Boolean,overlay:Boolean,persistent:Boolean,noSwipeOpen:Boolean,noSwipeClose:Boolean,noSwipeBackdrop:Boolean},emits:[...fa,"onLayout","miniState"],setup(e,{slots:g,emit:n,attrs:s}){const t=at(),{proxy:{$q:l}}=t,o=ga(e,l),{preventBodyScroll:w}=qa(),{registerTimeout:k,removeTimeout:d}=Ze(),i=yt(xt,fe);if(i===fe)return console.error("QDrawer needs to be child of QLayout"),fe;let T,h=null,_;const a=E(e.behavior==="mobile"||e.behavior!=="desktop"&&i.totalWidth.value<=e.breakpoint),r=S(()=>e.mini===!0&&a.value!==!0),c=S(()=>r.value===!0?e.miniWidth:e.width),v=E(e.showIfAbove===!0&&a.value===!1?!0:e.modelValue===!0),p=S(()=>e.persistent!==!0&&(a.value===!0||$t.value===!0));function $(f,A){if(J(),f!==!1&&i.animate(),H(0),a.value===!0){const O=i.instances[R.value];O?.belowBreakpoint===!0&&O.hide(!1),te(1),i.isContainer.value!==!0&&w(!0)}else te(0),f!==!1&&Re(!1);k(()=>{f!==!1&&Re(!0),A!==!0&&n("show",f)},wt)}function Q(f,A){be(),f!==!1&&i.animate(),te(0),H(X.value*c.value),Le(),A!==!0?k(()=>{n("hide",f)},wt):d()}const{show:U,hide:W}=pa({showing:v,hideOnRouteChange:p,handleShow:$,handleHide:Q}),{addToHistory:J,removeFromHistory:be}=ka(v,W,p),Z={belowBreakpoint:a,hide:W},N=S(()=>e.side==="right"),X=S(()=>(l.lang.rtl===!0?-1:1)*(N.value===!0?1:-1)),V=E(0),q=E(!1),M=E(!1),C=E(c.value*X.value),R=S(()=>N.value===!0?"left":"right"),we=S(()=>v.value===!0&&a.value===!1&&e.overlay===!1?e.miniToOverlay===!0?e.miniWidth:c.value:0),Me=S(()=>e.overlay===!0||e.miniToOverlay===!0||i.view.value.indexOf(N.value?"R":"L")!==-1||l.platform.is.ios===!0&&i.isContainer.value===!0),_e=S(()=>e.overlay===!1&&v.value===!0&&a.value===!1),$t=S(()=>e.overlay===!0&&v.value===!0&&a.value===!1),Vt=S(()=>"fullscreen q-drawer__backdrop"+(v.value===!1&&q.value===!1?" hidden":"")),At=S(()=>({backgroundColor:`rgba(0,0,0,${V.value*.4})`})),st=S(()=>N.value===!0?i.rows.value.top[2]==="r":i.rows.value.top[0]==="l"),Et=S(()=>N.value===!0?i.rows.value.bottom[2]==="r":i.rows.value.bottom[0]==="l"),Ft=S(()=>{const f={};return i.header.space===!0&&st.value===!1&&(Me.value===!0?f.top=`${i.header.offset}px`:i.header.space===!0&&(f.top=`${i.header.size}px`)),i.footer.space===!0&&Et.value===!1&&(Me.value===!0?f.bottom=`${i.footer.offset}px`:i.footer.space===!0&&(f.bottom=`${i.footer.size}px`)),f}),zt=S(()=>{const f={width:`${c.value}px`,transform:`translateX(${C.value}px)`};return a.value===!0?f:Object.assign(f,Ft.value)}),It=S(()=>"q-drawer__content fit "+(i.isContainer.value!==!0?"scroll":"overflow-auto")),jt=S(()=>`q-drawer q-drawer--${e.side}`+(M.value===!0?" q-drawer--mini-animate":"")+(e.bordered===!0?" q-drawer--bordered":"")+(o.value===!0?" q-drawer--dark q-dark":"")+(q.value===!0?" no-transition":v.value===!0?"":" q-layout--prevent-focus")+(a.value===!0?" fixed q-drawer--on-top q-drawer--mobile q-drawer--top-padding":` q-drawer--${r.value===!0?"mini":"standard"}`+(Me.value===!0||_e.value!==!0?" fixed":"")+(e.overlay===!0||e.miniToOverlay===!0?" q-drawer--on-top":"")+(st.value===!0?" q-drawer--top-padding":""))),Mt=S(()=>{const f=l.lang.rtl===!0?e.side:R.value;return[[Ge,Nt,void 0,{[f]:!0,mouse:!0}]]}),Bt=S(()=>{const f=l.lang.rtl===!0?R.value:e.side;return[[Ge,it,void 0,{[f]:!0,mouse:!0}]]}),Rt=S(()=>{const f=l.lang.rtl===!0?R.value:e.side;return[[Ge,it,void 0,{[f]:!0,mouse:!0,mouseAllDir:!0}]]});function Be(){Qt(a,e.behavior==="mobile"||e.behavior!=="desktop"&&i.totalWidth.value<=e.breakpoint)}j(a,f=>{f===!0?(T=v.value,v.value===!0&&W(!1)):e.overlay===!1&&e.behavior!=="mobile"&&T!==!1&&(v.value===!0?(H(0),te(0),Le()):U(!1))}),j(()=>e.side,(f,A)=>{i.instances[A]===Z&&(i.instances[A]=void 0,i[A].space=!1,i[A].offset=0),i.instances[f]=Z,i[f].size=c.value,i[f].space=_e.value,i[f].offset=we.value}),j(i.totalWidth,()=>{(i.isContainer.value===!0||document.qScrollPrevented!==!0)&&Be()}),j(()=>e.behavior+e.breakpoint,Be),j(i.isContainer,f=>{v.value===!0&&w(f!==!0),f===!0&&Be()}),j(i.scrollbarWidth,()=>{H(v.value===!0?0:void 0)}),j(we,f=>{ae("offset",f)}),j(_e,f=>{n("onLayout",f),ae("space",f)}),j(N,()=>{H()}),j(c,f=>{H(),Ne(e.miniToOverlay,f)}),j(()=>e.miniToOverlay,f=>{Ne(f,c.value)}),j(()=>l.lang.rtl,()=>{H()}),j(()=>e.mini,()=>{e.noMiniAnimation||e.modelValue===!0&&(Lt(),i.animate())}),j(r,f=>{n("miniState",f)});function H(f){f===void 0?Ve(()=>{f=v.value===!0?0:c.value,H(X.value*f)}):(i.isContainer.value===!0&&N.value===!0&&(a.value===!0||Math.abs(f)===c.value)&&(f+=X.value*i.scrollbarWidth.value),C.value=f)}function te(f){V.value=f}function Re(f){const A=f===!0?"remove":i.isContainer.value!==!0?"add":"";A!==""&&document.body.classList[A]("q-body--drawer-toggle")}function Lt(){h!==null&&clearTimeout(h),t.proxy&&t.proxy.$el&&t.proxy.$el.classList.add("q-drawer--mini-animate"),M.value=!0,h=setTimeout(()=>{h=null,M.value=!1,t?.proxy?.$el?.classList.remove("q-drawer--mini-animate")},150)}function Nt(f){if(v.value!==!1)return;const A=c.value,O=$e(f.distance.x,0,A);if(f.isFinal===!0){O>=Math.min(75,A)===!0?U():(i.animate(),te(0),H(X.value*A)),q.value=!1;return}H((l.lang.rtl===!0?N.value!==!0:N.value)?Math.max(A-O,0):Math.min(0,O-A)),te($e(O/A,0,1)),f.isFirst===!0&&(q.value=!0)}function it(f){if(v.value!==!0)return;const A=c.value,O=f.direction===e.side,Pe=(l.lang.rtl===!0?O!==!0:O)?$e(f.distance.x,0,A):0;if(f.isFinal===!0){Math.abs(Pe)<Math.min(75,A)===!0?(i.animate(),te(1),H(0)):W(),q.value=!1;return}H(X.value*Pe),te($e(1-Pe/A,0,1)),f.isFirst===!0&&(q.value=!0)}function Le(){w(!1),Re(!0)}function ae(f,A){i.update(e.side,f,A)}function Qt(f,A){f.value!==A&&(f.value=A)}function Ne(f,A){ae("size",f===!0?e.miniWidth:A)}return i.instances[e.side]=Z,Ne(e.miniToOverlay,c.value),ae("space",_e.value),ae("offset",we.value),e.showIfAbove===!0&&e.modelValue!==!0&&v.value===!0&&e["onUpdate:modelValue"]!==void 0&&n("update:modelValue",!0),ce(()=>{n("onLayout",_e.value),n("miniState",r.value),T=e.showIfAbove===!0;const f=()=>{(v.value===!0?$:Q)(!1,!0)};if(i.totalWidth.value!==0){Ve(f);return}_=j(i.totalWidth,()=>{_(),_=void 0,v.value===!1&&e.showIfAbove===!0&&a.value===!1?U(!1):f()})}),de(()=>{_?.(),h!==null&&(clearTimeout(h),h=null),v.value===!0&&Le(),i.instances[e.side]===Z&&(i.instances[e.side]=void 0,ae("size",0),ae("offset",0),ae("space",!1))}),()=>{const f=[];a.value===!0&&(e.noSwipeOpen===!1&&f.push(re(B("div",{key:"open",class:`q-drawer__opener fixed-${e.side}`,"aria-hidden":"true"}),Mt.value)),f.push(dt("div",{ref:"backdrop",class:Vt.value,style:At.value,"aria-hidden":"true",onClick:W},void 0,"backdrop",e.noSwipeBackdrop!==!0&&v.value===!0,()=>Rt.value)));const A=r.value===!0&&g.mini!==void 0,O=[B("div",{...s,key:""+A,class:[It.value,s.class]},A===!0?g.mini():lt(g.default))];return e.elevated===!0&&v.value===!0&&O.push(B("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),f.push(dt("aside",{ref:"content",class:jt.value,style:zt.value},O,"contentclose",e.noSwipeClose!==!0&&a.value===!0,()=>Bt.value)),B("div",{class:"q-drawer-container"},f)}}}),Xa=ee({__name:"SidebarDrawer",props:{modelValue:{type:Boolean},mini:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:g}){const n=e,s=g,t=S({get(){return n.modelValue},set(_){s("update:modelValue",_)}}),{t:l}=ne(),o=St(),w=kt(),k=S(()=>String(w.name)),d=Ct(),i=S(()=>n.mini),T=[{icon:"home",text:"Home",routeName:"index"},{icon:"account_circle",text:"My profile",routeName:"profile"},{icon:"note_add",text:"Add",routeName:"newDocument"},{icon:"find_in_page",text:"Advanced search",routeName:"advancedSearch",alternateRouteNames:["advancedSearchByTag","advancedSearchByFixedCreationDate","advancedSearchByFixedLastUpdate","advancedSearchByFixedUpdatedOn"]}],h=()=>{De.auth.logout().then(()=>{d.removeAccessToken(),o.push({name:"login"}).catch(_=>{console.error(_)})}).catch(_=>{console.error(_),d.removeAccessToken(),o.push({name:"login"}).catch(a=>{console.error(a)})})};return(_,a)=>(x(),F(Ya,{modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=r=>t.value=r),"show-if-above":"",bordered:"",width:240,mini:i.value,class:"fit theme-default-q-drawer"},{default:u(()=>[m(ot,null,{default:u(()=>[m(ve,{class:"cursor-pointer non-selectable no-pointer-events rounded-borders q-ma-sm theme-default-q-item"},{default:u(()=>[m(Y,{avatar:""},{default:u(()=>[m(ue,{square:"",size:"24px"},{default:u(()=>[...a[1]||(a[1]=[D("img",{src:"icons/favicon-128x128.png"},null,-1)])]),_:1})]),_:1}),m(Y,null,{default:u(()=>[m(K,{class:"text-weight-bold text-uppercase"},{default:u(()=>[...a[2]||(a[2]=[P("HomeDocs",-1)])]),_:1})]),_:1})]),_:1}),(x(),I(ze,null,Fe(T,r=>re(m(ve,{key:r.text,clickable:"",to:{name:r.routeName},class:"rounded-borders q-ma-sm theme-default-q-item",active:r.routeName==k.value||r.alternateRouteNames?.includes(k.value),"active-class":"theme-default-q-item-active"},{default:u(()=>[m(Y,{avatar:""},{default:u(()=>[m(le,{name:r.icon},null,8,["name"])]),_:2},1024),m(Y,null,{default:u(()=>[m(K,null,{default:u(()=>[P(y(b(l)(r.text)),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["to","active"]),[[ct]])),64)),re((x(),F(ve,{clickable:"",onClick:h,class:"rounded-borders q-ma-sm theme-default-q-item"},{default:u(()=>[m(Y,{avatar:""},{default:u(()=>[m(le,{name:"logout"})]),_:1}),m(Y,null,{default:u(()=>[m(K,null,{default:u(()=>[P(y(b(l)("Sign out")),1)]),_:1})]),_:1})]),_:1})),[[ct]])]),_:1})]),_:1},8,["modelValue","mini"]))}});function Ka(e,g){return B("div",e,[B("table",{class:"q-table"},g)])}const Ga={list:ot,table:Pt},Ja=["list","table","__qtable"],Za=qe({name:"QVirtualScroll",props:{...Ca,type:{type:String,default:"list",validator:e=>Ja.includes(e)},items:{type:Array,default:()=>[]},itemsFn:Function,itemsSize:Number,scrollTarget:ia},setup(e,{slots:g,attrs:n}){let s;const t=E(null),l=S(()=>e.itemsSize>=0&&e.itemsFn!==void 0?parseInt(e.itemsSize,10):Array.isArray(e.items)?e.items.length:0),{virtualScrollSliceRange:o,localResetVirtualScroll:w,padVirtualScroll:k,onVirtualScrollEvt:d}=Da({virtualScrollLength:l,getVirtualScrollTarget:a,getVirtualScrollEl:_}),i=S(()=>{if(l.value===0)return[];const p=($,Q)=>({index:o.value.from+Q,item:$});return e.itemsFn===void 0?e.items.slice(o.value.from,o.value.to).map(p):e.itemsFn(o.value.from,o.value.to-o.value.from).map(p)}),T=S(()=>"q-virtual-scroll q-virtual-scroll"+(e.virtualScrollHorizontal===!0?"--horizontal":"--vertical")+(e.scrollTarget!==void 0?"":" scroll")),h=S(()=>e.scrollTarget!==void 0?{}:{tabindex:0});j(l,()=>{w()}),j(()=>e.scrollTarget,()=>{c(),r()});function _(){return t.value.$el||t.value}function a(){return s}function r(){s=ra(_(),e.scrollTarget),s.addEventListener("scroll",d,ut.passive)}function c(){s!==void 0&&(s.removeEventListener("scroll",d,ut.passive),s=void 0)}function v(){let p=k(e.type==="list"?"div":"tbody",i.value.map(g.default));return g.before!==void 0&&(p=g.before().concat(p)),ua(g.after,p)}return Xt(()=>{w()}),ce(()=>{r()}),Kt(()=>{r()}),Gt(()=>{c()}),de(()=>{c()}),()=>{if(g.default===void 0){console.error("QVirtualScroll: default scoped slot is required for rendering");return}return e.type==="__qtable"?Ka({ref:t,class:"q-table__middle "+T.value},v()):B(Ga[e.type],{...n,ref:t,class:[n.class,T.value],...h.value},v)}}}),el={class:"q-pa-sm row items-center q-gutter-sm"},tl={class:"col-auto"},al={style:{"flex-grow":"1"}},ll={key:0},ol=["innerHTML"],nl={class:"text-color-primary"},sl=ee({__name:"SearchDialog",props:{modelValue:{type:Boolean}},emits:["update:modelValue","close"],setup(e,{emit:g}){const n=e,s=St(),t=kt(),l=E(t.name=="document"&&t.params?.id||null),{t:o}=ne(),w=g,k=S({get(){return n.modelValue},set(q){w("update:modelValue",q)}}),d=G({...he}),i=S(()=>[{label:"Title",value:"title"},{label:"Description",value:"description"},{label:"Notes",value:"notesBody"},{label:"Attachment names",value:"attachmentsFilename"}]),T={field:"lastUpdateTimestamp",label:"",order:"DESC"},h=E(i.value[0]);j(()=>h.value,()=>{Ve().then(()=>{W.value?.focus()}).catch(q=>{console.error(q)})});const _=E(null),a=G({currentPageIndex:1,resultsPage:We.get(),totalResults:0,totalPages:0}),r=[1,2,3,4,6,8,12,16,24,32,64,128],c=q=>{We.set(q),J(v.value)},v=E(""),p=Jt([]),$=E(-1),Q=E(0),U=E(!1),W=E(null),J=q=>{if(a.totalResults=0,a.totalPages=0,U.value=!1,q&&q.trim().length>0){$.value=-1,Object.assign(d,he),d.ajaxRunning=!0;const M={text:new za(h.value.value=="title"?q.trim():null,h.value.value=="description"?q.trim():null,h.value.value=="notesBody"?q.trim():null,h.value.value=="attachmentsFilename"?q.trim():null),tags:[],dates:new Ia};De.document.search(a,M,T,!0).then(C=>{a.totalResults=C.data.results.pagination.totalResults,a.totalPages=C.data.results.pagination.totalPages,p.value=C.data.results.documents.map(R=>new ja(o,R.id,new ke(o,R.createdAtTimestamp),new ke(o,R.updatedAtTimestamp),R.title,R.description,R.tags,R.attachmentCount,R.noteCount,R.matchedFragments,q.trim())),U.value=p.value.length<=0}).catch(C=>{if(d.ajaxErrors=!0,C.isAPIError)switch(d.ajaxAPIErrorDetails=C.customAPIErrorDetails,C.response.status){case 401:d.ajaxErrors=!1,z.emit("reAuthRequired",{emitter:"SearchDialog.onSearch"});break;default:d.ajaxErrorMessage="API Error: fatal error";break}else d.ajaxErrorMessage=`Uncaught exception: ${C}`,console.error(C)}).finally(()=>{d.ajaxRunning=!1})}else p.value=[]},be=q=>{Q.value=q.index},Z=q=>{_.value&&_.value.scrollTo(q,"start-force")},N=q=>{q.key==="ArrowUp"?p.value.length>0&&$.value>0&&($.value--,Z($.value),q.preventDefault(),q.stopPropagation()):q.key==="ArrowDown"?p.value.length>0&&$.value<p.value.length-1&&($.value++,Z($.value),q.preventDefault(),q.stopPropagation()):q.key==="Enter"&&p.value.length>0&&$.value>=0&&$.value<p.value.length&&s.push({name:"document",params:{id:p.value[$.value].id}}).catch(M=>{console.error(M)})},X=()=>{a.resultsPage=We.get(),a.totalResults=0,a.totalPages=0,window.addEventListener("keydown",N),Ve().then(()=>{W.value?.focus()}).catch(q=>{console.error(q)})},V=()=>{p.value=[],v.value="",U.value=!1,window.removeEventListener("keydown",N),w("close")};return ce(()=>{z.on("reAuthSucess",q=>{q.to?.includes("SearchDialog.onSearch")&&J(v.value)})}),de(()=>{z.off("reAuthSucess")}),(q,M)=>(x(),F(pe,{modelValue:k.value,"onUpdate:modelValue":M[5]||(M[5]=C=>k.value=C),onShow:X,onClose:V,width:"1280px","max-width":"80vw"},{"header-left":u(()=>[P(y(b(o)("Search on HomeDocs...")),1)]),"header-right":u(()=>[!d.ajaxRunning&&!d.ajaxErrors?re((x(),F(ie,{key:0,size:"md",square:"",class:"gt-sm theme-default-q-chip shadow-1"},{default:u(()=>[m(ue,{class:"theme-default-q-avatar theme-default-q-avatar-width-auto"},{default:u(()=>[P(y(a.totalResults),1)]),_:1}),P(" "+y(b(o)("Results count",{count:a.totalResults})),1)]),_:1},512)),[[Ae,a.totalResults>0]]):L("",!0)]),body:u(()=>[D("div",el,[D("div",tl,[m(pt,{modelValue:h.value,"onUpdate:modelValue":[M[0]||(M[0]=C=>h.value=C),M[1]||(M[1]=C=>J(v.value))],options:i.value,"display-value":`${h.value?b(o)(h.value.label):""}`,dense:"","options-dense":"",outlined:"",style:{"min-width":"8em"},label:b(o)("Search on"),disable:d.ajaxRunning},{option:u(C=>[m(ve,Zt(ea(C.itemProps)),{default:u(()=>[m(Y,null,{default:u(()=>[m(K,null,{default:u(()=>[P(y(b(o)(C.label)),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options","display-value","label","disable"])]),D("div",al,[m(b(Fa),{type:"text",dense:"",color:"grey-3","label-color":"grey-7",label:b(o)("Search text..."),modelValue:v.value,"onUpdate:modelValue":[M[2]||(M[2]=C=>v.value=C),M[3]||(M[3]=C=>J(v.value))],clearable:"",outlined:"",ref_key:"searchTextField",ref:W},{prepend:u(()=>[m(le,{name:"search"})]),_:1},8,["label","modelValue"])])]),m(ba),d.ajaxErrors?(x(),I("div",ll,[m(je,{text:d.ajaxErrorMessage||"Error loading data","api-error":d.ajaxAPIErrorDetails},null,8,["text","api-error"])])):(x(),F(b(Za),{key:1,component:"q-list",items:p.value,onVirtualScroll:be,ref_key:"virtualListRef",ref:_,class:"q-virtual-scroll-container"},qt({default:u(({item:C,index:R})=>[D("div",{class:Se(["border-bottom-except-last-item",{"current-keyboard-selected-item":$.value===R}])},[(x(),F(ve,{key:C.id,class:Se(["transparent-background text-color-primary q-pa-sm",{"cursor-not-allowed is-current":C.id===l.value}]),clickable:C.id!==l.value,to:{name:"document",params:{id:C.id}}},{default:u(()=>[m(Y,{side:"",class:"gt-sm"},{default:u(()=>[m(le,{name:"work"})]),_:1}),m(Y,null,{default:u(()=>[m(K,null,{default:u(()=>[P(y(C.title),1)]),_:2},1024),C.matchedOnFragment?(x(),F(K,{key:0,caption:""},{default:u(()=>[D("div",{innerHTML:C.matchedOnFragment},null,8,ol)]),_:2},1024)):L("",!0)]),_:2},1024),m(Y,{side:"",top:""},{default:u(()=>[m(K,{caption:""},{default:u(()=>[P(" ("+y(C.updatedAt.timeAgo||C.createdAt.timeAgo)+") ",1),D("span",nl,y(C.updatedAt.dateTime||C.createdAt.dateTime),1)]),_:2},1024),m(bt,{size:"md",square:"",class:"min-width-9em",count:C.attachmentCount,label:"Total attachments count","tool-tip":"View document attachments",disable:d.ajaxRunning,onClick:oe(we=>b(xa)(C.id,C.label),["stop","prevent"])},null,8,["count","disable","onClick"]),m(bt,{size:"md",square:"",class:"min-width-9em",count:C.noteCount,label:"Total notes","tool-tip":"View document notes",disable:d.ajaxRunning,onClick:oe(we=>b(Sa)(C.id,C.label),["stop","prevent"])},null,8,["count","disable","onClick"])]),_:2},1024)]),_:2},1032,["class","clickable","to"]))],2)]),_:2},[U.value?{name:"before",fn:u(()=>[m(ge,{warning:"",class:"q-ma-md",text:"Unfortunately, your search didn't return any results. You might want to modify your filters or search terms"})]),key:"0"}:void 0]),1032,["items"]))]),"actions-prepend":u(()=>[m(nt),m(pt,{modelValue:a.resultsPage,"onUpdate:modelValue":[M[4]||(M[4]=C=>a.resultsPage=C),c],filled:"",options:r,label:b(o)("Max results"),"stack-label":"",dense:"","options-dense":"",class:"q-mr-md",style:{"min-width":"12em"}},null,8,["modelValue","label"])]),_:1},8,["modelValue"]))}}),il=Ce(sl,[["__scopeId","data-v-21732d4e"]]),rl={class:"q-mt-sm q-mb-md text-h4 text-weight-bolder"},ul={class:"text-color-secondary"},dl=ee({__name:"ReAuthDialog",emits:["close","success"],setup(e,{emit:g}){const{t:n}=ne(),s=g,t=E(!0),l=()=>{s("close")},o=()=>{s("success")};return(w,k)=>(x(),F(pe,{modelValue:t.value,"onUpdate:modelValue":k[0]||(k[0]=d=>t.value=d),onClose:l,width:"512px","max-width":"80vw","hide-footer":"",persistent:""},{"header-left":u(()=>[P(y(b(n)("Session lost... re-auth required")),1)]),body:u(()=>[m(Na,{"show-extra-bottom":!1,onSuccess:o},{slogan:u(()=>[D("h4",rl,y(b(n)("Oooops")),1),D("div",ul,y(b(n)("Please enter again your credentials")),1)]),_:1})]),_:1},8,["modelValue"]))}}),cl={ratio:[String,Number]};function ml(e,g){return S(()=>{const n=Number(e.ratio||(g!==void 0?g.value:void 0));return isNaN(n)!==!0&&n>0?{paddingBottom:`${100/n}%`}:null})}const fl=1.7778,vl=qe({name:"QImg",props:{...cl,src:String,srcset:String,sizes:String,alt:String,crossorigin:String,decoding:String,referrerpolicy:String,draggable:Boolean,loading:{type:String,default:"lazy"},loadingShowDelay:{type:[Number,String],default:0},fetchpriority:{type:String,default:"auto"},width:String,height:String,initialRatio:{type:[Number,String],default:fl},placeholderSrc:String,errorSrc:String,fit:{type:String,default:"cover"},position:{type:String,default:"50% 50%"},imgClass:String,imgStyle:Object,noSpinner:Boolean,noNativeMenu:Boolean,noTransition:Boolean,spinnerColor:String,spinnerSize:String},emits:["load","error"],setup(e,{slots:g,emit:n}){const s=E(e.initialRatio),t=ml(e,s),l=at(),{registerTimeout:o,removeTimeout:w}=Ze(),{registerTimeout:k,removeTimeout:d}=Ze(),i=S(()=>e.placeholderSrc!==void 0?{src:e.placeholderSrc}:null),T=S(()=>e.errorSrc!==void 0?{src:e.errorSrc,__qerror:!0}:null),h=[E(null),E(i.value)],_=E(0),a=E(!1),r=E(!1),c=S(()=>`q-img q-img--${e.noNativeMenu===!0?"no-":""}menu`),v=S(()=>({width:e.width,height:e.height})),p=S(()=>`q-img__image ${e.imgClass!==void 0?e.imgClass+" ":""}q-img__image--with${e.noTransition===!0?"out":""}-transition q-img__image--`),$=S(()=>({...e.imgStyle,objectFit:e.fit,objectPosition:e.position}));function Q(){if(d(),e.loadingShowDelay===0){a.value=!0;return}k(()=>{a.value=!0},e.loadingShowDelay)}function U(){d(),a.value=!1}function W({target:V}){He(l)===!1&&(w(),s.value=V.naturalHeight===0?.5:V.naturalWidth/V.naturalHeight,J(V,1))}function J(V,q){q===1e3||He(l)===!0||(V.complete===!0?be(V):o(()=>{J(V,q+1)},50))}function be(V){He(l)!==!0&&(_.value=_.value^1,h[_.value].value=null,U(),V.getAttribute("__qerror")!=="true"&&(r.value=!1),n("load",V.currentSrc||V.src))}function Z(V){w(),U(),r.value=!0,h[_.value].value=T.value,h[_.value^1].value=i.value,n("error",V)}function N(V){const q=h[V].value,M={key:"img_"+V,class:p.value,style:$.value,alt:e.alt,crossorigin:e.crossorigin,decoding:e.decoding,referrerpolicy:e.referrerpolicy,height:e.height,width:e.width,loading:e.loading,fetchpriority:e.fetchpriority,"aria-hidden":"true",draggable:e.draggable,...q};return _.value===V?Object.assign(M,{class:M.class+"current",onLoad:W,onError:Z}):M.class+="loaded",B("div",{class:"q-img__container absolute-full",key:"img"+V},B("img",M))}function X(){return a.value===!1?B("div",{key:"content",class:"q-img__content absolute-full q-anchor--skip"},lt(g[r.value===!0?"error":"default"])):B("div",{key:"loading",class:"q-img__loading absolute-full flex flex-center"},g.loading!==void 0?g.loading():e.noSpinner===!0?void 0:[B(_t,{color:e.spinnerColor,size:e.spinnerSize})])}{let V=function(){j(()=>e.src||e.srcset||e.sizes?{src:e.src,srcset:e.srcset,sizes:e.sizes}:null,q=>{w(),r.value=!1,q===null?(U(),h[_.value^1].value=i.value):Q(),h[_.value].value=q},{immediate:!0})};ta.value===!0?ce(V):V()}return()=>{const V=[];return t.value!==null&&V.push(B("div",{key:"filler",style:t.value})),h[0].value!==null&&V.push(N(0)),h[1].value!==null&&V.push(N(1)),V.push(B(aa,{name:"q-transition--fade"},X)),B("div",{key:"main",class:c.value,style:v.value,role:"img","aria-label":e.alt},V)}}}),hl=la("browserSupportStore",{state:()=>({allowPDFPreviews:_a.get()===!0})}),xe={visible:!1,success:!1,error:!1,text:null},gl=["src"],pl=ee({__name:"PDFWrapper",props:{path:{},innerContentClass:{}},setup(e){return(g,n)=>(x(),I("iframe",{id:"pdf-container",src:e.path,class:Se(e.innerContentClass)},null,10,gl))}}),bl=Ce(pl,[["__scopeId","data-v-ccba34f9"]]),wl={key:0},_l={key:1},yl={class:"text-center text-bold q-my-md"},xl={class:"q-pt-none"},Sl={key:1},kl={class:"text-center q-my-md"},ql={controls:"",class:"q-mt-md full-width"},Cl=["src"],Dl={key:2,class:"pdf-container q-mx-auto q-mb-md"},Pl={key:3},Tl={class:"text-center q-my-md"},$l={key:4,class:"text-subtitle1 text-center"},Vl={class:"text-center q-my-md"},Al=ee({__name:"FilePreviewDialog",props:{document:{},currentIndex:{default:0}},emits:["close"],setup(e,{emit:g}){const{t:n}=ne(),s=g,t=E(!1),l=e,o=E(!0),w=S(()=>l.document?.attachments?.length>0),k=S(()=>w.value?l.document?.attachments?.length:0),d=E(l.currentIndex+1||1),i=S(()=>l.document.attachments.length>0&&d.value<=l.document.attachments.length?l.document.attachments[d.value-1]:{id:"",name:"",size:0,hash:"",humanSize:"",createdAt:new ke(n,null),orphaned:!0}),T=()=>{s("close")},h=G({...xe}),_=hl(),a=()=>{Object.assign(h,xe),t.value=!1},r=()=>{t.value=!0,h.success=!1,h.error=!0,h.text=n("Error loading preview"),h.visible=!0},c=(v,p)=>{Object.assign(h,xe),Dt(Ee(v),p).then($=>{h.success=!0,h.text=n("FileDownloadedMessage",{filename:$.fileName,length:$.length})}).catch(()=>{h.error=!0,h.text=n("FileDownloadErrorMessage",{filename:p})}).finally(()=>{h.visible=!0})};return(v,p)=>{const $=Ie("router-link");return x(),F(pe,{modelValue:o.value,"onUpdate:modelValue":p[2]||(p[2]=Q=>o.value=Q),onClose:T,width:"1280px","max-width":"80vw"},qt({"header-left":u(()=>[e.document.title?(x(),I("div",wl,[P(y(b(n)("Document title"))+": ",1),m($,{to:{name:"document",params:{id:e.document.id}},class:"text-decoration-hover"},{default:u(()=>[P(y(e.document.title),1)]),_:1},8,["to"])])):(x(),I("div",_l,y(b(n)("Document attachments preview",{count:k.value})),1))]),"header-right":u(()=>[m(ie,{size:"md",square:"",class:"gt-sm theme-default-q-chip shadow-1"},{default:u(()=>[m(ue,{class:"theme-default-q-avatar"},{default:u(()=>[P(y(k.value),1)]),_:1}),P(" "+y(b(n)("Total attachments count",{count:k.value})),1)]),_:1})]),_:2},[i.value?{name:"body",fn:u(()=>[D("div",null,[D("p",yl,y(i.value.name)+" ("+y(i.value.humanSize)+")",1),k.value>1?(x(),F(Ma,{key:0,class:"flex flex-center q-my-md",modelValue:d.value,"onUpdate:modelValue":[p[0]||(p[0]=Q=>d.value=Q),a],max:k.value,color:"dark","max-pages":5,"boundary-numbers":"","direction-links":"","icon-first":"skip_previous","icon-last":"skip_next","icon-prev":"fast_rewind","icon-next":"fast_forward",gutter:"md"},null,8,["modelValue","max"])):L("",!0)]),D("div",xl,[b(Pa)(i.value.name)?re((x(),F(vl,{key:0,src:b(Xe)(i.value.id,!0),loading:"lazy","spinner-color":"white",onError:r,alt:"image preview",fit:"scale-down",class:"q-img-max-height q-my-md","img-class":"q-mx-auto"},null,8,["src"])),[[Ae,!t.value]]):b(Ta)(i.value.name)?(x(),I("div",Sl,[D("p",kl,[m(le,{name:"audio_file",size:"128px"})]),D("audio",ql,[D("source",{src:b(Xe)(i.value.id,!0),type:"audio/mpeg"},null,8,Cl),P(" "+y(b(n)("Your browser does not support the audio element")),1)])])):b($a)(i.value.name)?(x(),I("div",Dl,[b(_).allowPDFPreviews?(x(),F(bl,{key:0,path:b(Xe)(i.value.id,!0),"inner-content-class":"pdf-wrapper-inner-class"},null,8,["path"])):(x(),F(je,{key:1,text:b(n)("Missing browser PDF preview support")},null,8,["text"]))])):(x(),I("div",Pl,[D("p",Tl,[m(le,{name:"hide_source",size:"128px"})])])),t.value?(x(),I("div",$l,[D("p",Vl,[m(le,{name:"bug_report",size:"128px"})])])):L("",!0)])]),key:"0"}:void 0,i.value?{name:"actions-prepend",fn:u(()=>[h.visible?(x(),F(ge,{key:0,success:h.success,error:h.error},{text:u(()=>[P(y(h.text),1)]),_:1},8,["success","error"])):b(Tt)(i.value.name)?L("",!0):(x(),F(ge,{key:1,warning:""},{text:u(()=>[P(y(b(n)("Attachment preview not available",{filename:i.value.name})),1)]),_:1})),m(nt),m(se,{color:"primary","no-caps":"",href:b(Ee)(i.value.id,!0),label:b(n)("Download"),icon:"download",onClick:p[1]||(p[1]=oe(Q=>c(i.value.id,i.value.name),["stop","prevent","stop"])),"aria-label":"Download file"},null,8,["href","label"])]),key:"1"}:void 0]),1032,["modelValue"])}}}),El={key:0},Fl={key:1},zl={class:"q-pt-none scroll attachments-scrolled-container"},Il={key:0},jl={key:1},Ml={key:2},Bl={class:"row full-width"},Rl={class:"col-xl-10 col-lg-10 col-md-9 col-sm-12 col-xs-12"},Ll={class:"text-weight-bold"},Nl={class:"text-weight-bold"},Ql={class:"text-weight-bold"},Ol={class:"col-xl-2 col-lg-2 col-md-3 col-sm-12 col-xs-12"},Ul=ee({__name:"DocumentFilesPreviewDialog",props:{documentId:{},documentTitle:{}},emits:["close"],setup(e,{emit:g}){const{t:n}=ne(),s=e,t=g,l=E(!0),o=G({...he}),w=G([]),k=S(()=>w?.length>0),d=a=>{z.emit("showDocumentFilePreviewDialog",{document:{id:s.documentId,title:s.documentTitle,attachments:w},currentIndex:a})},i=G({...xe}),T=(a,r)=>{Object.assign(i,xe),Dt(Ee(a),r).then(c=>{i.success=!0,i.text=n("FileDownloadedMessage",{filename:c.fileName,length:tt.humanStorageSize(c.length)})}).catch(()=>{i.error=!0,i.text=n("FileDownloadeErrorMessage",{filename:r})}).finally(()=>{i.visible=!0})},h=a=>{o.ajaxRunning||(Object.assign(o,he),o.ajaxRunning=!0,De.document.getAttachments(a).then(r=>{w.length=0,w.push(...r.data.attachments.map(c=>new Va(c.id,c.name,c.hash,c.size,new ke(n,c.createdAtTimestamp),!1)))}).catch(r=>{if(o.ajaxErrors=!0,r.isAPIError)switch(o.ajaxAPIErrorDetails=r.customAPIErrorDetails,r.response.status){case 401:o.ajaxErrors=!1,z.emit("reAuthRequired",{emitter:"DocumentFilesPreviewDialog"});break;default:o.ajaxErrorMessage="API Error: fatal error";break}else o.ajaxErrorMessage=`Uncaught exception: ${r}`,console.error(r)}).finally(()=>{o.ajaxRunning=!1}))},_=()=>{t("close")};return ce(()=>{h(s.documentId),z.on("reAuthSucess",a=>{a.to?.includes("DocumentFilesPreviewDialog")&&h(s.documentId)})}),de(()=>{z.off("reAuthSucess")}),(a,r)=>{const c=Ie("router-link");return x(),F(pe,{modelValue:l.value,"onUpdate:modelValue":r[0]||(r[0]=v=>l.value=v),onClose:_,width:"1280px","max-width":"80vw"},{"header-left":u(()=>[e.documentTitle?(x(),I("div",El,[P(y(b(n)("Document title"))+": ",1),m(c,{to:{name:"document",params:{id:e.documentId}},class:"text-decoration-hover"},{default:u(()=>[P(y(e.documentTitle),1)]),_:1},8,["to"])])):(x(),I("div",Fl,y(b(n)("Document attachments")),1))]),"header-right":u(()=>[!o.ajaxRunning&&!o.ajaxErrors?(x(),F(ie,{key:0,size:"md",square:"",class:"gt-sm theme-default-q-chip shadow-1"},{default:u(()=>[m(ue,{class:"theme-default-q-avatar"},{default:u(()=>[P(y(w.length),1)]),_:1}),P(" "+y(b(n)("Total attachments count",{count:w.length})),1)]),_:1})):L("",!0)]),body:u(()=>[D("div",zl,[o.ajaxRunning?(x(),I("div",Il)):o.ajaxErrors?(x(),I("div",jl,[m(je,{text:o.ajaxErrorMessage||"Error loading data","api-error":o.ajaxAPIErrorDetails},null,8,["text","api-error"])])):k.value?(x(),F(ot,{key:3},{default:u(()=>[(x(!0),I(ze,null,Fe(w,(v,p)=>(x(),I("div",{key:v.id,class:"border-bottom-except-last-item"},[m(ve,{class:"transparent-background text-color-primary q-pa-sm cursor-default",clickable:""},{default:u(()=>[m(Y,null,{default:u(()=>[D("div",Bl,[D("div",Rl,[m(K,null,{default:u(()=>[D("span",Ll,y(b(n)("Name"))+":",1),P(" "+y(v.name),1)]),_:2},1024),m(K,null,{default:u(()=>[D("span",Nl,y(b(n)("Size"))+":",1),P(" "+y(v.humanSize),1)]),_:2},1024),m(K,null,{default:u(()=>[D("span",Ql,y(b(n)("Uploaded on"))+":",1),P(" "+y(v.createdAt.dateTime)+" ("+y(v.createdAt.timeAgo)+")",1)]),_:2},1024)]),D("div",Ol,[m(se,{align:"left",size:"md",color:"primary",class:"q-mt-sm full-width",disable:o.ajaxRunning,icon:"save",label:b(n)("Download"),"no-caps":"",onClick:oe($=>T(v.id,v.name),["stop","prevent"]),href:b(Ee)(v.id,!0)},null,8,["disable","label","onClick","href"]),b(Tt)(v.name)?(x(),F(se,{key:0,align:"left",size:"md",color:"primary",class:"q-mt-sm full-width",disable:o.ajaxRunning,icon:"preview",label:b(n)("Preview"),"no-caps":"",onClick:oe($=>d(p),["stop","prevent"])},null,8,["disable","label","onClick"])):L("",!0)])])]),_:2},1024)]),_:2},1024)]))),128))]),_:1})):(x(),I("div",Ml,[m(ge,{warning:"",text:"This document has no associated attachments."})]))])]),"actions-prepend":u(()=>[i.visible?(x(),F(ge,{key:0,success:i.success,error:i.error},{text:u(()=>[P(y(i.text),1)]),_:1},8,["success","error"])):L("",!0),m(nt)]),_:1},8,["modelValue"])}}}),Hl=Ce(Ul,[["__scopeId","data-v-3d7d4059"]]),Wl={key:0},Yl={key:1},Xl={class:"q-pt-none scroll notes-scrolled-container"},Kl={key:0},Gl={key:1},Jl={key:2},Zl={key:3},eo={class:"note-date-label"},to=ee({__name:"DocumentNotesPreviewDialog",props:{documentId:{},documentTitle:{},maxLines:{default:2}},emits:["close"],setup(e,{emit:g}){const{t:n}=ne(),s=e,t=g,l=E(!0),o=G({...he}),w=G([]),k=S(()=>w?.length>0),d=T=>{o.ajaxRunning||(Object.assign(o,he),o.ajaxRunning=!0,De.document.getNotes(T).then(h=>{w.length=0,w.push(...h.data.notes.map(_=>new Aa(_.id,_.body,new ke(n,_.createdAtTimestamp),!1,!1)))}).catch(h=>{if(o.ajaxErrors=!0,h.isAPIError)switch(o.ajaxAPIErrorDetails=h.customAPIErrorDetails,h.response.status){case 401:o.ajaxErrors=!1,z.emit("reAuthRequired",{emitter:"DocumentNotesPreviewDialog"});break;default:o.ajaxErrorMessage="API Error: fatal error";break}else o.ajaxErrorMessage=`Uncaught exception: ${h}`,console.error(h)}).finally(()=>{o.ajaxRunning=!1}))},i=()=>{t("close")};return ce(()=>{d(s.documentId),z.on("reAuthSucess",T=>{T.to?.includes("DocumentNotesPreviewDialog")&&d(s.documentId)})}),de(()=>{z.off("reAuthSucess")}),(T,h)=>{const _=Ie("router-link");return x(),F(pe,{modelValue:l.value,"onUpdate:modelValue":h[0]||(h[0]=a=>l.value=a),onClose:i,width:"1280px","max-width":"80vw"},{"header-left":u(()=>[e.documentTitle?(x(),I("div",Wl,[P(y(b(n)("Document title"))+": ",1),m(_,{to:{name:"document",params:{id:e.documentId}},class:"text-decoration-hover"},{default:u(()=>[P(y(e.documentTitle),1)]),_:1},8,["to"])])):(x(),I("div",Yl,y(b(n)("Document notes")),1))]),"header-right":u(()=>[!o.ajaxRunning&&!o.ajaxErrors?(x(),F(ie,{key:0,size:"md",square:"",class:"gt-sm theme-default-q-chip shadow-1"},{default:u(()=>[m(ue,{class:"theme-default-q-avatar"},{default:u(()=>[P(y(w.length),1)]),_:1}),P(" "+y(b(n)("Total notes",{count:w.length})),1)]),_:1})):L("",!0)]),body:u(()=>[D("div",Xl,[o.ajaxRunning?(x(),I("div",Kl)):o.ajaxErrors?(x(),I("div",Gl,[m(je,{text:o.ajaxErrorMessage||"Error loading data","api-error":o.ajaxAPIErrorDetails},null,8,["text","api-error"])])):k.value?(x(),I("div",Zl,[(x(!0),I(ze,null,Fe(w,a=>(x(),I("div",{key:a.id,class:"q-pa-sm relative-position white-space-pre-line border-bottom-except-last-item"},[D("div",eo,y(a.createdAt.dateTime)+" ("+y(a.createdAt.timeAgo)+")",1),m(le,{name:a.expanded?"unfold_less":"expand",size:"sm",class:"absolute-top-right text-grey cursor-pointer q-mr-sm q-mt-sm",color:"blue",onClick:oe(r=>a.expanded=!a.expanded,["stop"])},{default:u(()=>[m(et,null,{default:u(()=>[P(y(b(n)(a.expanded?"Click to collapse":"Click to expand")),1)]),_:2},1024)]),_:2},1032,["name","onClick"]),D("div",{class:Se(["q-mt-sm",{collapsed:!a.expanded}]),style:oa(`--max-lines: ${e.maxLines}`)},y(a.body),7)]))),128))])):(x(),I("div",Jl,[m(ge,{warning:"",text:"This document has no associated notes."})]))])]),_:1},8,["modelValue"])}}}),ao=Ce(to,[["__scopeId","data-v-95d4bcf6"]]),lo={class:"q-p-none q-markup-table-container scroll"},oo={class:"text-left"},no={class:"text-right"},so={class:"text-right"},io={class:"text-right"},ro={class:"text-center"},uo={class:"text-left"},co={class:"text-right"},mo={class:"text-right"},fo={class:"text-right"},vo={key:0},ho={class:"text-center"},go=ee({__name:"UploadingDialog",props:{modelValue:{type:Boolean},transfers:{}},emits:["update:modelValue","close","clearProcessedTransfers"],setup(e,{emit:g}){const{t:n}=ne(),s=Oa(),t=g,l=e,o=S(()=>l.transfers?.length>0),w=S({get(){return l.modelValue},set(a){if(a){const r=me.get();r!==d.value&&(d.value=r)}t("update:modelValue",a)}}),k=S(()=>l.transfers.length>0?l.transfers.find(a=>a.processed===!0)!==void 0:!1),d=E(me.get());j(()=>w.value,a=>{a&&(d.value=me.get())});const i=a=>{me.set(a)},T=S(()=>d.value?"Always display this progress window when uploading files":"Only display this progress window when uploading failed"),h=()=>{w.value=!1,t("update:modelValue",!1)},_=()=>{t("clearProcessedTransfers")};return(a,r)=>(x(),F(pe,{modelValue:w.value,"onUpdate:modelValue":r[1]||(r[1]=c=>w.value=c),onClose:h,width:"1280px","max-width":"80vw"},{"header-left":u(()=>[P(y(b(n)("File upload activity & status")),1)]),body:u(()=>[D("div",lo,[o.value?(x(),F(Pt,{key:0},{default:u(()=>[D("thead",null,[D("tr",null,[D("th",oo,y(b(n)("Name")),1),D("th",no,y(b(n)("Size")),1),D("th",so,y(b(n)("Started")),1),D("th",io,y(b(n)("End")),1),D("th",ro,y(b(n)("Status")),1)])]),D("tbody",null,[(x(!0),I(ze,null,Fe(e.transfers,c=>(x(),I("tr",{key:c.id,class:Se(["text-white",{"bg-green-5":c.done,"bg-red-4":c.error,"bg-light-blue":c.uploading}])},[D("td",uo,y(c.filename),1),D("td",co,y(b(tt).humanStorageSize(c.filesize)),1),D("td",mo,y(b(vt)(c.start,b(mt).get())),1),D("td",fo,[c.end&&c.end>0?(x(),I("span",vo,y(b(vt)(c.end,b(mt).get())),1)):L("",!0)]),D("td",ho,[c.error?(x(),F(ie,{key:0,square:"",class:"full-width bg-red-9 text-white"},{default:u(()=>[m(ue,{icon:"cancel",class:"q-ma-xs"}),P(" "+y(c.errorHTTPCode==413?b(n)("Transfer rejected max filesize",{maxUploadFileSize:b(tt).humanStorageSize(b(s).maxUploadFileSize)}):b(n)(c.errorMessage||"Error")),1)]),_:2},1024)):c.done?(x(),F(ie,{key:1,square:"",class:"full-width bg-green-9 text-white"},{default:u(()=>[m(ue,{icon:"check",class:"q-ma-xs"}),P(" "+y(b(n)("Transfer complete")),1)]),_:1})):c.uploading?(x(),F(ie,{key:2,square:"",class:"full-width bg-light-blue-9 text-white"},{default:u(()=>[m(_t,{size:"sm",class:"q-ma-xs"}),P(" "+y(b(n)("Transfering...")),1)]),_:1})):L("",!0)])],2))),128))])]),_:1})):L("",!0)])]),"actions-prepend":u(()=>[m(Qa,{modelValue:d.value,"onUpdate:modelValue":[r[0]||(r[0]=c=>d.value=c),i],"checked-icon":"check",color:"green",label:b(n)(T.value),"unchecked-icon":"clear",class:"q-mr-md"},null,8,["modelValue","label"]),m(se,{color:"primary",size:"md","no-caps":"",onClick:oe(_,["stop"]),disable:!k.value,icon:"close",label:b(n)("Clear processed transfers")},null,8,["disable","label"])]),_:1},8,["modelValue"]))}}),po=Ce(go,[["__scopeId","data-v-cc475dc1"]]),Wo=ee({__name:"MainLayout",setup(e){const g=wa(),{t:n}=ne(),s=G({reauth:{visible:!1},filePreview:{visible:!1,document:new Ea,currentIndex:0},documentFilesPreview:{visible:!1,document:{id:null,title:null}},documentNotesPreview:{visible:!1,document:{id:null,title:null}},fastSearch:{visible:!1},uploading:{visible:!1,transfers:[]}}),t=G([]),l=()=>{s.reauth.visible=!1,z.emit("reAuthSucess",{to:t}),t.length=0},o=E(!1),w=E(g.screen.gt.sm),k=ft.getItem("miniSidebarCurrentMode");k!=null&&(o.value=!0);const d=E(k!=null?k==!0:g.screen.md),i=S(()=>g.screen.name);j(i,()=>{o.value||(d.value=g.screen.lt.lg)});const T=S(()=>g.screen.gt.xs?n("Search on HomeDocs..."):""),h=()=>{d.value=!d.value,o.value=!0,ft.set("miniSidebarCurrentMode",d.value)},_=()=>{s.uploading.transfers=s.uploading.transfers.filter(a=>!a.processed)};return ce(()=>{z.on("reAuthRequired",a=>{a.emitter&&t.push(a.emitter);const r=Ct();De.auth.renewAccessToken().then(c=>{r.setAccessToken(c.data.accessToken),z.emit("reAuthSucess",{to:t}),t.length=0}).catch(c=>{console.error(c),s.reauth.visible=!0})}),z.on("showDocumentFilePreviewDialog",a=>{s.filePreview.document.id=a?.document?.id||null,s.filePreview.document.title=a?.document?.title||"",s.filePreview.document.attachments=a?.document?.attachments||[],s.filePreview.currentIndex=a?.currentIndex||0,s.filePreview.visible=!0}),z.on("showDocumentFilesPreviewDialog",a=>{s.documentFilesPreview.document.id=a?.document?.id||null,s.documentFilesPreview.document.title=a?.document?.title||null,s.documentFilesPreview.visible=!0}),z.on("showDocumentNotesPreviewDialog",a=>{s.documentNotesPreview.document.id=a?.document?.id||null,s.documentNotesPreview.document.title=a?.document?.title||null,s.documentNotesPreview.visible=!0}),z.on("showUploadingDialog",a=>{s.uploading.transfers.unshift(...a.transfers),s.uploading.visible=s.uploading.transfers?.length>0&&me.get()}),z.on("refreshUploadingDialog.fileUploaded",a=>{s.uploading.transfers.length>0?a.transfers?.forEach(r=>{const c=s.uploading.transfers?.find(v=>!v.processed&&r.filename==v.filename&&r.filesize==v.filesize);c?(c.end=Ye(),c.uploading=!1,c.done=!0,c.processed=!0):console.error("Transfer not found",r)}):console.error("Missing previous transfers"),s.uploading.visible=s.uploading.transfers?.length>0&&me.get()}),z.on("refreshUploadingDialog.fileUploadRejected",a=>{a.transfers?.forEach(r=>{const c=s.uploading.transfers?.find(v=>!v.processed&&r.filename==v.filename&&r.filesize==v.filesize);c?(c.end=Ye(),c.uploading=!1,c.error=!0,c.errorHTTPCode=r.errorHTTPCode,c.errorMessage="Transfer rejected",c.processed=!0):s.uploading.transfers.unshift(r)}),s.uploading.visible=s.uploading.transfers?.length>0}),z.on("refreshUploadingDialog.fileUploadFailed",a=>{a.transfers?.forEach(r=>{const c=s.uploading.transfers?.find(v=>!v.processed&&r.filename==v.filename&&r.filesize==v.filesize);c?(c.end=Ye(),c.uploading=!1,c.error=!0,c.errorHTTPCode=r.errorHTTPCode,c.errorMessage="Transfer failed",c.processed=!0):s.uploading.transfers.unshift(r)}),s.uploading.visible=s.uploading.transfers?.length>0})}),de(()=>{z.off("reAuthRequired"),z.off("showDocumentFilePreviewDialog"),z.off("showDocumentFilesPreviewDialog"),z.off("showDocumentNotesPreviewDialog"),z.off("showUploadingDialog"),z.off("refreshUploadingDialog.fileUploaded"),z.off("refreshUploadingDialog.fileUploadRejected"),z.off("refreshUploadingDialog.fileUploadFailed")}),(a,r)=>{const c=Ie("router-view");return x(),F(ca,{view:"lHh lpR lFf",class:"theme-default-q-layout"},{default:u(()=>[m(Ha,{"height-hint":"61.59",class:"theme-default-q-header",bordered:""},{default:u(()=>[m(Ua,{class:"theme-default-q-toolbar"},{default:u(()=>[re(m(se,{flat:"",dense:"",round:"",onClick:r[0]||(r[0]=v=>{w.value=!w.value}),"aria-label":"Toggle drawer",icon:"menu",class:"q-mr-md"},null,512),[[Ae,!w.value]]),re(m(se,{flat:"",dense:"",round:"",onClick:h,"aria-label":"Toggle drawer",icon:d.value?"arrow_forward_ios":"arrow_back_ios_new",class:"q-mr-md"},{default:u(()=>[m(et,null,{default:u(()=>[P(y(b(n)(d.value?"Expand sidebar":"Collapse sidebar")),1)]),_:1})]),_:1},8,["icon"]),[[Ae,w.value]]),m(se,{type:"button","no-caps":"","no-wrap":"",align:"left",outline:"",label:T.value,icon:"search",class:"full-width no-caps theme-default-q-btn",onClick:r[1]||(r[1]=oe(v=>s.fastSearch.visible=!0,["prevent"]))},{default:u(()=>[m(et,{anchor:"bottom middle",self:"top middle"},{default:u(()=>[P(y(b(n)("Click to open fast search")),1)]),_:1})]),_:1},8,["label"]),m(Ot,{flat:"",class:"q-ml-md"},{default:u(()=>[m(Ba,{dense:""}),m(Ra,{"short-labels":!0,style:{"min-width":"9em"}}),m(La,{dense:"",href:b(ya)},null,8,["href"])]),_:1})]),_:1})]),_:1}),m(Xa,{modelValue:w.value,"onUpdate:modelValue":r[2]||(r[2]=v=>w.value=v),mini:d.value},null,8,["modelValue","mini"]),m(il,{modelValue:s.fastSearch.visible,"onUpdate:modelValue":r[3]||(r[3]=v=>s.fastSearch.visible=v)},null,8,["modelValue"]),m(da,null,{default:u(()=>[m(c,{class:"q-pa-sm"})]),_:1}),s.reauth.visible?(x(),F(dl,{key:0,onSuccess:l,onClose:r[4]||(r[4]=v=>s.reauth.visible=!1)})):L("",!0),s.filePreview.visible?(x(),F(Al,{key:1,document:s.filePreview.document,"current-index":s.filePreview.currentIndex,onClose:r[5]||(r[5]=v=>s.filePreview.visible=!1)},null,8,["document","current-index"])):L("",!0),s.documentFilesPreview.visible&&s.documentFilesPreview.document.id&&s.documentFilesPreview.document.title?(x(),F(Hl,{key:2,"document-id":s.documentFilesPreview.document.id,"document-title":s.documentFilesPreview.document.title,onClose:r[6]||(r[6]=v=>s.documentFilesPreview.visible=!1)},null,8,["document-id","document-title"])):L("",!0),s.documentNotesPreview.visible&&s.documentNotesPreview.document.id&&s.documentNotesPreview.document.title?(x(),F(ao,{key:3,"document-id":s.documentNotesPreview.document.id,"document-title":s.documentNotesPreview.document.title,onClose:r[7]||(r[7]=v=>s.documentNotesPreview.visible=!1)},null,8,["document-id","document-title"])):L("",!0),m(po,{modelValue:s.uploading.visible,"onUpdate:modelValue":r[8]||(r[8]=v=>s.uploading.visible=v),transfers:s.uploading.transfers,onClearProcessedTransfers:_},null,8,["modelValue","transfers"])]),_:1})}}});export{Wo as default};
