import{x as $,j as r,y as b,au as I,I as W,z as he,l as _,B as L,M as ve,a5 as ge,D as me,Q as pe,F as ye}from"./index-B-UYWWpq.js";import{h as G,e as ke}from"./_plugin-vue_export-helper-B9cH7pQ5.js";import{u as xe,v as Be,j as A,g as Pe,a as be,e as qe,h as Ce,k as Ee,f as Te,b as we,i as Se,r as R,s as Oe,p as Q,l as De,m as Fe,n as Ke,o as Me}from"./QItem-bsDUXGQF.js";import{u as _e,b as Le,h as Ae,d as Re,i as Qe}from"./use-timeout-f6zK2_pC.js";import{s as He,g as je}from"./scroll-D_X1SM_z.js";const Ze=$({name:"QBtnGroup",props:{unelevated:Boolean,outline:Boolean,flat:Boolean,rounded:Boolean,square:Boolean,push:Boolean,stretch:Boolean,glossy:Boolean,spread:Boolean},setup(e,{slots:o}){const n=r(()=>{const a=["unelevated","outline","flat","rounded","square","push","stretch","glossy"].filter(s=>e[s]===!0).map(s=>`q-btn-group--${s}`).join(" ");return`q-btn-group row no-wrap${a.length!==0?" "+a:""}`+(e.spread===!0?" q-btn-group--spread":" inline")});return()=>b("div",{class:n.value},G(o.default))}}),l=[];let f;function $e(e){f=e.keyCode===27}function Ie(){f===!0&&(f=!1)}function We(e){f===!0&&(f=!1,I(e,27)===!0&&l[l.length-1](e))}function N(e){window[e]("keydown",$e),window[e]("blur",Ie),window[e]("keyup",We),f=!1}function Ge(e){W.is.desktop===!0&&(l.push(e),l.length===1&&N("addEventListener"))}function H(e){const o=l.indexOf(e);o!==-1&&(l.splice(o,1),l.length===0&&N("removeEventListener"))}const c=[];function U(e){c[c.length-1](e)}function Ne(e){W.is.desktop===!0&&(c.push(e),c.length===1&&document.body.addEventListener("focusin",U))}function Ue(e){const o=c.indexOf(e);o!==-1&&(c.splice(o,1),c.length===0&&document.body.removeEventListener("focusin",U))}const et=$({name:"QMenu",inheritAttrs:!1,props:{...qe,...be,..._e,...Pe,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noEscDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:A},self:{type:String,validator:A},offset:{type:Array,validator:Be},scrollTarget:He,touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...xe,"click","escapeKey"],setup(e,{slots:o,emit:n,attrs:a}){let s=null,m,h,p;const q=he(),{proxy:y}=q,{$q:u}=y,i=_(null),d=_(!1),z=r(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),J=Le(e,u),{registerTick:V,removeTick:X}=Ae(),{registerTimeout:C}=Re(),{transitionProps:Y,transitionStyle:Z}=Ce(e),{localScrollTarget:E,changeScrollEvent:ee,unconfigureScrollTarget:te}=Ee(e,K),{anchorEl:v,canShow:oe}=Te({showing:d}),{hide:T}=we({showing:d,canShow:oe,handleShow:ie,handleHide:re,hideOnRouteChange:z,processOnMount:!0}),{showPortal:w,hidePortal:S,renderPortal:ne}=Se(q,i,ce,"menu"),k={anchorEl:v,innerRef:i,onClickOutside(t){if(e.persistent!==!0&&d.value===!0)return T(t),(t.type==="touchstart"||t.target.classList.contains("q-dialog__backdrop"))&&pe(t),!0}},O=r(()=>Q(e.anchor||(e.cover===!0?"center middle":"bottom start"),u.lang.rtl)),se=r(()=>e.cover===!0?O.value:Q(e.self||"top start",u.lang.rtl)),ae=r(()=>(e.square===!0?" q-menu--square":"")+(J.value===!0?" q-menu--dark q-dark":"")),ue=r(()=>e.autoClose===!0?{onClick:le}:{}),D=r(()=>d.value===!0&&e.persistent!==!0);L(D,t=>{t===!0?(Ge(B),Fe(k)):(H(B),R(k))});function x(){Qe(()=>{let t=i.value;t&&t.contains(document.activeElement)!==!0&&(t=t.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||t.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||t.querySelector("[autofocus], [data-autofocus]")||t,t.focus({preventScroll:!0}))})}function ie(t){if(s=e.noRefocus===!1?document.activeElement:null,Ne(M),w(),K(),m=void 0,t!==void 0&&(e.touchPosition||e.contextMenu)){const P=ve(t);if(P.left!==void 0){const{top:de,left:fe}=v.value.getBoundingClientRect();m={left:P.left-fe,top:P.top-de}}}h===void 0&&(h=L(()=>u.screen.width+"|"+u.screen.height+"|"+e.self+"|"+e.anchor+"|"+u.lang.rtl,g)),e.noFocus!==!0&&document.activeElement.blur(),V(()=>{g(),e.noFocus!==!0&&x()}),C(()=>{u.platform.is.ios===!0&&(p=e.autoClose,i.value.click()),g(),w(!0),n("show",t)},e.transitionDuration)}function re(t){X(),S(),F(!0),s!==null&&(t===void 0||t.qClickOutside!==!0)&&(((t?.type.indexOf("key")===0?s.closest('[tabindex]:not([tabindex^="-"])'):void 0)||s).focus(),s=null),C(()=>{S(!0),n("hide",t)},e.transitionDuration)}function F(t){m=void 0,h!==void 0&&(h(),h=void 0),(t===!0||d.value===!0)&&(Ue(M),te(),R(k),H(B)),t!==!0&&(s=null)}function K(){(v.value!==null||e.scrollTarget!==void 0)&&(E.value=je(v.value,e.scrollTarget),ee(E.value,g))}function le(t){p!==!0?(De(y,t),n("click",t)):p=!1}function M(t){D.value===!0&&e.noFocus!==!0&&ke(i.value,t.target)!==!0&&x()}function B(t){e.noEscDismiss!==!0&&(n("escapeKey"),T(t))}function g(){Oe({targetEl:i.value,offset:e.offset,anchorEl:v.value,anchorOrigin:O.value,selfOrigin:se.value,absoluteOffset:m,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function ce(){return b(ge,Y.value,()=>d.value===!0?b("div",{role:"menu",...a,ref:i,tabindex:-1,class:["q-menu q-position-engine scroll"+ae.value,a.class],style:[a.style,Z.value],...ue.value},G(o.default)):null)}return me(F),Object.assign(y,{focus:x,updatePosition:g}),ne}});function j(e){if(e===!1)return 0;if(e===!0||e===void 0)return 1;const o=parseInt(e,10);return isNaN(o)?0:o}const tt=ye({name:"close-popup",beforeMount(e,{value:o}){const n={depth:j(o),handler(a){n.depth!==0&&setTimeout(()=>{const s=Ke(e);s!==void 0&&Me(s,a,n.depth)})},handlerKey(a){I(a,13)===!0&&n.handler(a)}};e.__qclosepopup=n,e.addEventListener("click",n.handler),e.addEventListener("keyup",n.handlerKey)},updated(e,{value:o,oldValue:n}){o!==n&&(e.__qclosepopup.depth=j(o))},beforeUnmount(e){const o=e.__qclosepopup;e.removeEventListener("click",o.handler),e.removeEventListener("keyup",o.handlerKey),delete e.__qclosepopup}});export{tt as C,Ze as Q,et as a,H as b,Ne as c,Ge as d,Ue as r};
